{"version":3,"file":"index.global.js","sources":["../node_modules/tslib/tslib.es6.js","../../../Advanced Cropper/advanced-cropper/dist/utils/index.js","../../../Advanced Cropper/advanced-cropper/node_modules/tslib/tslib.es6.js","../../../Advanced Cropper/advanced-cropper/dist/constants/index.js","../../../Advanced Cropper/advanced-cropper/dist/types/index.js","../../../Advanced Cropper/advanced-cropper/dist/state/setCoordinates.js","../../../Advanced Cropper/advanced-cropper/dist/service/utils.js","../../../Advanced Cropper/advanced-cropper/dist/service/helpers.js","../../../Advanced Cropper/advanced-cropper/dist/service/sizeRestrictions.js","../../../Advanced Cropper/advanced-cropper/dist/state/copyState.js","../../../Advanced Cropper/advanced-cropper/dist/service/approximateSize.js","../../../Advanced Cropper/advanced-cropper/dist/service/fitVisibleArea.js","../../../Advanced Cropper/advanced-cropper/dist/algorithms/moveCoordinatesAlgorithm.js","../../../Advanced Cropper/advanced-cropper/dist/service/fitCoordinates.js","../../../Advanced Cropper/advanced-cropper/dist/state/setVisibleArea.js","../../../Advanced Cropper/advanced-cropper/dist/state/createState.js","../../../Advanced Cropper/advanced-cropper/dist/state/moveCoordinates.js","../../../Advanced Cropper/advanced-cropper/dist/algorithms/resizeCoordinatesAlgorithm.js","../../../Advanced Cropper/advanced-cropper/dist/state/resizeCoordinates.js","../../../Advanced Cropper/advanced-cropper/dist/state/setBoundary.js","../../../Advanced Cropper/advanced-cropper/dist/algorithms/rotateImageAlgorithm.js","../../../Advanced Cropper/advanced-cropper/dist/algorithms/flipImageAlgorithm.js","../../../Advanced Cropper/advanced-cropper/dist/algorithms/transformImageAlgorithm.js","../../../Advanced Cropper/advanced-cropper/dist/state/transformImage.js","../../../Advanced Cropper/advanced-cropper/dist/state/reconcileState.js","../../../Advanced Cropper/advanced-cropper/dist/service/normalize.js","../../../Advanced Cropper/advanced-cropper/dist/service/imageTransforms.js","../../../Advanced Cropper/advanced-cropper/dist/service/interactions.js","../../../Advanced Cropper/advanced-cropper/dist/defaults/defaultPositionRestrictions.js","../../../Advanced Cropper/advanced-cropper/dist/defaults/defaultVisibleArea.js","../../../Advanced Cropper/advanced-cropper/dist/defaults/defaultSize.js","../../../Advanced Cropper/advanced-cropper/dist/defaults/defaultSizeRestrictions.js","../../../Advanced Cropper/advanced-cropper/dist/defaults/defaultPosition.js","../../../Advanced Cropper/advanced-cropper/dist/defaults/defaultAreaPositionRestrictions.js","../../../Advanced Cropper/advanced-cropper/dist/defaults/defaultAreaSizeRestrictions.js","../../../Advanced Cropper/advanced-cropper/dist/defaults/defaultBoundary.js","../../../Advanced Cropper/advanced-cropper/dist/defaults/defaultStencilConstraints.js","../../../Advanced Cropper/advanced-cropper/dist/defaults/index.js","../../../Advanced Cropper/advanced-cropper/dist/instance/AbstractCropperInstance.js","../../../Advanced Cropper/advanced-cropper/dist/animation/index.js","../../../Advanced Cropper/advanced-cropper/dist/canvas/index.js","../../../Advanced Cropper/advanced-cropper/dist/boundary/index.js","../../../Advanced Cropper/advanced-cropper/dist/image/index.js","../src/deprecated/hybridAutoZoom.ts","../src/hooks/useDeprecationWarning.ts","../src/service/utils.ts","../node_modules/classnames/index.js","../src/hooks/useUpdateEffect.ts","../src/hooks/useFirstMountState.ts","../src/hooks/useStateWithCallback.ts","../src/instance/CropperInstance.ts","../src/hooks/useForceRerender.ts","../src/hooks/useCropperInstance.ts","../src/hooks/usePersistentFunction.ts","../src/hooks/useCropperImage.ts","../src/hooks/useWindowResize.ts","../src/hooks/useAbstractCropper.ts","../src/hooks/useCropperAutoReconcile.ts","../src/components/service/StretchableBoundary.tsx","../src/components/service/CropperFade.tsx","../src/components/service/CropperWrapper.tsx","../src/service/events.ts","../src/components/service/CropperBackgroundImage.tsx","../src/components/service/CropperCanvas.tsx","../src/components/service/DraggableElement.tsx","../src/components/service/LineWrapper.tsx","../src/components/lines/SimpleLine.tsx","../src/components/service/HandlerWrapper.tsx","../src/components/handlers/SimpleHandler.tsx","../src/components/service/BoundingBox.tsx","../src/components/service/StencilOverlay.tsx","../src/components/service/ArtificialTransition.tsx","../src/hooks/useTransition.ts","../src/components/service/StencilWrapper.tsx","../src/components/service/StencilGrid.tsx","../src/components/stencils/RectangleStencil.tsx","../src/hooks/useRotateImageOptions.ts","../src/hooks/useScaleImageOptions.ts","../src/hooks/useMoveImageOptions.ts","../src/components/service/TransformableImage.tsx","../src/service/cropper.ts","../src/components/service/CropperBackgroundWrapper.tsx","../src/components/AbstractCropper.tsx","../src/service/constants.ts","../src/hooks/useAbstractCropperProps.ts","../../../Advanced Cropper/advanced-cropper/dist/extensions/stencil-size/index.js","../src/components/croppers/FixedCropper.tsx","../src/components/croppers/Cropper.tsx","../src/components/stencils/CircleStencil.tsx","../src/components/service/CropperSource.tsx","../src/components/helpers/CropperPreviewWrapper.tsx","../src/components/helpers/CropperPreviewBackground.tsx","../src/components/helpers/CropperPreview.tsx","../../../Advanced Cropper/advanced-cropper/dist/service/isEqualState.js","../src/service/react.ts"],"sourcesContent":["/******************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    if (typeof b !== \"function\" && b !== null)\r\n        throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport var __createBinding = Object.create ? (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    var desc = Object.getOwnPropertyDescriptor(m, k);\r\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\r\n        desc = { enumerable: true, get: function() { return m[k]; } };\r\n    }\r\n    Object.defineProperty(o, k2, desc);\r\n}) : (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    o[k2] = m[k];\r\n});\r\n\r\nexport function __exportStar(m, o) {\r\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(o, p)) __createBinding(o, m, p);\r\n}\r\n\r\nexport function __values(o) {\r\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\r\n    if (m) return m.call(o);\r\n    if (o && typeof o.length === \"number\") return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\n/** @deprecated */\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\n/** @deprecated */\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n}\r\n\r\nexport function __spreadArray(to, from, pack) {\r\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\r\n        if (ar || !(i in from)) {\r\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\r\n            ar[i] = from[i];\r\n        }\r\n    }\r\n    return to.concat(ar || Array.prototype.slice.call(from));\r\n}\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nvar __setModuleDefault = Object.create ? (function(o, v) {\r\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\r\n}) : function(o, v) {\r\n    o[\"default\"] = v;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\r\n    __setModuleDefault(result, mod);\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n\r\nexport function __classPrivateFieldGet(receiver, state, kind, f) {\r\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a getter\");\r\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot read private member from an object whose class did not declare it\");\r\n    return kind === \"m\" ? f : kind === \"a\" ? f.call(receiver) : f ? f.value : state.get(receiver);\r\n}\r\n\r\nexport function __classPrivateFieldSet(receiver, state, value, kind, f) {\r\n    if (kind === \"m\") throw new TypeError(\"Private method is not writable\");\r\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a setter\");\r\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot write private member to an object whose class did not declare it\");\r\n    return (kind === \"a\" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;\r\n}\r\n\r\nexport function __classPrivateFieldIn(state, receiver) {\r\n    if (receiver === null || (typeof receiver !== \"object\" && typeof receiver !== \"function\")) throw new TypeError(\"Cannot use 'in' operator on non-object\");\r\n    return typeof state === \"function\" ? receiver === state : state.has(receiver);\r\n}\r\n","function getDirectionNames(hDirection, vDirection) {\n    var camelCase, snakeCase;\n    if (hDirection && vDirection) {\n        camelCase = \"\" + hDirection + vDirection[0].toUpperCase() + vDirection.slice(1);\n        snakeCase = hDirection + \"-\" + vDirection;\n    }\n    else {\n        camelCase = hDirection || vDirection;\n        snakeCase = hDirection || vDirection;\n    }\n    return { camelCase: camelCase, snakeCase: snakeCase };\n}\nfunction isBlob(url) {\n    return /^blob:/.test(url);\n}\nfunction isDataUrl(url) {\n    return /^data:/.test(url);\n}\nfunction isLocal(url) {\n    return isBlob(url) || isDataUrl(url);\n}\nfunction isCrossOriginURL(url) {\n    if (isLocal(url)) {\n        return false;\n    }\n    var pageLocation = window.location;\n    var URL_HOST_PATTERN = /(\\w+:)?(?:\\/\\/)([\\w.-]+)?(?::(\\d+))?\\/?/;\n    var urlMatch = URL_HOST_PATTERN.exec(url) || [];\n    var urlparts = {\n        protocol: urlMatch[1] || '',\n        host: urlMatch[2] || '',\n        port: urlMatch[3] || '',\n    };\n    var defaultPort = function (protocol) {\n        if (protocol === 'http') {\n            return 80;\n        }\n        else {\n            return 433;\n        }\n    };\n    var portOf = function (location) {\n        return location.port || defaultPort((location.protocol || pageLocation.protocol));\n    };\n    return !((!urlparts.protocol && !urlparts.host && !urlparts.port) ||\n        Boolean(urlparts.protocol &&\n            urlparts.protocol == pageLocation.protocol &&\n            urlparts.host &&\n            urlparts.host == pageLocation.host &&\n            urlparts.host &&\n            portOf(urlparts) == portOf(pageLocation)));\n}\nfunction isArray(value) {\n    return Array.isArray(value);\n}\nfunction isFunction(value) {\n    return typeof value === 'function';\n}\nfunction isUndefined(obj) {\n    return obj === undefined;\n}\nvar isObject = function (term) {\n    return term !== null && typeof term === 'object';\n};\n// TODO: add the typing\nfunction getOptions(options, defaultScheme, falseScheme) {\n    if (falseScheme === void 0) { falseScheme = {}; }\n    var result = {};\n    if (isObject(options)) {\n        Object.keys(defaultScheme).forEach(function (key) {\n            if (isUndefined(options[key])) {\n                result[key] = defaultScheme[key];\n            }\n            else if (isObject(defaultScheme[key])) {\n                if (isObject(options[key])) {\n                    result[key] = getOptions(options[key], defaultScheme[key], falseScheme[key]);\n                }\n                else {\n                    result[key] = options[key] ? defaultScheme[key] : falseScheme[key];\n                }\n            }\n            else if (defaultScheme[key] === true || defaultScheme[key] === false) {\n                result[key] = Boolean(options[key]);\n            }\n            else {\n                result[key] = options[key];\n            }\n        });\n        return result;\n    }\n    else {\n        if (options) {\n            return defaultScheme;\n        }\n        else {\n            return falseScheme;\n        }\n    }\n}\nfunction parseNumber(number) {\n    var parsedNumber = Number(number);\n    if (Number.isNaN(parsedNumber)) {\n        return number;\n    }\n    else {\n        return parsedNumber;\n    }\n}\nfunction isBoolean(value) {\n    return value === true || value === false;\n}\nfunction isNumber(value) {\n    return typeof value === 'number';\n}\nfunction isString(value) {\n    return typeof value === 'string';\n}\nfunction isNaN(value) {\n    return value !== value;\n}\nfunction isNumeric(value) {\n    return ((isNumber(value) && !isNaN(value)) ||\n        (isString(value) && !Number.isNaN(parseFloat(value)) && isFinite(parseFloat(value))));\n}\nfunction distance(firstPoint, secondPoint) {\n    return Math.sqrt(Math.pow(firstPoint.left - secondPoint.left, 2) + Math.pow(firstPoint.top - secondPoint.top, 2));\n}\nfunction isRoughlyEqual(a, b, tolerance) {\n    if (tolerance === void 0) { tolerance = 1e-3; }\n    return Math.abs(b - a) < tolerance;\n}\nfunction isGreater(a, b, tolerance) {\n    return isRoughlyEqual(a, b, tolerance) ? false : a > b;\n}\nfunction isLower(a, b, tolerance) {\n    return isRoughlyEqual(a, b, tolerance) ? false : a < b;\n}\nfunction isArrayBufferLike(value) {\n    return value instanceof ArrayBuffer;\n}\nfunction getCloserAngle(reference, angle) {\n    var turnsCount = Math.floor(reference / 360);\n    var firstCandidate = turnsCount * 360 + angle;\n    var secondCandidate = (turnsCount + 1) * 360 + angle;\n    if (Math.abs(firstCandidate - reference) < Math.abs(secondCandidate - reference)) {\n        return firstCandidate;\n    }\n    else {\n        return secondCandidate;\n    }\n}\nfunction sign(value) {\n    var number = +value;\n    if (number === 0 || isNaN(number)) {\n        return number;\n    }\n    return number > 0 ? 1 : -1;\n}\nfunction promiseTimeout(timeout) {\n    return new Promise(function (resolve) {\n        setTimeout(function () {\n            resolve();\n        }, timeout);\n    });\n}\n// Not performant, small function to reduce the code amount\nfunction deepClone(obj) {\n    if (!isObject(obj)) {\n        return obj;\n    }\n    var result = {};\n    if (Array.isArray(obj)) {\n        result = obj.map(function (item) { return deepClone(item); });\n    }\n    else {\n        Object.keys(obj).forEach(function (key) {\n            return (result[key] = deepClone(obj[key]));\n        });\n    }\n    return result;\n}\nfunction deepCompare(a, b, tolerance) {\n    if (tolerance === void 0) { tolerance = 1e-3; }\n    if (isNumber(a) && isNumber(b) && isRoughlyEqual(a, b, tolerance))\n        return true;\n    if (a === b)\n        return true;\n    if (a && b && typeof a == 'object' && typeof b == 'object') {\n        if (a.constructor !== b.constructor)\n            return false;\n        var length_1, i = void 0;\n        if (Array.isArray(a)) {\n            length_1 = a.length;\n            if (length_1 != b.length)\n                return false;\n            for (i = length_1; i-- !== 0;)\n                if (!deepCompare(a[i], b[i], tolerance))\n                    return false;\n            return true;\n        }\n        if (a.valueOf !== Object.prototype.valueOf)\n            return a.valueOf() === b.valueOf();\n        if (a.toString !== Object.prototype.toString)\n            return a.toString() === b.toString();\n        var keys = Object.keys(a);\n        length_1 = keys.length;\n        if (length_1 !== Object.keys(b).length)\n            return false;\n        for (i = length_1; i-- !== 0;)\n            if (!Object.prototype.hasOwnProperty.call(b, keys[i]))\n                return false;\n        for (i = length_1; i-- !== 0;) {\n            var key = keys[i];\n            if (!deepCompare(a[key], b[key], tolerance))\n                return false;\n        }\n        return true;\n    }\n    return a !== a && b !== b;\n}\nfunction isWheelEvent(event) {\n    return 'deltaX' in event;\n}\nfunction isTouchEvent(event) {\n    return 'touches' in event;\n}\nfunction isMouseEvent(event) {\n    return 'buttons' in event;\n}\nfunction emptyCoordinates() {\n    return {\n        left: 0,\n        top: 0,\n        width: 0,\n        height: 0,\n    };\n}\nfunction isCardinalDirection(value) {\n    return value === 'west' || value === 'south' || value === 'north' || value === 'east';\n}\nfunction isOrdinalDirection(value) {\n    return (isCardinalDirection(value) ||\n        value === 'westNorth' ||\n        value === 'westSouth' ||\n        value === 'eastNorth' ||\n        value === 'eastSouth');\n}\nfunction debounce(callback, delay) {\n    var timestamp;\n    var timeout;\n    function later() {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        var last = Date.now() - timestamp;\n        var delayValue = isFunction(delay) ? delay() : delay || 0;\n        if (last < delayValue && last >= 0) {\n            timeout = setTimeout(function () { return later.apply(void 0, args); }, delayValue - last);\n        }\n        else {\n            callback.apply(void 0, args);\n        }\n    }\n    function result() {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        timestamp = Date.now();\n        timeout = setTimeout(function () { return later.apply(void 0, args); }, isFunction(delay) ? delay() : delay || 0);\n    }\n    result.clear = function () {\n        clearTimeout(timeout);\n    };\n    return result;\n}\n\nexport { debounce, deepClone, deepCompare, distance, emptyCoordinates, getCloserAngle, getDirectionNames, getOptions, isArray, isArrayBufferLike, isBlob, isBoolean, isCardinalDirection, isCrossOriginURL, isDataUrl, isFunction, isGreater, isLocal, isLower, isMouseEvent, isNaN, isNumber, isNumeric, isObject, isOrdinalDirection, isRoughlyEqual, isString, isTouchEvent, isUndefined, isWheelEvent, parseNumber, promiseTimeout, sign };\n","/******************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    if (typeof b !== \"function\" && b !== null)\r\n        throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport var __createBinding = Object.create ? (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    var desc = Object.getOwnPropertyDescriptor(m, k);\r\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\r\n        desc = { enumerable: true, get: function() { return m[k]; } };\r\n    }\r\n    Object.defineProperty(o, k2, desc);\r\n}) : (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    o[k2] = m[k];\r\n});\r\n\r\nexport function __exportStar(m, o) {\r\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(o, p)) __createBinding(o, m, p);\r\n}\r\n\r\nexport function __values(o) {\r\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\r\n    if (m) return m.call(o);\r\n    if (o && typeof o.length === \"number\") return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\n/** @deprecated */\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\n/** @deprecated */\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n}\r\n\r\nexport function __spreadArray(to, from, pack) {\r\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\r\n        if (ar || !(i in from)) {\r\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\r\n            ar[i] = from[i];\r\n        }\r\n    }\r\n    return to.concat(ar || Array.prototype.slice.call(from));\r\n}\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nvar __setModuleDefault = Object.create ? (function(o, v) {\r\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\r\n}) : function(o, v) {\r\n    o[\"default\"] = v;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\r\n    __setModuleDefault(result, mod);\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n\r\nexport function __classPrivateFieldGet(receiver, state, kind, f) {\r\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a getter\");\r\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot read private member from an object whose class did not declare it\");\r\n    return kind === \"m\" ? f : kind === \"a\" ? f.call(receiver) : f ? f.value : state.get(receiver);\r\n}\r\n\r\nexport function __classPrivateFieldSet(receiver, state, value, kind, f) {\r\n    if (kind === \"m\") throw new TypeError(\"Private method is not writable\");\r\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a setter\");\r\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot write private member to an object whose class did not declare it\");\r\n    return (kind === \"a\" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;\r\n}\r\n\r\nexport function __classPrivateFieldIn(state, receiver) {\r\n    if (receiver === null || (typeof receiver !== \"object\" && typeof receiver !== \"function\")) throw new TypeError(\"Cannot use 'in' operator on non-object\");\r\n    return typeof state === \"function\" ? receiver === state : state.has(receiver);\r\n}\r\n","var ALL_DIRECTIONS = ['left', 'right', 'top', 'bottom'];\nvar HORIZONTAL_DIRECTIONS = ['left', 'right'];\nvar VERTICAL_DIRECTIONS = ['top', 'bottom'];\n\nexport { ALL_DIRECTIONS, HORIZONTAL_DIRECTIONS, VERTICAL_DIRECTIONS };\n","var ImageRestriction;\n(function (ImageRestriction) {\n    ImageRestriction[\"fillArea\"] = \"fillArea\";\n    ImageRestriction[\"fitArea\"] = \"fitArea\";\n    ImageRestriction[\"stencil\"] = \"stencil\";\n    ImageRestriction[\"none\"] = \"none\";\n})(ImageRestriction || (ImageRestriction = {}));\nvar Priority;\n(function (Priority) {\n    Priority[\"coordinates\"] = \"coordinates\";\n    Priority[\"visibleArea\"] = \"visibleArea\";\n})(Priority || (Priority = {}));\n\nexport { ImageRestriction, Priority };\n","import { __assign } from 'tslib';\nimport { emptyCoordinates, isUndefined } from '../utils/index.js';\nimport { mergePositionRestrictions, coordinatesToPositionRestrictions, applyScale, maxScale, applyMove, inverseMove, fitToPositionRestrictions } from '../service/utils.js';\nimport { getAspectRatio, getSizeRestrictions, getPositionRestrictions, getAreaSizeRestrictions } from '../service/helpers.js';\nimport { copyState } from './copyState.js';\nimport '../types/index.js';\nimport { approximateSize } from '../service/approximateSize.js';\nimport { fitVisibleArea } from '../service/fitVisibleArea.js';\nimport { moveCoordinatesAlgorithm } from '../algorithms/moveCoordinatesAlgorithm.js';\n\nvar SetCoordinatesMode;\n(function (SetCoordinatesMode) {\n    SetCoordinatesMode[\"limit\"] = \"limit\";\n    SetCoordinatesMode[\"zoom\"] = \"zoom\";\n    SetCoordinatesMode[\"unsafe\"] = \"unsafe\";\n})(SetCoordinatesMode || (SetCoordinatesMode = {}));\nfunction setCoordinates(state, settings, transform, \n// If you set mode to `false`, the coordinates can leave the visible area\nmode) {\n    if (mode === void 0) { mode = true; }\n    var currentMode = mode === false ? SetCoordinatesMode.unsafe : mode === true ? SetCoordinatesMode.zoom : mode;\n    var aspectRatio = getAspectRatio(state, settings);\n    var sizeRestrictions = getSizeRestrictions(state, settings);\n    if (state.visibleArea && currentMode === SetCoordinatesMode.limit) {\n        sizeRestrictions = __assign(__assign({}, sizeRestrictions), { minWidth: Math.min(state.visibleArea.width, sizeRestrictions.minWidth), minHeight: Math.min(state.visibleArea.height, sizeRestrictions.minHeight), maxWidth: Math.min(state.visibleArea.width, sizeRestrictions.maxWidth), maxHeight: Math.min(state.visibleArea.height, sizeRestrictions.maxHeight) });\n    }\n    var positionRestrictions = getPositionRestrictions(state, settings);\n    if (state.visibleArea && currentMode === SetCoordinatesMode.limit) {\n        positionRestrictions = mergePositionRestrictions(positionRestrictions, coordinatesToPositionRestrictions(state.visibleArea));\n    }\n    var move = function (prevCoordinates, newCoordinates) {\n        return moveCoordinatesAlgorithm(prevCoordinates, {\n            left: newCoordinates.left - (prevCoordinates.left || 0),\n            top: newCoordinates.top - (prevCoordinates.top || 0),\n        }, positionRestrictions);\n    };\n    var resize = function (prevCoordinates, newCoordinates) {\n        var coordinates = __assign(__assign(__assign({}, prevCoordinates), approximateSize({\n            width: newCoordinates.width,\n            height: newCoordinates.height,\n            sizeRestrictions: sizeRestrictions,\n            aspectRatio: aspectRatio,\n        })), { left: 0, top: 0 });\n        return move(coordinates, {\n            left: prevCoordinates.left || 0,\n            top: prevCoordinates.top || 0,\n        });\n    };\n    var coordinates = state.coordinates ? __assign({}, state.coordinates) : emptyCoordinates();\n    var transforms = Array.isArray(transform) ? transform : [transform];\n    transforms.forEach(function (transform) {\n        var changes;\n        if (typeof transform === 'function') {\n            changes = transform(__assign(__assign({}, state), { coordinates: coordinates }), settings);\n        }\n        else {\n            changes = transform;\n        }\n        if (changes) {\n            if (!isUndefined(changes.width) || !isUndefined(changes.height)) {\n                coordinates = resize(coordinates, __assign(__assign({}, coordinates), changes));\n            }\n            if (!isUndefined(changes.left) || !isUndefined(changes.top)) {\n                coordinates = move(coordinates, __assign(__assign({}, coordinates), changes));\n            }\n        }\n    });\n    var result = __assign(__assign({}, copyState(state)), { coordinates: coordinates });\n    if (result.visibleArea && currentMode === SetCoordinatesMode.zoom) {\n        var widthIntersections = Math.max(0, result.coordinates.width - result.visibleArea.width);\n        var heightIntersections = Math.max(0, result.coordinates.height - result.visibleArea.height);\n        var areaSizeRestrictions = getAreaSizeRestrictions(state, settings);\n        var scale = widthIntersections > heightIntersections\n            ? result.coordinates.width / result.visibleArea.width\n            : result.coordinates.height / result.visibleArea.height;\n        if (scale > 1) {\n            result.visibleArea = applyScale(result.visibleArea, Math.min(scale, maxScale(result.visibleArea, areaSizeRestrictions)));\n        }\n        result.visibleArea = applyMove(result.visibleArea, inverseMove(fitToPositionRestrictions(result.coordinates, coordinatesToPositionRestrictions(result.visibleArea))));\n        return fitVisibleArea(result, settings);\n    }\n    else {\n        return result;\n    }\n}\n\nexport { SetCoordinatesMode, setCoordinates };\n","import { __assign } from 'tslib';\nimport { ALL_DIRECTIONS } from '../constants/index.js';\nimport { isLower, isGreater, isNumber, isNumeric, isUndefined, isFunction } from '../utils/index.js';\n\nfunction diff(firstObject, secondObject) {\n    return {\n        left: firstObject.left - secondObject.left,\n        top: firstObject.top - secondObject.top,\n    };\n}\nfunction getCenter(object) {\n    return {\n        left: object.left + object.width / 2,\n        top: object.top + object.height / 2,\n    };\n}\nfunction getOppositeSide(side) {\n    return {\n        left: 'right',\n        top: 'bottom',\n        right: 'left',\n        bottom: 'top',\n    }[side];\n}\nfunction sizeDistance(a, b) {\n    return Math.pow(a.width - b.width, 2) + Math.pow(a.height - b.height, 2);\n}\nfunction applyDirections(coordinates, directions) {\n    return {\n        left: coordinates.left - directions.left,\n        top: coordinates.top - directions.top,\n        width: coordinates.width + directions.left + directions.right,\n        height: coordinates.height + directions.top + directions.bottom,\n    };\n}\nfunction inverseMove(directions) {\n    return {\n        left: -directions.left,\n        top: -directions.top,\n    };\n}\nfunction applyMove(object, move) {\n    return __assign(__assign({}, object), { left: object.left + move.left, top: object.top + move.top });\n}\nfunction coordinatesToPositionRestrictions(coordinates) {\n    return {\n        left: coordinates.left,\n        top: coordinates.top,\n        right: coordinates.left + coordinates.width,\n        bottom: coordinates.top + coordinates.height,\n    };\n}\nfunction applyScale(object, factor, center, progress) {\n    if (factor !== 1) {\n        if ('left' in object || 'top' in object) {\n            if (center) {\n                var currentCenter = getCenter(object);\n                return {\n                    width: object.width * factor,\n                    height: object.height * factor,\n                    left: object.left +\n                        (object.width * (1 - factor)) / 2 +\n                        (center.left - currentCenter.left) * (progress || 1 - factor),\n                    top: object.top +\n                        (object.height * (1 - factor)) / 2 +\n                        (center.top - currentCenter.top) * (progress || 1 - factor),\n                };\n            }\n            else {\n                return {\n                    width: object.width * factor,\n                    height: object.height * factor,\n                    left: object.left + (object.width * (1 - factor)) / 2,\n                    top: object.top + (object.height * (1 - factor)) / 2,\n                };\n            }\n        }\n        else {\n            return {\n                width: object.width * factor,\n                height: object.height * factor,\n            };\n        }\n    }\n    else {\n        return object;\n    }\n}\nfunction ratio(object) {\n    return object.width / object.height;\n}\nfunction maxScale(size, restrictions) {\n    return Math.min(restrictions.maxWidth ? restrictions.maxWidth / size.width : Infinity, restrictions.maxHeight ? restrictions.maxHeight / size.height : Infinity);\n}\nfunction minScale(size, restrictions) {\n    return Math.max(restrictions.minWidth ? restrictions.minWidth / size.width : 0, restrictions.minHeight ? restrictions.minHeight / size.height : 0);\n}\nfunction getBrokenRatio(currentAspectRatio, aspectRatio) {\n    var ratioBroken;\n    if (aspectRatio.minimum && isLower(currentAspectRatio, aspectRatio.minimum)) {\n        ratioBroken = aspectRatio.minimum;\n    }\n    else if (aspectRatio.maximum && isGreater(currentAspectRatio, aspectRatio.maximum)) {\n        ratioBroken = aspectRatio.maximum;\n    }\n    return ratioBroken;\n}\nfunction fitToSizeRestrictions(coordinates, sizeRestrictions) {\n    var aspectRatio = ratio(coordinates);\n    var scale = 1;\n    if (sizeRestrictions.minWidth > 0 && sizeRestrictions.minHeight > 0) {\n        if (aspectRatio > sizeRestrictions.minWidth / sizeRestrictions.minHeight) {\n            if (coordinates.height < sizeRestrictions.minHeight) {\n                scale = sizeRestrictions.minHeight / coordinates.height;\n            }\n        }\n        else {\n            if (coordinates.width < sizeRestrictions.minWidth) {\n                scale = sizeRestrictions.minWidth / coordinates.width;\n            }\n        }\n    }\n    else if (sizeRestrictions.minWidth > 0) {\n        if (coordinates.width < sizeRestrictions.minWidth) {\n            scale = sizeRestrictions.minWidth / coordinates.width;\n        }\n    }\n    else if (sizeRestrictions.minHeight > 0) {\n        if (coordinates.height < sizeRestrictions.minHeight) {\n            scale = sizeRestrictions.minHeight / coordinates.height;\n        }\n    }\n    if (sizeRestrictions.maxWidth < Infinity && sizeRestrictions.maxHeight < Infinity) {\n        if (aspectRatio > sizeRestrictions.maxWidth / sizeRestrictions.maxHeight) {\n            if (coordinates.width > sizeRestrictions.maxWidth) {\n                scale = sizeRestrictions.maxWidth / coordinates.width;\n            }\n        }\n        else {\n            if (coordinates.height > sizeRestrictions.maxHeight) {\n                scale = sizeRestrictions.maxHeight / coordinates.height;\n            }\n        }\n    }\n    else if (sizeRestrictions.maxWidth < Infinity) {\n        if (coordinates.width > sizeRestrictions.maxWidth) {\n            scale = sizeRestrictions.maxWidth / coordinates.width;\n        }\n    }\n    else if (sizeRestrictions.maxHeight < Infinity) {\n        if (coordinates.height > sizeRestrictions.maxHeight) {\n            scale = sizeRestrictions.maxHeight / coordinates.height;\n        }\n    }\n    return scale;\n}\nfunction getIntersections(object, positionRestrictions) {\n    var intersections = {\n        left: 0,\n        top: 0,\n        right: 0,\n        bottom: 0,\n    };\n    ALL_DIRECTIONS.forEach(function (direction) {\n        var areaLimit = positionRestrictions[direction];\n        var objectLimit = coordinatesToPositionRestrictions(object)[direction];\n        if (areaLimit !== undefined && objectLimit !== undefined) {\n            if (direction === 'left' || direction === 'top') {\n                intersections[direction] = Math.max(0, areaLimit - objectLimit);\n            }\n            else {\n                intersections[direction] = Math.max(0, objectLimit - areaLimit);\n            }\n        }\n        else {\n            intersections[direction] = 0;\n        }\n    });\n    return intersections;\n}\nfunction resizeToSizeRestrictions(coordinates, sizeRestrictions) {\n    return applyScale(coordinates, fitToSizeRestrictions(coordinates, sizeRestrictions));\n}\nfunction rotateSize(size, angle) {\n    var radians = (angle * Math.PI) / 180;\n    return {\n        width: Math.abs(size.width * Math.cos(radians)) + Math.abs(size.height * Math.sin(radians)),\n        height: Math.abs(size.width * Math.sin(radians)) + Math.abs(size.height * Math.cos(radians)),\n    };\n}\nfunction rotatePoint(point, angle, anchor) {\n    var radians = (angle * Math.PI) / 180;\n    if (anchor) {\n        return {\n            left: (point.left - anchor.left) * Math.cos(radians) -\n                (point.top - anchor.top) * Math.sin(radians) +\n                anchor.left,\n            top: (point.left - anchor.left) * Math.sin(radians) +\n                (point.top - anchor.top) * Math.cos(radians) +\n                anchor.top,\n        };\n    }\n    else {\n        return {\n            left: point.left * Math.cos(radians) - point.top * Math.sin(radians),\n            top: point.left * Math.sin(radians) + point.top * Math.cos(radians),\n        };\n    }\n}\nfunction positionToSizeRestrictions(positionRestrictions) {\n    return {\n        minWidth: 0,\n        minHeight: 0,\n        maxWidth: positionRestrictions.right !== undefined && positionRestrictions.left !== undefined\n            ? positionRestrictions.right - positionRestrictions.left\n            : Infinity,\n        maxHeight: positionRestrictions.bottom !== undefined && positionRestrictions.top !== undefined\n            ? positionRestrictions.bottom - positionRestrictions.top\n            : Infinity,\n    };\n}\nfunction mergePositionRestrictions(a, b) {\n    var restrictions = {};\n    ALL_DIRECTIONS.forEach(function (direction) {\n        var firstDirection = a[direction];\n        var secondDirection = b[direction];\n        if (firstDirection !== undefined && secondDirection !== undefined) {\n            if (direction === 'left' || direction === 'top') {\n                restrictions[direction] = Math.max(firstDirection, secondDirection);\n            }\n            else {\n                restrictions[direction] = Math.min(firstDirection, secondDirection);\n            }\n        }\n        else if (secondDirection !== undefined) {\n            restrictions[direction] = secondDirection;\n        }\n        else if (firstDirection !== undefined) {\n            restrictions[direction] = firstDirection;\n        }\n    });\n    return restrictions;\n}\nfunction fitToPositionRestrictions(coordinates, positionRestrictions) {\n    var directions = {\n        left: 0,\n        top: 0,\n    };\n    var intersection = getIntersections(coordinates, positionRestrictions);\n    if (intersection.left && intersection.left > 0) {\n        directions.left = intersection.left;\n    }\n    else if (intersection.right && intersection.right > 0) {\n        directions.left = -intersection.right;\n    }\n    if (intersection.top && intersection.top > 0) {\n        directions.top = intersection.top;\n    }\n    else if (intersection.bottom && intersection.bottom > 0) {\n        directions.top = -intersection.bottom;\n    }\n    return directions;\n}\nfunction moveToPositionRestrictions(coordinates, positionRestrictions) {\n    return applyMove(coordinates, fitToPositionRestrictions(coordinates, positionRestrictions));\n}\nfunction aspectRatioIntersection(main, subset) {\n    if (!subset) {\n        return main;\n    }\n    else if (!main) {\n        return subset;\n    }\n    else {\n        return {\n            minimum: Math.min(main.maximum, Math.max(main.minimum, subset.minimum)),\n            maximum: Math.max(main.minimum, Math.min(main.maximum, subset.maximum)),\n        };\n    }\n}\nfunction createAspectRatio(aspectRatio) {\n    if (aspectRatio === void 0) { aspectRatio = {}; }\n    if (isNumber(aspectRatio)) {\n        return {\n            minimum: aspectRatio,\n            maximum: aspectRatio,\n        };\n    }\n    else {\n        return {\n            minimum: isNumeric(aspectRatio.minimum) ? aspectRatio.minimum : 0,\n            maximum: isNumeric(aspectRatio.maximum) ? aspectRatio.maximum : Infinity,\n        };\n    }\n}\nfunction getTransitionStyle(transitions) {\n    return transitions ? transitions.timingFunction + \" \" + (transitions.active ? transitions.duration : 0) + \"ms\" : 'none';\n}\nfunction isConsistentSize(size, restrictions) {\n    return ((isUndefined(restrictions.maxWidth) || !isGreater(size.width, restrictions.maxWidth)) &&\n        (isUndefined(restrictions.maxHeight) || !isGreater(size.height, restrictions.maxHeight)) &&\n        (isUndefined(restrictions.minHeight) || !isLower(size.height, restrictions.minHeight)) &&\n        (isUndefined(restrictions.minWidth) || !isLower(size.width, restrictions.minWidth)));\n}\nfunction isConsistentPosition(coordinates, restrictions) {\n    return ((isUndefined(restrictions.left) || !isLower(coordinates.left, restrictions.left)) &&\n        (isUndefined(restrictions.top) || !isLower(coordinates.top, restrictions.top)) &&\n        (isUndefined(restrictions.right) || !isGreater(coordinates.left + coordinates.width, restrictions.right)) &&\n        (isUndefined(restrictions.bottom) || !isGreater(coordinates.top + coordinates.height, restrictions.bottom)));\n}\nfunction getCloserSize(candidates, reference, sizeRestrictions, aspectRatio) {\n    var traverse = function (ignoreMinimum) {\n        return candidates.reduce(function (minimum, size) {\n            var _a = isFunction(sizeRestrictions)\n                ? sizeRestrictions(size)\n                : sizeRestrictions, maxHeight = _a.maxHeight, maxWidth = _a.maxWidth, minWidth = _a.minWidth, minHeight = _a.minHeight;\n            var preparedAspectRatio = createAspectRatio(isFunction(aspectRatio) ? aspectRatio(size) : aspectRatio);\n            var preparedSizeRestrictions = ignoreMinimum\n                ? { maxWidth: maxWidth, maxHeight: maxHeight }\n                : { maxWidth: maxWidth, maxHeight: maxHeight, minWidth: minWidth, minHeight: minHeight };\n            if (isConsistentSize(size, preparedSizeRestrictions) &&\n                !getBrokenRatio(ratio(size), preparedAspectRatio) &&\n                size.width &&\n                size.height) {\n                return !minimum || isLower(sizeDistance(size, reference), sizeDistance(minimum, reference))\n                    ? size\n                    : minimum;\n            }\n            else {\n                return minimum;\n            }\n        }, null);\n    };\n    return traverse() || traverse(true);\n}\n\nexport { applyDirections, applyMove, applyScale, aspectRatioIntersection, coordinatesToPositionRestrictions, createAspectRatio, diff, fitToPositionRestrictions, fitToSizeRestrictions, getBrokenRatio, getCenter, getCloserSize, getIntersections, getOppositeSide, getTransitionStyle, inverseMove, isConsistentPosition, isConsistentSize, maxScale, mergePositionRestrictions, minScale, moveToPositionRestrictions, positionToSizeRestrictions, ratio, resizeToSizeRestrictions, rotatePoint, rotateSize, sizeDistance };\n","import { __assign } from 'tslib';\nimport { isFunction, emptyCoordinates, isNumber, isBoolean } from '../utils/index.js';\nimport { createAspectRatio, rotateSize, moveToPositionRestrictions, getBrokenRatio, ratio, isConsistentSize, isConsistentPosition } from './utils.js';\nimport { calculateAreaSizeRestrictions, calculateSizeRestrictions } from './sizeRestrictions.js';\n\nfunction isInitializedState(state) {\n    return Boolean(state && state.visibleArea && state.coordinates);\n}\nfunction getAreaSizeRestrictions(state, settings) {\n    return calculateAreaSizeRestrictions(state, settings);\n}\nfunction getAreaPositionRestrictions(state, settings) {\n    return isFunction(settings.areaPositionRestrictions)\n        ? settings.areaPositionRestrictions(state, settings)\n        : settings.areaPositionRestrictions;\n}\nfunction getSizeRestrictions(state, settings) {\n    return calculateSizeRestrictions(state, settings);\n}\nfunction getPositionRestrictions(state, settings) {\n    return isFunction(settings.positionRestrictions)\n        ? settings.positionRestrictions(state, settings)\n        : settings.positionRestrictions;\n}\nfunction getCoefficient(state) {\n    return state.visibleArea ? state.visibleArea.width / state.boundary.width : 0;\n}\nfunction getStencilCoordinates(state) {\n    if (isInitializedState(state)) {\n        var _a = state.coordinates, width = _a.width, height = _a.height, left = _a.left, top_1 = _a.top;\n        var coefficient = getCoefficient(state);\n        return {\n            width: width / coefficient,\n            height: height / coefficient,\n            left: (left - state.visibleArea.left) / coefficient,\n            top: (top_1 - state.visibleArea.top) / coefficient,\n        };\n    }\n    else {\n        return emptyCoordinates();\n    }\n}\nfunction getAspectRatio(state, settings) {\n    return createAspectRatio(isFunction(settings.aspectRatio) ? settings.aspectRatio(state, settings) : settings.aspectRatio);\n}\nfunction getDefaultCoordinates(state, settings) {\n    return isFunction(settings.defaultCoordinates)\n        ? settings.defaultCoordinates(state, settings)\n        : settings.defaultCoordinates;\n}\nfunction getDefaultVisibleArea(state, settings) {\n    return isFunction(settings.defaultVisibleArea)\n        ? settings.defaultVisibleArea(state, settings)\n        : settings.defaultVisibleArea;\n}\nfunction getDefaultTransforms(state, settings) {\n    var transforms = __assign(__assign({}, state.transforms), { flip: __assign({}, state.transforms.flip) });\n    if (settings.defaultTransforms) {\n        var defaultTransforms = isFunction(settings.defaultTransforms)\n            ? settings.defaultTransforms(state, settings)\n            : settings.defaultTransforms;\n        if (isNumber(defaultTransforms.rotate)) {\n            transforms.rotate = defaultTransforms.rotate;\n        }\n        if (defaultTransforms.flip) {\n            if (isBoolean(defaultTransforms.flip.horizontal)) {\n                transforms.flip.horizontal = defaultTransforms.flip.horizontal;\n            }\n            if (isBoolean(defaultTransforms.flip.vertical)) {\n                transforms.flip.vertical = defaultTransforms.flip.vertical;\n            }\n        }\n    }\n    return transforms;\n}\nfunction getTransformedImageSize(state) {\n    if (state.imageSize && state.imageSize.width && state.imageSize.height) {\n        return rotateSize(state.imageSize, state.transforms.rotate);\n    }\n    else {\n        return {\n            width: 0,\n            height: 0,\n        };\n    }\n}\nfunction getMinimumSize(state) {\n    // The magic number is the approximation of the handler size\n    // Temporary solution that should be improved in the future\n    return state.coordinates\n        ? Math.min(state.coordinates.width, state.coordinates.height, 20 * getCoefficient(state))\n        : 1;\n}\nfunction getRoundedCoordinates(state, settings) {\n    if (isInitializedState(state)) {\n        var sizeRestrictions = getSizeRestrictions(state, settings);\n        var positionRestrictions = getPositionRestrictions(state, settings);\n        var roundCoordinates = {\n            width: Math.round(state.coordinates.width),\n            height: Math.round(state.coordinates.height),\n            left: Math.round(state.coordinates.left),\n            top: Math.round(state.coordinates.top),\n        };\n        if (roundCoordinates.width > sizeRestrictions.maxWidth) {\n            roundCoordinates.width = Math.floor(state.coordinates.width);\n        }\n        else if (roundCoordinates.width < sizeRestrictions.minWidth) {\n            roundCoordinates.width = Math.ceil(state.coordinates.width);\n        }\n        if (roundCoordinates.height > sizeRestrictions.maxHeight) {\n            roundCoordinates.height = Math.floor(state.coordinates.height);\n        }\n        else if (roundCoordinates.height < sizeRestrictions.minHeight) {\n            roundCoordinates.height = Math.ceil(state.coordinates.height);\n        }\n        return moveToPositionRestrictions(roundCoordinates, positionRestrictions);\n    }\n    else {\n        return null;\n    }\n}\nfunction isConsistentState(state, settings) {\n    if (isInitializedState(state)) {\n        return (!getBrokenRatio(ratio(state.coordinates), getAspectRatio(state, settings)) &&\n            isConsistentSize(state.visibleArea, getAreaSizeRestrictions(state, settings)) &&\n            isConsistentSize(state.coordinates, getSizeRestrictions(state, settings)) &&\n            isConsistentPosition(state.visibleArea, getAreaPositionRestrictions(state, settings)) &&\n            isConsistentPosition(state.coordinates, getPositionRestrictions(state, settings)));\n    }\n    else {\n        return true;\n    }\n}\n\nexport { getAreaPositionRestrictions, getAreaSizeRestrictions, getAspectRatio, getCoefficient, getDefaultCoordinates, getDefaultTransforms, getDefaultVisibleArea, getMinimumSize, getPositionRestrictions, getRoundedCoordinates, getSizeRestrictions, getStencilCoordinates, getTransformedImageSize, isConsistentState, isInitializedState };\n","import { __assign } from 'tslib';\nimport { isFunction, isNumeric, parseNumber } from '../utils/index.js';\nimport { ratio } from './utils.js';\nimport { getPositionRestrictions } from './helpers.js';\n\nfunction reconcileSizeRestrictions(sizeRestrictions) {\n    var restrictions = __assign({}, sizeRestrictions);\n    // Process the border cases when minimum height / width larger than maximum height / width\n    if (restrictions.minWidth > restrictions.maxWidth) {\n        restrictions.minWidth = restrictions.maxWidth;\n    }\n    if (restrictions.minHeight > restrictions.maxHeight) {\n        restrictions.minHeight = restrictions.maxHeight;\n    }\n    return restrictions;\n}\nfunction mergeSizeRestrictions(a, b) {\n    var first = a;\n    var second = __assign({ minWidth: 0, minHeight: 0, maxWidth: Infinity, maxHeight: Infinity }, b);\n    return reconcileSizeRestrictions({\n        maxHeight: Math.min(first.maxHeight, second.maxHeight),\n        minHeight: Math.max(first.minHeight, second.minHeight),\n        maxWidth: Math.min(first.maxWidth, second.maxWidth),\n        minWidth: Math.max(first.minWidth, second.minWidth),\n    });\n}\nfunction calculateSizeRestrictions(state, settings) {\n    var sizeRestrictions = isFunction(settings.sizeRestrictions)\n        ? settings.sizeRestrictions(state, settings)\n        : settings.sizeRestrictions;\n    var positionRestrictions = getPositionRestrictions(state, settings);\n    // User can forget to set some of restrictions, so we should initialize them by default values\n    var restrictions = {\n        minWidth: isNumeric(sizeRestrictions.minWidth) ? parseNumber(sizeRestrictions.minWidth) : 0,\n        minHeight: isNumeric(sizeRestrictions.minHeight) ? parseNumber(sizeRestrictions.minHeight) : 0,\n        maxWidth: isNumeric(sizeRestrictions.maxWidth) ? parseNumber(sizeRestrictions.maxWidth) : Infinity,\n        maxHeight: isNumeric(sizeRestrictions.maxHeight) ? parseNumber(sizeRestrictions.maxHeight) : Infinity,\n    };\n    // The situation, when stencil can't be positioned in cropper due to positionRestrictions should be avoided\n    if (positionRestrictions.left !== undefined && positionRestrictions.right !== undefined) {\n        restrictions.maxWidth = Math.min(restrictions.maxWidth, positionRestrictions.right - positionRestrictions.left);\n    }\n    if (positionRestrictions.bottom !== undefined && positionRestrictions.top !== undefined) {\n        restrictions.maxHeight = Math.min(restrictions.maxHeight, positionRestrictions.bottom - positionRestrictions.top);\n    }\n    return reconcileSizeRestrictions(restrictions);\n}\nfunction calculateAreaSizeRestrictions(state, settings) {\n    var sizeRestrictions = isFunction(settings.areaSizeRestrictions)\n        ? settings.areaSizeRestrictions(state, settings)\n        : settings.areaSizeRestrictions;\n    if (sizeRestrictions.maxWidth < Infinity && sizeRestrictions.maxHeight < Infinity) {\n        if (ratio(state.boundary) > sizeRestrictions.maxWidth / sizeRestrictions.maxHeight) {\n            sizeRestrictions.maxHeight = sizeRestrictions.maxWidth / ratio(state.boundary);\n        }\n        else {\n            sizeRestrictions.maxWidth = sizeRestrictions.maxHeight * ratio(state.boundary);\n        }\n    }\n    return reconcileSizeRestrictions(sizeRestrictions);\n}\n\nexport { calculateAreaSizeRestrictions, calculateSizeRestrictions, mergeSizeRestrictions, reconcileSizeRestrictions };\n","import { deepClone } from '../utils/index.js';\n\nfunction copyState(state) {\n    return deepClone(state);\n}\n\nexport { copyState };\n","import { getCloserSize, createAspectRatio, resizeToSizeRestrictions } from './utils.js';\n\n// Limitations:\n// 1. Assume that maximum width and height always larger than minimum width and height\n// 2. Assume that aspectRatio.minimum < aspectRatio.maximum\n// If you break this limitations function could return null!\nfunction approximateSize(params) {\n    var width = params.width, height = params.height;\n    var sizeRestrictions = params.sizeRestrictions || {\n        minWidth: 0,\n        minHeight: 0,\n        maxWidth: Infinity,\n        maxHeight: Infinity,\n    };\n    var aspectRatio = createAspectRatio(params.aspectRatio);\n    var coordinates = {\n        width: Math.max(sizeRestrictions.minWidth, Math.min(sizeRestrictions.maxWidth, width)),\n        height: Math.max(sizeRestrictions.minHeight, Math.min(sizeRestrictions.maxHeight, height)),\n    };\n    var candidates = [coordinates];\n    if (aspectRatio) {\n        [aspectRatio.minimum, aspectRatio.maximum].forEach(function (ratio) {\n            if (ratio) {\n                candidates.push({ width: coordinates.width, height: coordinates.width / ratio }, { width: coordinates.height * ratio, height: coordinates.height });\n            }\n        });\n    }\n    // Resize the candidates as much as possible to prevent breaking minimum size\n    candidates = candidates.map(function (candidate) { return resizeToSizeRestrictions(candidate, sizeRestrictions); });\n    // TODO: fix the type of return value\n    return getCloserSize(candidates, { width: width, height: height }, sizeRestrictions, aspectRatio);\n}\n\nexport { approximateSize };\n","import { __assign } from 'tslib';\nimport { ratio, applyMove, diff, getCenter, moveToPositionRestrictions } from './utils.js';\nimport { getAreaSizeRestrictions, getAreaPositionRestrictions } from './helpers.js';\nimport { copyState } from '../state/copyState.js';\nimport '../types/index.js';\nimport '../state/setCoordinates.js';\nimport { approximateSize } from './approximateSize.js';\n\nfunction fitVisibleArea(state, settings) {\n    var result = copyState(state);\n    if (state.visibleArea) {\n        var areaSizeRestrictions = getAreaSizeRestrictions(state, settings);\n        // Fit the visible area to its size restrictions and boundary aspect ratio:\n        result.visibleArea = __assign(__assign({}, state.visibleArea), approximateSize({\n            width: state.visibleArea.width,\n            height: state.visibleArea.height,\n            aspectRatio: {\n                minimum: ratio(result.boundary),\n                maximum: ratio(result.boundary),\n            },\n            sizeRestrictions: areaSizeRestrictions,\n        }));\n        // Return the visible area to previous center\n        result.visibleArea = applyMove(result.visibleArea, diff(getCenter(state.visibleArea), getCenter(result.visibleArea)));\n        // Fit the visible area to positions restrictions\n        result.visibleArea = moveToPositionRestrictions(result.visibleArea, getAreaPositionRestrictions(result, settings));\n    }\n    return result;\n}\n\nexport { fitVisibleArea };\n","import 'tslib';\nimport { moveToPositionRestrictions, applyMove } from '../service/utils.js';\nimport '../types/index.js';\nimport '../state/setCoordinates.js';\n\nfunction moveCoordinatesAlgorithm(coordinates, directions, positionRestrictions) {\n    var movedCoordinates = applyMove(coordinates, directions);\n    return positionRestrictions ? moveToPositionRestrictions(movedCoordinates, positionRestrictions) : movedCoordinates;\n}\n\nexport { moveCoordinatesAlgorithm };\n","import { __assign } from 'tslib';\nimport { applyMove, diff, getCenter, moveToPositionRestrictions, mergePositionRestrictions, coordinatesToPositionRestrictions } from './utils.js';\nimport { getAspectRatio, getSizeRestrictions, getPositionRestrictions } from './helpers.js';\nimport { copyState } from '../state/copyState.js';\nimport '../types/index.js';\nimport '../state/setCoordinates.js';\nimport { approximateSize } from './approximateSize.js';\n\nfunction fitCoordinates(state, settings) {\n    if (state.coordinates) {\n        var result = copyState(state);\n        var aspectRatio = getAspectRatio(state, settings);\n        var sizeRestrictions = getSizeRestrictions(state, settings);\n        // Fit the size of coordinates to existing size restrictions and visible area\n        result.coordinates = __assign(__assign({}, state.coordinates), approximateSize({\n            width: state.coordinates.width,\n            height: state.coordinates.height,\n            aspectRatio: aspectRatio,\n            sizeRestrictions: state.visibleArea\n                ? {\n                    maxWidth: Math.min(state.visibleArea.width, sizeRestrictions.maxWidth),\n                    maxHeight: Math.min(state.visibleArea.height, sizeRestrictions.maxHeight),\n                    minHeight: Math.min(state.visibleArea.height, sizeRestrictions.minHeight),\n                    minWidth: Math.min(state.visibleArea.width, sizeRestrictions.minWidth),\n                }\n                : sizeRestrictions,\n        }));\n        // Return the coordinates to the previous center\n        result.coordinates = applyMove(result.coordinates, diff(getCenter(state.coordinates), getCenter(result.coordinates)));\n        // Fit the coordinates to position restrictions and visible area\n        result.coordinates = moveToPositionRestrictions(result.coordinates, state.visibleArea\n            ? mergePositionRestrictions(coordinatesToPositionRestrictions(state.visibleArea), getPositionRestrictions(result, settings))\n            : getPositionRestrictions(result, settings));\n        return result;\n    }\n    return state;\n}\n\nexport { fitCoordinates };\n","import { __assign } from 'tslib';\nimport { copyState } from './copyState.js';\nimport { fitCoordinates } from '../service/fitCoordinates.js';\nimport { fitVisibleArea } from '../service/fitVisibleArea.js';\n\nfunction setVisibleArea(state, settings, visibleArea, \n// If you set safe to `false`, the coordinates will be able to leave the visible area\nsafe) {\n    if (safe === void 0) { safe = true; }\n    var result = __assign(__assign({}, copyState(state)), { visibleArea: visibleArea });\n    // There is no possibility to break visible area limitations.\n    result = fitVisibleArea(result, settings);\n    if (safe) {\n        result = fitCoordinates(result, settings);\n    }\n    return result;\n}\n\nexport { setVisibleArea };\n","import 'tslib';\nimport { getDefaultTransforms, getDefaultVisibleArea, getDefaultCoordinates } from '../service/helpers.js';\nimport { Priority } from '../types/index.js';\nimport { setCoordinates, SetCoordinatesMode } from './setCoordinates.js';\nimport { setVisibleArea } from './setVisibleArea.js';\n\nfunction createState(options, settings) {\n    var _a, _b, _c, _d, _e;\n    var boundary = options.boundary, image = options.image;\n    var state = {\n        boundary: {\n            width: boundary.width,\n            height: boundary.height,\n        },\n        imageSize: {\n            width: image.width,\n            height: image.height,\n        },\n        transforms: {\n            rotate: ((_a = image.transforms) === null || _a === void 0 ? void 0 : _a.rotate) || 0,\n            flip: {\n                horizontal: ((_c = (_b = image.transforms) === null || _b === void 0 ? void 0 : _b.flip) === null || _c === void 0 ? void 0 : _c.horizontal) || false,\n                vertical: ((_e = (_d = image.transforms) === null || _d === void 0 ? void 0 : _d.flip) === null || _e === void 0 ? void 0 : _e.vertical) || false,\n            },\n        },\n        visibleArea: null,\n        coordinates: null,\n    };\n    if (settings.defaultTransforms) {\n        state.transforms = getDefaultTransforms(state, settings);\n    }\n    if (settings.priority === Priority.visibleArea) {\n        state = setVisibleArea(state, settings, getDefaultVisibleArea(state, settings), false);\n        state = setCoordinates(state, settings, getDefaultCoordinates(state, settings), SetCoordinatesMode.limit);\n    }\n    else {\n        state = setCoordinates(state, settings, getDefaultCoordinates(state, settings), SetCoordinatesMode.unsafe);\n        state = setVisibleArea(state, settings, getDefaultVisibleArea(state, settings), true);\n    }\n    return state;\n}\n\nexport { createState };\n","import 'tslib';\nimport { applyMove, moveToPositionRestrictions, mergePositionRestrictions, coordinatesToPositionRestrictions } from '../service/utils.js';\nimport { isInitializedState, getPositionRestrictions } from '../service/helpers.js';\nimport { copyState } from './copyState.js';\nimport '../types/index.js';\nimport './setCoordinates.js';\n\nfunction moveCoordinates(state, settings, directions) {\n    if (isInitializedState(state)) {\n        var result = copyState(state);\n        result.coordinates = applyMove(result.coordinates, directions);\n        result.coordinates = moveToPositionRestrictions(result.coordinates, mergePositionRestrictions(coordinatesToPositionRestrictions(result.visibleArea), getPositionRestrictions(result, settings)));\n        return result;\n    }\n    return state;\n}\n\nexport { moveCoordinates };\n","import { __assign } from 'tslib';\nimport { ALL_DIRECTIONS, HORIZONTAL_DIRECTIONS, VERTICAL_DIRECTIONS } from '../constants/index.js';\nimport { isGreater, isRoughlyEqual } from '../utils/index.js';\nimport { moveToPositionRestrictions, applyDirections, getIntersections, getOppositeSide, ratio, getBrokenRatio, applyMove, diff } from '../service/utils.js';\nimport '../types/index.js';\nimport '../state/setCoordinates.js';\nimport { moveCoordinatesAlgorithm } from './moveCoordinatesAlgorithm.js';\n\nfunction fitDirections(_a) {\n    var coordinates = _a.coordinates, directions = _a.directions, positionRestrictions = _a.positionRestrictions, sizeRestrictions = _a.sizeRestrictions, preserveRatio = _a.preserveRatio, allowedDirections = _a.allowedDirections, _b = _a.compensate, compensate = _b === void 0 ? true : _b;\n    var fittedDirections = __assign({}, directions);\n    var currentWidth = applyDirections(coordinates, fittedDirections).width;\n    var currentHeight = applyDirections(coordinates, fittedDirections).height;\n    // Prevent strange resizes when the width or height of stencil becomes smaller than 0\n    if (currentWidth < 0) {\n        if (fittedDirections.left < 0 && fittedDirections.right < 0) {\n            fittedDirections.left =\n                -(coordinates.width - sizeRestrictions.minWidth) / (fittedDirections.left / fittedDirections.right);\n            fittedDirections.right =\n                -(coordinates.width - sizeRestrictions.minWidth) / (fittedDirections.right / fittedDirections.left);\n        }\n        else if (fittedDirections.left < 0) {\n            fittedDirections.left = -(coordinates.width - sizeRestrictions.minWidth);\n        }\n        else if (fittedDirections.right < 0) {\n            fittedDirections.right = -(coordinates.width - sizeRestrictions.minWidth);\n        }\n    }\n    if (currentHeight < 0) {\n        if (fittedDirections.top < 0 && fittedDirections.bottom < 0) {\n            fittedDirections.top =\n                -(coordinates.height - sizeRestrictions.minHeight) / (fittedDirections.top / fittedDirections.bottom);\n            fittedDirections.bottom =\n                -(coordinates.height - sizeRestrictions.minHeight) / (fittedDirections.bottom / fittedDirections.top);\n        }\n        else if (fittedDirections.top < 0) {\n            fittedDirections.top = -(coordinates.height - sizeRestrictions.minHeight);\n        }\n        else if (fittedDirections.bottom < 0) {\n            fittedDirections.bottom = -(coordinates.height - sizeRestrictions.minHeight);\n        }\n    }\n    // Prevent breaking limits\n    var breaks = getIntersections(applyDirections(coordinates, fittedDirections), positionRestrictions);\n    var canBeCompensated = ALL_DIRECTIONS.every(function (direction) {\n        return !isGreater(breaks[getOppositeSide(direction)], 0) || allowedDirections[direction];\n    });\n    if (compensate && canBeCompensated) {\n        if (breaks.left && breaks.left > 0 && breaks.right === 0) {\n            fittedDirections.right += breaks.left;\n            fittedDirections.left -= breaks.left;\n        }\n        else if (breaks.right && breaks.right > 0 && breaks.left === 0) {\n            fittedDirections.left += breaks.right;\n            fittedDirections.right -= breaks.right;\n        }\n        if (breaks.top && breaks.top > 0 && breaks.bottom === 0) {\n            fittedDirections.bottom += breaks.top;\n            fittedDirections.top -= breaks.top;\n        }\n        else if (breaks.bottom && breaks.bottom > 0 && breaks.top === 0) {\n            fittedDirections.top += breaks.bottom;\n            fittedDirections.bottom -= breaks.bottom;\n        }\n        breaks = getIntersections(applyDirections(coordinates, fittedDirections), positionRestrictions);\n    }\n    var maxResize = {\n        width: Infinity,\n        height: Infinity,\n        left: Infinity,\n        right: Infinity,\n        top: Infinity,\n        bottom: Infinity,\n    };\n    ALL_DIRECTIONS.forEach(function (direction) {\n        var intersection = breaks[direction];\n        if (intersection && fittedDirections[direction]) {\n            maxResize[direction] = Math.max(0, 1 - intersection / fittedDirections[direction]);\n        }\n    });\n    if (preserveRatio) {\n        var multiplier_1 = Math.min.apply(Math, ALL_DIRECTIONS.map(function (direction) { return maxResize[direction]; }));\n        if (multiplier_1 !== Infinity) {\n            ALL_DIRECTIONS.forEach(function (direction) {\n                fittedDirections[direction] *= multiplier_1;\n            });\n        }\n    }\n    else {\n        ALL_DIRECTIONS.forEach(function (direction) {\n            if (maxResize[direction] !== Infinity) {\n                fittedDirections[direction] *= maxResize[direction];\n            }\n        });\n    }\n    currentWidth = applyDirections(coordinates, fittedDirections).width;\n    currentHeight = applyDirections(coordinates, fittedDirections).height;\n    if (fittedDirections.right + fittedDirections.left) {\n        if (currentWidth > sizeRestrictions.maxWidth) {\n            maxResize.width =\n                (sizeRestrictions.maxWidth - coordinates.width) / (fittedDirections.right + fittedDirections.left);\n        }\n        else if (currentWidth < sizeRestrictions.minWidth) {\n            maxResize.width =\n                (sizeRestrictions.minWidth - coordinates.width) / (fittedDirections.right + fittedDirections.left);\n        }\n    }\n    if (fittedDirections.bottom + fittedDirections.top) {\n        if (currentHeight > sizeRestrictions.maxHeight) {\n            maxResize.height =\n                (sizeRestrictions.maxHeight - coordinates.height) / (fittedDirections.bottom + fittedDirections.top);\n        }\n        else if (currentHeight < sizeRestrictions.minHeight) {\n            maxResize.height =\n                (sizeRestrictions.minHeight - coordinates.height) / (fittedDirections.bottom + fittedDirections.top);\n        }\n    }\n    if (preserveRatio) {\n        var multiplier_2 = Math.min(maxResize.width, maxResize.height);\n        if (multiplier_2 !== Infinity) {\n            ALL_DIRECTIONS.forEach(function (direction) {\n                fittedDirections[direction] *= multiplier_2;\n            });\n        }\n    }\n    else {\n        if (maxResize.width !== Infinity) {\n            HORIZONTAL_DIRECTIONS.forEach(function (direction) {\n                fittedDirections[direction] *= maxResize.width;\n            });\n        }\n        if (maxResize.height !== Infinity) {\n            VERTICAL_DIRECTIONS.forEach(function (direction) {\n                fittedDirections[direction] *= maxResize.height;\n            });\n        }\n    }\n    return fittedDirections;\n}\nfunction distributeOverlap(overlap, first, second) {\n    if (isRoughlyEqual(first + second, 0)) {\n        return overlap / 2;\n    }\n    else if (isRoughlyEqual(first, 0)) {\n        return 0;\n    }\n    else if (isRoughlyEqual(second, 0)) {\n        return overlap;\n    }\n    else {\n        return overlap * Math.abs(first / (first + second));\n    }\n}\nfunction resizeCoordinatesAlgorithm(coordinates, directions, options, limitations) {\n    var aspectRatio = limitations.aspectRatio, positionRestrictions = limitations.positionRestrictions, sizeRestrictions = limitations.sizeRestrictions;\n    var actualCoordinates = __assign({}, coordinates);\n    directions = __assign({}, directions);\n    var allowedDirections = options.allowedDirections || {\n        left: true,\n        right: true,\n        bottom: true,\n        top: true,\n    };\n    // It's possible that coordinates can be smaller than minimum width or minimum height. In this case\n    // corresponding resize should be blocked\n    if (coordinates.width < sizeRestrictions.minWidth) {\n        directions.left = 0;\n        directions.right = 0;\n    }\n    if (coordinates.height < sizeRestrictions.minHeight) {\n        directions.top = 0;\n        directions.bottom = 0;\n    }\n    ALL_DIRECTIONS.forEach(function (direction) {\n        if (!allowedDirections[direction]) {\n            directions[direction] = 0;\n        }\n    });\n    // 1. First step: determine the safe and desired area\n    directions = fitDirections({\n        coordinates: actualCoordinates,\n        directions: directions,\n        sizeRestrictions: sizeRestrictions,\n        positionRestrictions: positionRestrictions,\n        allowedDirections: allowedDirections,\n    });\n    // 2. Second step: fix desired box to correspondent to aspect ratio\n    var currentWidth = applyDirections(actualCoordinates, directions).width;\n    var currentHeight = applyDirections(actualCoordinates, directions).height;\n    // Checks ratio:\n    var ratioBroken = options.preserveAspectRatio\n        ? ratio(actualCoordinates)\n        : getBrokenRatio(currentWidth / currentHeight, aspectRatio);\n    if (ratioBroken) {\n        var respectDirection = options.respectDirection;\n        if (respectDirection !== 'width' && respectDirection !== 'height') {\n            if (actualCoordinates.width >= actualCoordinates.height || ratioBroken === 1) {\n                respectDirection = 'width';\n            }\n            else {\n                respectDirection = 'height';\n            }\n        }\n        if (respectDirection === 'width') {\n            var overlapHeight = currentWidth / ratioBroken - actualCoordinates.height;\n            if (allowedDirections.top && allowedDirections.bottom) {\n                var top_1 = directions.top, bottom = directions.bottom;\n                directions.bottom = distributeOverlap(overlapHeight, bottom, top_1);\n                directions.top = distributeOverlap(overlapHeight, top_1, bottom);\n            }\n            else if (allowedDirections.bottom) {\n                directions.bottom = overlapHeight;\n            }\n            else if (allowedDirections.top) {\n                directions.top = overlapHeight;\n            }\n            else if (allowedDirections.right) {\n                directions.right = 0;\n            }\n            else if (allowedDirections.left) {\n                directions.left = 0;\n            }\n        }\n        else if (respectDirection === 'height') {\n            var overlapWidth = actualCoordinates.width - currentHeight * ratioBroken;\n            if (allowedDirections.left && allowedDirections.right) {\n                var left = directions.left, right = directions.right;\n                directions.left = -distributeOverlap(overlapWidth, left, right);\n                directions.right = -distributeOverlap(overlapWidth, right, left);\n            }\n            else if (allowedDirections.left) {\n                directions.left = -overlapWidth;\n            }\n            else if (allowedDirections.right) {\n                directions.right = -overlapWidth;\n            }\n            else if (allowedDirections.top) {\n                directions.top = 0;\n            }\n            else if (allowedDirections.bottom) {\n                directions.bottom = 0;\n            }\n        }\n        // 3. Third step: check if desired box with correct aspect ratios break some limits and fit to this conditions\n        directions = fitDirections({\n            directions: directions,\n            coordinates: actualCoordinates,\n            sizeRestrictions: sizeRestrictions,\n            positionRestrictions: positionRestrictions,\n            preserveRatio: true,\n            compensate: options.compensate,\n            allowedDirections: allowedDirections,\n        });\n    }\n    // 4. Check if ratio broken (temporary):\n    currentWidth = applyDirections(actualCoordinates, directions).width;\n    currentHeight = applyDirections(actualCoordinates, directions).height;\n    ratioBroken = options.preserveAspectRatio\n        ? ratio(actualCoordinates)\n        : getBrokenRatio(currentWidth / currentHeight, aspectRatio);\n    if (ratioBroken && isGreater(Math.abs(ratioBroken - currentWidth / currentHeight), 0)) {\n        ALL_DIRECTIONS.forEach(function (direction) {\n            directions[direction] = 0;\n        });\n    }\n    return moveCoordinatesAlgorithm({\n        width: coordinates.width + directions.right + directions.left,\n        height: coordinates.height + directions.top + directions.bottom,\n        left: coordinates.left,\n        top: coordinates.top,\n    }, {\n        left: -directions.left,\n        top: -directions.top,\n    }, positionRestrictions);\n}\nfunction anchorToMassPoint(coordinates, anchor) {\n    var plainAnchor = anchor.toLowerCase();\n    return {\n        left: coordinates.left +\n            coordinates.width * (plainAnchor.indexOf('west') !== -1 ? 1 : plainAnchor.indexOf('east') !== -1 ? 0 : 0.5),\n        top: coordinates.top +\n            coordinates.height *\n                (plainAnchor.indexOf('north') !== -1 ? 1 : plainAnchor.indexOf('south') !== -1 ? 0 : 0.5),\n    };\n}\nfunction anchorToAllowedDirections(anchor) {\n    var plainAnchor = anchor.toLowerCase();\n    return {\n        left: plainAnchor.indexOf('east') === -1,\n        top: plainAnchor.indexOf('south') === -1,\n        right: plainAnchor.indexOf('west') === -1,\n        bottom: plainAnchor.indexOf('north') === -1,\n    };\n}\nfunction anchorMoveToResizeDirections(anchor, directions) {\n    var plainAnchor = anchor.toLowerCase();\n    var normalizedDirections = {\n        left: plainAnchor.indexOf('west') === -1 ? directions.left : -directions.left,\n        top:  -directions.top,\n        right: directions.left,\n        bottom: directions.top,\n    };\n    if (['north', 'south', 'center'].every(function (el) { return plainAnchor.indexOf(el) === -1; })) {\n        normalizedDirections.top = 0;\n        normalizedDirections.bottom = 0;\n    }\n    if (['west', 'east', 'center'].every(function (el) { return plainAnchor.indexOf(el) === -1; })) {\n        normalizedDirections.left = 0;\n        normalizedDirections.right = 0;\n    }\n    var allowedDirections = anchorToAllowedDirections(anchor);\n    ALL_DIRECTIONS.forEach(function (direction) {\n        if (!allowedDirections[direction]) {\n            normalizedDirections[direction] = 0;\n        }\n    });\n    return normalizedDirections;\n}\nfunction anchoredResizeCoordinatesAlgorithm(coordinates, anchor, directions, options, limitations) {\n    var reference = options.reference;\n    var resizeDirections = anchorMoveToResizeDirections(anchor, directions);\n    var allowedDirections = anchorToAllowedDirections(anchor);\n    var result = resizeCoordinatesAlgorithm(coordinates, resizeDirections, __assign(__assign({}, options), { allowedDirections: allowedDirections }), limitations);\n    if (reference) {\n        // Move the result to anchor\n        result = applyMove(result, diff(anchorToMassPoint(reference, anchor), anchorToMassPoint(result, anchor)));\n    }\n    return moveToPositionRestrictions(result, limitations.positionRestrictions);\n}\n\nexport { anchorMoveToResizeDirections, anchorToAllowedDirections, anchoredResizeCoordinatesAlgorithm, fitDirections, resizeCoordinatesAlgorithm };\n","import { __assign } from 'tslib';\nimport { mergePositionRestrictions, coordinatesToPositionRestrictions } from '../service/utils.js';\nimport { getMinimumSize, getSizeRestrictions, isInitializedState, getPositionRestrictions, getAspectRatio } from '../service/helpers.js';\nimport { copyState } from './copyState.js';\nimport '../types/index.js';\nimport './setCoordinates.js';\nimport { anchoredResizeCoordinatesAlgorithm } from '../algorithms/resizeCoordinatesAlgorithm.js';\n\nfunction resizeCoordinates(state, settings, anchor, directions, options) {\n    var minimumSize = getMinimumSize(state);\n    var sizeRestrictions = getSizeRestrictions(state, settings);\n    return isInitializedState(state)\n        ? __assign(__assign({}, copyState(state)), { coordinates: anchoredResizeCoordinatesAlgorithm(state.coordinates, anchor, directions, options, {\n                positionRestrictions: mergePositionRestrictions(getPositionRestrictions(state, settings), coordinatesToPositionRestrictions(state.visibleArea)),\n                sizeRestrictions: {\n                    maxWidth: Math.min(sizeRestrictions.maxWidth, state.visibleArea.width),\n                    maxHeight: Math.min(sizeRestrictions.maxHeight, state.visibleArea.height),\n                    minWidth: Math.max(Math.min(sizeRestrictions.minWidth, state.visibleArea.width), minimumSize),\n                    minHeight: Math.max(Math.min(sizeRestrictions.minHeight, state.visibleArea.height), minimumSize),\n                },\n                aspectRatio: getAspectRatio(state, settings),\n            }) }) : state;\n}\n\nexport { resizeCoordinates };\n","import { __assign } from 'tslib';\nimport { ratio, applyScale, resizeToSizeRestrictions, inverseMove, fitToPositionRestrictions, coordinatesToPositionRestrictions, applyMove, moveToPositionRestrictions } from '../service/utils.js';\nimport { getSizeRestrictions, getAreaSizeRestrictions, getAreaPositionRestrictions } from '../service/helpers.js';\nimport { copyState } from './copyState.js';\nimport '../types/index.js';\nimport './setCoordinates.js';\nimport { fitCoordinates } from '../service/fitCoordinates.js';\n\nfunction setBoundary(state, settings, boundary) {\n    var result = __assign(__assign({}, copyState(state)), { boundary: boundary });\n    if (result.visibleArea && result.coordinates && state.visibleArea) {\n        // Scale visible area size to fit new boundary:\n        result.visibleArea.height = result.visibleArea.width / ratio(boundary);\n        result.visibleArea.top += (state.visibleArea.height - result.visibleArea.height) / 2;\n        // Scale visible area to prevent overlap coordinates (and its minimum size)\n        var sizeRestrictions = getSizeRestrictions(result, settings);\n        if (Math.max(sizeRestrictions.minHeight, result.coordinates.height) - result.visibleArea.height > 0 ||\n            Math.max(sizeRestrictions.minWidth, result.coordinates.width) - result.visibleArea.width > 0) {\n            result.visibleArea = applyScale(result.visibleArea, Math.max(Math.max(sizeRestrictions.minHeight, result.coordinates.height) / result.visibleArea.height, Math.max(sizeRestrictions.minWidth, result.coordinates.width) / result.visibleArea.width));\n        }\n        // Scale visible area to prevent overlap area restrictions\n        result.visibleArea = resizeToSizeRestrictions(result.visibleArea, getAreaSizeRestrictions(result, settings));\n        // Move visible are to prevent moving of the coordinates:\n        var move = inverseMove(fitToPositionRestrictions(result.coordinates, coordinatesToPositionRestrictions(result.visibleArea)));\n        if (result.visibleArea.width < result.coordinates.width) {\n            move.left = 0;\n        }\n        if (result.visibleArea.height < result.coordinates.height) {\n            move.top = 0;\n        }\n        result.visibleArea = applyMove(result.visibleArea, move);\n        // Move visible area to prevent overlap the area restrictions\n        result.visibleArea = moveToPositionRestrictions(result.visibleArea, getAreaPositionRestrictions(result, settings));\n        result = fitCoordinates(result, settings);\n    }\n    return result;\n}\n\nexport { setBoundary };\n","import { __assign } from 'tslib';\nimport { isNumber } from '../utils/index.js';\nimport { rotatePoint, getCenter, diff, resizeToSizeRestrictions, moveToPositionRestrictions, applyMove } from '../service/utils.js';\nimport { mergeSizeRestrictions } from '../service/sizeRestrictions.js';\nimport { isInitializedState, getTransformedImageSize, getSizeRestrictions, getAspectRatio, getAreaSizeRestrictions, getPositionRestrictions, getAreaPositionRestrictions } from '../service/helpers.js';\nimport { copyState } from '../state/copyState.js';\nimport '../types/index.js';\nimport '../state/setCoordinates.js';\nimport { approximateSize } from '../service/approximateSize.js';\n\nfunction rotateImageAlgorithm(state, settings, rotate) {\n    if (isInitializedState(state)) {\n        var result = copyState(state);\n        var angle = isNumber(rotate) ? rotate : rotate.angle;\n        var imageCenter = rotatePoint(getCenter(__assign({ left: 0, top: 0 }, getTransformedImageSize(state))), angle);\n        result.transforms.rotate += angle;\n        result.coordinates = __assign(__assign({}, approximateSize({\n            sizeRestrictions: getSizeRestrictions(result, settings),\n            aspectRatio: getAspectRatio(result, settings),\n            width: result.coordinates.width,\n            height: result.coordinates.height,\n        })), rotatePoint(getCenter(result.coordinates), angle));\n        var center = !isNumber(rotate) && rotate.center ? rotate.center : getCenter(state.coordinates);\n        var shift = diff(getCenter(state.coordinates), rotatePoint(getCenter(state.coordinates), angle, center));\n        var imageSize = getTransformedImageSize(result);\n        result.coordinates.left -= imageCenter.left - imageSize.width / 2 + result.coordinates.width / 2 - shift.left;\n        result.coordinates.top -= imageCenter.top - imageSize.height / 2 + result.coordinates.height / 2 - shift.top;\n        // Check that visible area doesn't break the area restrictions:\n        result.visibleArea = resizeToSizeRestrictions(result.visibleArea, mergeSizeRestrictions(getAreaSizeRestrictions(result, settings), {\n            minWidth: result.coordinates.width,\n            minHeight: result.coordinates.height,\n        }));\n        result.coordinates = moveToPositionRestrictions(result.coordinates, getPositionRestrictions(result, settings));\n        result.visibleArea = applyMove(result.visibleArea, diff(getCenter(result.coordinates), getCenter(state.coordinates)));\n        result.visibleArea = moveToPositionRestrictions(result.visibleArea, getAreaPositionRestrictions(result, settings));\n        return result;\n    }\n    return state;\n}\n\nexport { rotateImageAlgorithm };\n","import 'tslib';\nimport { rotatePoint, getCenter, applyMove, diff, moveToPositionRestrictions } from '../service/utils.js';\nimport { isInitializedState, getTransformedImageSize, getAreaPositionRestrictions } from '../service/helpers.js';\nimport { copyState } from '../state/copyState.js';\nimport '../types/index.js';\nimport '../state/setCoordinates.js';\n\nfunction flipImageAlgorithm(state, settings, horizontal, vertical) {\n    if (isInitializedState(state)) {\n        var result = copyState(state);\n        var rotate = state.transforms.rotate;\n        var imageSize = getTransformedImageSize(state);\n        var changed = {\n            horizontal: horizontal,\n            vertical: vertical,\n        };\n        if (changed.horizontal || changed.vertical) {\n            var imageCenter = rotatePoint({\n                left: imageSize.width / 2,\n                top: imageSize.height / 2,\n            }, -rotate);\n            var oldCenter = rotatePoint(getCenter(result.coordinates), -rotate);\n            var newCenter = rotatePoint({\n                left: changed.horizontal ? imageCenter.left - (oldCenter.left - imageCenter.left) : oldCenter.left,\n                top: changed.vertical ? imageCenter.top - (oldCenter.top - imageCenter.top) : oldCenter.top,\n            }, rotate);\n            result.coordinates = applyMove(result.coordinates, diff(newCenter, getCenter(result.coordinates)));\n            oldCenter = rotatePoint(getCenter(result.visibleArea), -rotate);\n            newCenter = rotatePoint({\n                left: changed.horizontal ? imageCenter.left - (oldCenter.left - imageCenter.left) : oldCenter.left,\n                top: changed.vertical ? imageCenter.top - (oldCenter.top - imageCenter.top) : oldCenter.top,\n            }, rotate);\n            result.visibleArea = applyMove(result.visibleArea, diff(newCenter, getCenter(result.visibleArea)));\n            result.visibleArea = moveToPositionRestrictions(result.visibleArea, getAreaPositionRestrictions(result, settings));\n        }\n        if (changed.horizontal) {\n            result.transforms.flip.horizontal = !state.transforms.flip.horizontal;\n        }\n        if (changed.vertical) {\n            result.transforms.flip.vertical = !state.transforms.flip.vertical;\n        }\n        return result;\n    }\n    return state;\n}\n\nexport { flipImageAlgorithm };\n","import 'tslib';\nimport { isNumber, isRoughlyEqual } from '../utils/index.js';\nimport { applyMove, maxScale, positionToSizeRestrictions, minScale, applyScale, moveToPositionRestrictions, mergePositionRestrictions, coordinatesToPositionRestrictions, getCenter, inverseMove, fitToPositionRestrictions } from '../service/utils.js';\nimport { isInitializedState, getSizeRestrictions, getPositionRestrictions, getAreaSizeRestrictions, getAreaPositionRestrictions } from '../service/helpers.js';\nimport { copyState } from '../state/copyState.js';\nimport '../types/index.js';\nimport '../state/setCoordinates.js';\n\nfunction transformImageAlgorithm(state, settings, transform) {\n    var _a;\n    var _b = transform.scale, scale = _b === void 0 ? 1 : _b, _c = transform.move, move = _c === void 0 ? {} : _c;\n    if (isInitializedState(state)) {\n        var result = copyState(state);\n        // It's reversed because zooming in the image is actually zooming out visible area\n        var scaleFactor = 1 / (isNumber(scale) ? scale : scale.factor);\n        var scaleCenter = !isNumber(scale) ? scale.center : undefined;\n        var isAllowedScale = !isRoughlyEqual(scaleFactor, 1);\n        var areaScale = 1;\n        var stencilScale = 1;\n        result.visibleArea = applyMove(result.visibleArea, {\n            left: move.left || 0,\n            top: move.top || 0,\n        });\n        var sizeRestrictions = getSizeRestrictions(result, settings);\n        var positionRestrictions = getPositionRestrictions(result, settings);\n        var areaSizeRestrictions = getAreaSizeRestrictions(result, settings);\n        var scaleRestrictions = {\n            stencil: {\n                minimum: Math.max(sizeRestrictions.minWidth ? sizeRestrictions.minWidth / result.coordinates.width : 0, sizeRestrictions.minHeight ? sizeRestrictions.minHeight / result.coordinates.height : 0),\n                maximum: Math.min(sizeRestrictions.maxWidth ? sizeRestrictions.maxWidth / result.coordinates.width : Infinity, sizeRestrictions.maxHeight ? sizeRestrictions.maxHeight / result.coordinates.height : Infinity, maxScale(result.coordinates, positionToSizeRestrictions(positionRestrictions))),\n            },\n            area: {\n                maximum: maxScale(result.visibleArea, areaSizeRestrictions),\n                minimum: minScale(result.visibleArea, areaSizeRestrictions),\n            },\n        };\n        // If there is scaling then begin scale\n        if (scaleFactor && isAllowedScale) {\n            // Determine scale factor\n            if (scaleFactor < 1) {\n                stencilScale = Math.max(scaleFactor, Math.max(scaleRestrictions.area.minimum, scaleRestrictions.stencil.minimum));\n                if (stencilScale > 1) {\n                    stencilScale = 1;\n                }\n            }\n            else if (scaleFactor > 1) {\n                stencilScale = Math.min(scaleFactor, Math.min(scaleRestrictions.area.maximum, scaleRestrictions.stencil.maximum));\n                if (stencilScale < 1) {\n                    stencilScale = 1;\n                }\n            }\n        }\n        if (stencilScale) {\n            // Resize stencil with area as much as possible\n            result.visibleArea = applyScale(result.visibleArea, stencilScale, scaleCenter);\n        }\n        var relativeCoordinates = {\n            left: state.coordinates.left - state.visibleArea.left,\n            right: state.visibleArea.width + state.visibleArea.left - (state.coordinates.width + state.coordinates.left),\n            top: state.coordinates.top - state.visibleArea.top,\n            bottom: state.visibleArea.height + state.visibleArea.top - (state.coordinates.height + state.coordinates.top),\n        };\n        // Move the area to fit to the coordinates limits:\n        result.visibleArea = moveToPositionRestrictions(result.visibleArea, {\n            left: positionRestrictions.left !== undefined\n                ? positionRestrictions.left - relativeCoordinates.left * stencilScale\n                : undefined,\n            top: positionRestrictions.top !== undefined\n                ? positionRestrictions.top - relativeCoordinates.top * stencilScale\n                : undefined,\n            bottom: positionRestrictions.bottom !== undefined\n                ? positionRestrictions.bottom + relativeCoordinates.bottom * stencilScale\n                : undefined,\n            right: positionRestrictions.right !== undefined\n                ? positionRestrictions.right + relativeCoordinates.right * stencilScale\n                : undefined,\n        });\n        // But the more important to fit are to the area restrictions, so we should fit it to that restrictions:\n        result.visibleArea = moveToPositionRestrictions(result.visibleArea, getAreaPositionRestrictions(result, settings));\n        // Set the same coordinates of stencil inside visible area\n        result.coordinates.width = result.coordinates.width * stencilScale;\n        result.coordinates.height = result.coordinates.height * stencilScale;\n        result.coordinates.left = result.visibleArea.left + relativeCoordinates.left * stencilScale;\n        result.coordinates.top = result.visibleArea.top + relativeCoordinates.top * stencilScale;\n        // Move the coordinates to prevent the intersection with visible area and position restrictions\n        result.coordinates = moveToPositionRestrictions(result.coordinates, mergePositionRestrictions(coordinatesToPositionRestrictions(result.visibleArea), positionRestrictions));\n        // Resize only area if stencil can't be resized and stencil resize is disabled\n        if (isAllowedScale && scaleFactor && ((_a = settings.transformImage) === null || _a === void 0 ? void 0 : _a.adjustStencil)) {\n            if (scaleFactor > 1) {\n                areaScale = Math.min(scaleRestrictions.area.maximum, scaleFactor) / stencilScale;\n            }\n            else if (scaleFactor < 1) {\n                areaScale = Math.max(result.coordinates.height / result.visibleArea.height, result.coordinates.width / result.visibleArea.width, scaleFactor / stencilScale);\n            }\n            if (areaScale !== 1) {\n                result.visibleArea = applyScale(result.visibleArea, areaScale, scaleFactor > 1 ? scaleCenter : getCenter(result.coordinates));\n                // Move to prevent the breaking of the area restrictions:\n                result.visibleArea = moveToPositionRestrictions(result.visibleArea, getAreaPositionRestrictions(result, settings));\n                // Move to prevent the intersection with coordinates:\n                result.visibleArea = applyMove(result.visibleArea, inverseMove(fitToPositionRestrictions(result.coordinates, coordinatesToPositionRestrictions(result.visibleArea))));\n            }\n        }\n        return result;\n    }\n    return state;\n}\n\nexport { transformImageAlgorithm };\n","import 'tslib';\nimport '../types/index.js';\nimport './setCoordinates.js';\nimport { rotateImageAlgorithm } from '../algorithms/rotateImageAlgorithm.js';\nimport { flipImageAlgorithm } from '../algorithms/flipImageAlgorithm.js';\nimport { transformImageAlgorithm } from '../algorithms/transformImageAlgorithm.js';\n\nfunction transformImage(state, settings, transform) {\n    if (transform.rotate) {\n        state = rotateImageAlgorithm(state, settings, transform.rotate);\n    }\n    if (transform.flip) {\n        state = flipImageAlgorithm(state, settings, transform.flip.horizontal, transform.flip.vertical);\n    }\n    if (transform.move || transform.scale) {\n        state = transformImageAlgorithm(state, settings, transform);\n    }\n    return state;\n}\n\nexport { transformImage };\n","import { __assign } from 'tslib';\nimport { getBrokenRatio, ratio, applyMove, diff, getCenter, moveToPositionRestrictions, mergePositionRestrictions, coordinatesToPositionRestrictions } from '../service/utils.js';\nimport { mergeSizeRestrictions } from '../service/sizeRestrictions.js';\nimport { isInitializedState, getAspectRatio, getSizeRestrictions, getAreaSizeRestrictions, getAreaPositionRestrictions, getPositionRestrictions } from '../service/helpers.js';\nimport { copyState } from './copyState.js';\nimport '../types/index.js';\nimport './setCoordinates.js';\nimport { approximateSize } from '../service/approximateSize.js';\n\nfunction reconcileState(state, settings) {\n    if (isInitializedState(state)) {\n        var result = copyState(state);\n        var aspectRatio = getAspectRatio(state, settings);\n        var sizeRestrictions = getSizeRestrictions(state, settings);\n        var areaSizeRestrictions = getAreaSizeRestrictions(state, settings);\n        // Fit the size of coordinates to existing size restrictions and visible area\n        var brokenRatio = getBrokenRatio(ratio(state.coordinates), aspectRatio);\n        var desiredSize = brokenRatio\n            ? {\n                height: state.coordinates.height,\n                width: state.coordinates.height * brokenRatio,\n            }\n            : state.coordinates;\n        result.coordinates = __assign(__assign({}, result.coordinates), approximateSize({\n            width: desiredSize.width,\n            height: desiredSize.height,\n            aspectRatio: aspectRatio,\n            sizeRestrictions: mergeSizeRestrictions(areaSizeRestrictions, sizeRestrictions),\n        }));\n        // Return the coordinates to the previous center\n        result.coordinates = applyMove(result.coordinates, diff(getCenter(state.coordinates), getCenter(result.coordinates)));\n        var scaleModifier = Math.max(result.coordinates.width / result.visibleArea.width, result.coordinates.height / result.visibleArea.height, 1);\n        // Fit the visible area to its size restrictions and boundary aspect ratio:\n        result.visibleArea = __assign(__assign({}, state.visibleArea), approximateSize({\n            width: state.visibleArea.width * scaleModifier,\n            height: state.visibleArea.height * scaleModifier,\n            aspectRatio: {\n                minimum: ratio(result.boundary),\n                maximum: ratio(result.boundary),\n            },\n            sizeRestrictions: areaSizeRestrictions,\n        }));\n        // Return the visible area to previous center\n        result.visibleArea = applyMove(result.visibleArea, diff(getCenter(state.visibleArea), getCenter(result.visibleArea)));\n        // Fit the visible area to positions restrictions\n        result.visibleArea = moveToPositionRestrictions(result.visibleArea, getAreaPositionRestrictions(result, settings));\n        // Fit the coordinates to position restrictions and visible area\n        result.coordinates = moveToPositionRestrictions(result.coordinates, mergePositionRestrictions(coordinatesToPositionRestrictions(result.visibleArea), getPositionRestrictions(result, settings)));\n        return result;\n    }\n    return state;\n}\n\nexport { reconcileState };\n","import { isNumber } from '../utils/index.js';\nimport { getCoefficient } from './helpers.js';\n\nfunction normalizeResizeDirections(state, directions) {\n    var coefficient = getCoefficient(state);\n    return {\n        left: isNumber(directions.left) ? directions.left * coefficient : 0,\n        top: isNumber(directions.top) ? directions.top * coefficient : 0,\n        right: isNumber(directions.right) ? directions.right * coefficient : 0,\n        bottom: isNumber(directions.bottom) ? directions.bottom * coefficient : 0,\n    };\n}\nfunction normalizeCenter(state, center) {\n    var coefficient = getCoefficient(state);\n    if (state.visibleArea) {\n        return {\n            left: center.left * coefficient + state.visibleArea.left,\n            top: center.top * coefficient + state.visibleArea.top,\n        };\n    }\n    return center;\n}\nfunction normalizeFlip(state, flip) {\n    if (state) {\n        var normalizedAngle = Math.abs(state.transforms.rotate % 180);\n        if (normalizedAngle <= 45 || normalizedAngle >= 135) {\n            return flip;\n        }\n        else {\n            return {\n                horizontal: flip.vertical,\n                vertical: flip.horizontal,\n            };\n        }\n    }\n    return flip;\n}\nfunction fillMoveDirections(directions) {\n    return {\n        left: isNumber(directions.left) ? directions.left : 0,\n        top: isNumber(directions.top) ? directions.top : 0,\n    };\n}\nfunction fillResizeDirections(directions) {\n    return {\n        left: isNumber(directions.left) ? directions.left : 0,\n        top: isNumber(directions.top) ? directions.top : 0,\n        right: isNumber(directions.right) ? directions.right : 0,\n        bottom: isNumber(directions.bottom) ? directions.bottom : 0,\n    };\n}\nfunction normalizeMoveDirections(state, directions) {\n    var coefficient = getCoefficient(state);\n    return {\n        left: isNumber(directions.left) ? directions.left * coefficient : 0,\n        top: isNumber(directions.top) ? directions.top * coefficient : 0,\n    };\n}\nfunction normalizeImageTransform(state, transform) {\n    if (transform.scale) {\n        transform.scale = {\n            factor: isNumber(transform.scale) ? transform.scale : transform.scale.factor,\n            center: !isNumber(transform.scale) && transform.scale.center\n                ? normalizeCenter(state, transform.scale.center)\n                : undefined,\n        };\n    }\n    if (transform.rotate) {\n        transform.rotate = {\n            angle: isNumber(transform.rotate) ? transform.rotate : transform.rotate.angle,\n            center: !isNumber(transform.rotate) && transform.rotate.center\n                ? normalizeCenter(state, transform.rotate.center)\n                : undefined,\n        };\n    }\n    if (transform.move) {\n        transform.move = normalizeMoveDirections(state, transform.move);\n    }\n    return transform;\n}\n\nexport { fillMoveDirections, fillResizeDirections, normalizeCenter, normalizeFlip, normalizeImageTransform, normalizeMoveDirections, normalizeResizeDirections };\n","import { isRoughlyEqual, sign, distance } from '../utils/index.js';\n\nfunction calculateGeometricProperties(touches, container) {\n    var _a = container.getBoundingClientRect(), left = _a.left, top = _a.top;\n    var centerMass = { left: 0, top: 0 };\n    var spread = 0;\n    touches.forEach(function (touch) {\n        centerMass.left += (touch.clientX - left) / touches.length;\n        centerMass.top += (touch.clientY - top) / touches.length;\n    });\n    touches.forEach(function (touch) {\n        spread += distance({ left: centerMass.left, top: centerMass.top }, { left: touch.clientX - left, top: touch.clientY - top });\n    });\n    return { centerMass: centerMass, spread: spread, count: touches.length };\n}\nfunction touchesToImageTransform(touches, previousTouches, container, options) {\n    if (options === void 0) { options = {}; }\n    var move, scale, rotate;\n    if (previousTouches.length === 1 && touches.length === 1) {\n        if (options.move) {\n            move = {\n                left: previousTouches[0].clientX - touches[0].clientX,\n                top: previousTouches[0].clientY - touches[0].clientY,\n            };\n        }\n    }\n    else if (touches.length > 1) {\n        var previousProperties = calculateGeometricProperties(previousTouches, container);\n        var properties = calculateGeometricProperties(touches, container);\n        if (options.rotate && previousTouches.length === 2 && touches.length === 2) {\n            var diffs = {\n                left: [\n                    touches[0].clientX - touches[1].clientX,\n                    previousTouches[0].clientX - previousTouches[1].clientX,\n                ],\n                top: [touches[0].clientY - touches[1].clientY, previousTouches[0].clientY - previousTouches[1].clientY],\n            };\n            var y = diffs.left[0] * diffs.top[1] - diffs.left[1] * diffs.top[0];\n            var x = diffs.left[0] * diffs.left[1] + diffs.top[0] * diffs.top[1];\n            if (!isRoughlyEqual(x, 0) && !isRoughlyEqual(y, 0)) {\n                var radians = Math.atan2(y, x);\n                var angle = -(radians * 180) / Math.PI;\n                rotate = {\n                    center: properties.centerMass,\n                    angle: angle,\n                };\n            }\n        }\n        if (options.move) {\n            move = {\n                left: previousProperties.centerMass.left - properties.centerMass.left,\n                top: previousProperties.centerMass.top - properties.centerMass.top,\n            };\n        }\n        if (options.scale) {\n            scale = {\n                factor: properties.spread / previousProperties.spread,\n                center: properties.centerMass,\n            };\n        }\n    }\n    return {\n        move: move,\n        scale: scale,\n        rotate: rotate,\n    };\n}\nfunction wheelEventToImageTransform(event, container, ratio) {\n    if (ratio === void 0) { ratio = 0.1; }\n    var _a = container.getBoundingClientRect(), left = _a.left, top = _a.top;\n    var factor = 1 - ratio * sign((event.deltaY || event.detail || event.wheelDelta));\n    var center = {\n        left: event.clientX - left,\n        top: event.clientY - top,\n    };\n    return { scale: { factor: factor, center: center } };\n}\n\nexport { touchesToImageTransform, wheelEventToImageTransform };\n","function hasInteractions(interactions) {\n    return (interactions.moveCoordinates ||\n        interactions.resizeCoordinates ||\n        interactions.transformImage.move ||\n        interactions.transformImage.rotate ||\n        interactions.transformImage.flip ||\n        interactions.transformImage.scale);\n}\nfunction getEmptyInteractions() {\n    return {\n        moveCoordinates: false,\n        resizeCoordinates: false,\n        transformImage: {\n            rotate: false,\n            move: false,\n            scale: false,\n            flip: false,\n        },\n    };\n}\n\nexport { getEmptyInteractions, hasInteractions };\n","import 'tslib';\nimport { getTransformedImageSize } from '../service/helpers.js';\nimport '../types/index.js';\nimport '../state/setCoordinates.js';\n\nfunction defaultPositionRestrictions(state, settings) {\n    var imageSize = getTransformedImageSize(state);\n    var limits = {};\n    if (settings.imageRestriction && settings.imageRestriction !== 'none') {\n        limits = {\n            left: 0,\n            top: 0,\n            right: imageSize.width,\n            bottom: imageSize.height,\n        };\n    }\n    return limits;\n}\n\nexport { defaultPositionRestrictions };\n","import { __assign } from 'tslib';\nimport { ratio, resizeToSizeRestrictions, getIntersections, coordinatesToPositionRestrictions, moveToPositionRestrictions } from '../service/utils.js';\nimport { getTransformedImageSize, getAreaSizeRestrictions } from '../service/helpers.js';\nimport '../types/index.js';\nimport '../state/setCoordinates.js';\n\nfunction defaultVisibleArea(state, settings) {\n    var coordinates = state.coordinates, boundary = state.boundary;\n    var imageSize = getTransformedImageSize(state);\n    var boundaryRatio = ratio(boundary);\n    if (coordinates) {\n        // Visible area will try to fit reference:\n        var reference = {\n            height: Math.max(coordinates.height, imageSize.height),\n            width: Math.max(coordinates.width, imageSize.width),\n        };\n        var visibleArea = {\n            left: 0,\n            top: 0,\n            width: ratio(reference) > boundaryRatio ? reference.width : reference.height * boundaryRatio,\n            height: ratio(reference) > boundaryRatio ? reference.width / boundaryRatio : reference.height,\n        };\n        // Visible area should correspond its restrictions:\n        visibleArea = resizeToSizeRestrictions(visibleArea, getAreaSizeRestrictions(state, settings));\n        // Visible area will try to center stencil:\n        visibleArea.left = coordinates.left + coordinates.width / 2 - visibleArea.width / 2;\n        visibleArea.top = coordinates.top + coordinates.height / 2 - visibleArea.height / 2;\n        // TODO: Controversial behavior:\n        // If the coordinates are beyond image visible area will be allowed to be beyond image alike:\n        var coordinatesIntersection = getIntersections(coordinates, coordinatesToPositionRestrictions(__assign({ left: 0, top: 0 }, imageSize)));\n        var restrictions = {};\n        if (!coordinatesIntersection.left && !coordinatesIntersection.right && visibleArea.width <= imageSize.width) {\n            restrictions.left = 0;\n            restrictions.right = imageSize.width;\n        }\n        if (!coordinatesIntersection.top && !coordinatesIntersection.bottom && visibleArea.height <= imageSize.height) {\n            restrictions.top = 0;\n            restrictions.bottom = imageSize.height;\n        }\n        return moveToPositionRestrictions(visibleArea, restrictions);\n    }\n    else {\n        var imageRatio = ratio(imageSize);\n        var areaProperties = {\n            height: imageRatio < boundaryRatio ? imageSize.height : imageSize.width / boundaryRatio,\n            width: imageRatio < boundaryRatio ? imageSize.height * boundaryRatio : imageSize.width,\n        };\n        return {\n            left: imageSize.width / 2 - areaProperties.width / 2,\n            top: imageSize.height / 2 - areaProperties.height / 2,\n            width: areaProperties.width,\n            height: areaProperties.height,\n        };\n    }\n}\n\nexport { defaultVisibleArea };\n","import { __assign } from 'tslib';\nimport { positionToSizeRestrictions, ratio } from '../service/utils.js';\nimport { getSizeRestrictions, getAspectRatio, getPositionRestrictions } from '../service/helpers.js';\nimport '../types/index.js';\nimport '../state/setCoordinates.js';\nimport { approximateSize } from '../service/approximateSize.js';\n\nfunction defaultSize(state, settings) {\n    var imageSize = state.imageSize, visibleArea = state.visibleArea;\n    var sizeRestrictions = getSizeRestrictions(state, settings);\n    var aspectRatio = getAspectRatio(state, settings);\n    var area;\n    if (visibleArea) {\n        area = visibleArea;\n    }\n    else {\n        var sizeRestrictions_1 = positionToSizeRestrictions(getPositionRestrictions(state, settings));\n        area = {\n            width: Math.max(sizeRestrictions_1.minWidth, Math.min(sizeRestrictions_1.maxWidth, imageSize.width)),\n            height: Math.max(sizeRestrictions_1.minHeight, Math.min(sizeRestrictions_1.maxHeight, imageSize.height)),\n        };\n    }\n    var optimalRatio = Math.min(aspectRatio.maximum || Infinity, Math.max(aspectRatio.minimum || 0, ratio(area)));\n    var size = area.width < area.height\n        ? {\n            width: area.width * 0.8,\n            height: (area.width * 0.8) / optimalRatio,\n        }\n        : {\n            height: area.height * 0.8,\n            width: area.height * 0.8 * optimalRatio,\n        };\n    return approximateSize(__assign(__assign({}, size), { aspectRatio: aspectRatio, sizeRestrictions: sizeRestrictions }));\n}\n\nexport { defaultSize };\n","import { isNumeric, parseNumber } from '../utils/index.js';\n\nfunction retrieveSizeRestrictions(settings) {\n    return {\n        minWidth: isNumeric(settings.minWidth) ? parseNumber(settings.minWidth) : 0,\n        minHeight: isNumeric(settings.minHeight) ? parseNumber(settings.minHeight) : 0,\n        maxWidth: isNumeric(settings.maxWidth) ? parseNumber(settings.maxWidth) : Infinity,\n        maxHeight: isNumeric(settings.maxHeight) ? parseNumber(settings.maxHeight) : Infinity,\n    };\n}\nfunction pixelsRestrictions(state, settings) {\n    return retrieveSizeRestrictions(settings);\n}\n\nexport { pixelsRestrictions, retrieveSizeRestrictions };\n","import 'tslib';\nimport { getTransformedImageSize } from '../service/helpers.js';\nimport '../types/index.js';\nimport '../state/setCoordinates.js';\n\nfunction defaultPosition(state) {\n    var visibleArea = state.visibleArea, coordinates = state.coordinates;\n    var area = visibleArea || getTransformedImageSize(state);\n    return {\n        left: (visibleArea ? visibleArea.left : 0) + area.width / 2 - (coordinates ? coordinates.width / 2 : 0),\n        top: (visibleArea ? visibleArea.top : 0) + area.height / 2 - (coordinates ? coordinates.height / 2 : 0),\n    };\n}\n\nexport { defaultPosition };\n","import 'tslib';\nimport { ratio } from '../service/utils.js';\nimport { getTransformedImageSize } from '../service/helpers.js';\nimport { ImageRestriction } from '../types/index.js';\nimport '../state/setCoordinates.js';\n\nfunction defaultAreaPositionRestrictions(state, settings) {\n    var visibleArea = state.visibleArea, boundary = state.boundary;\n    var imageRestriction = settings.imageRestriction;\n    var imageSize = getTransformedImageSize(state);\n    var restrictions = {};\n    if (imageRestriction === ImageRestriction.fillArea) {\n        restrictions = {\n            left: 0,\n            top: 0,\n            right: imageSize.width,\n            bottom: imageSize.height,\n        };\n    }\n    else if (imageRestriction === ImageRestriction.fitArea) {\n        if (ratio(boundary) > ratio(imageSize)) {\n            restrictions = {\n                top: 0,\n                bottom: imageSize.height,\n            };\n            if (visibleArea) {\n                if (visibleArea.width > imageSize.width) {\n                    restrictions.left = -(visibleArea.width - imageSize.width) / 2;\n                    restrictions.right = imageSize.width - restrictions.left;\n                }\n                else {\n                    restrictions.left = 0;\n                    restrictions.right = imageSize.width;\n                }\n            }\n        }\n        else {\n            restrictions = {\n                left: 0,\n                right: imageSize.width,\n            };\n            if (visibleArea) {\n                if (visibleArea.height > imageSize.height) {\n                    restrictions.top = -(visibleArea.height - imageSize.height) / 2;\n                    restrictions.bottom = imageSize.height - restrictions.top;\n                }\n                else {\n                    restrictions.top = 0;\n                    restrictions.bottom = imageSize.height;\n                }\n            }\n        }\n    }\n    return restrictions;\n}\n\nexport { defaultAreaPositionRestrictions };\n","import 'tslib';\nimport { ratio } from '../service/utils.js';\nimport { getTransformedImageSize } from '../service/helpers.js';\nimport { ImageRestriction } from '../types/index.js';\nimport '../state/setCoordinates.js';\n\nfunction defaultAreaSizeRestrictions(state, settings) {\n    var boundary = state.boundary;\n    var imageRestriction = settings.imageRestriction;\n    var imageSize = getTransformedImageSize(state);\n    var restrictions = {\n        minWidth: 0,\n        minHeight: 0,\n        maxWidth: Infinity,\n        maxHeight: Infinity,\n    };\n    if (imageRestriction === ImageRestriction.fillArea) {\n        restrictions.maxWidth = imageSize.width;\n        restrictions.maxHeight = imageSize.height;\n    }\n    else if (imageRestriction === ImageRestriction.fitArea) {\n        if (ratio(boundary) > ratio(imageSize)) {\n            restrictions.maxHeight = imageSize.height;\n            restrictions.maxWidth = imageSize.height * ratio(boundary);\n        }\n        else {\n            restrictions.maxWidth = imageSize.width;\n            restrictions.maxHeight = imageSize.width / ratio(boundary);\n        }\n    }\n    return restrictions;\n}\n\nexport { defaultAreaSizeRestrictions };\n","function fitBoundary(boundary, size) {\n    var areaHeight = boundary.clientHeight;\n    var areaWidth = boundary.clientWidth;\n    var currentHeight = areaHeight;\n    var currentWidth = (size.width * areaHeight) / size.height;\n    if (currentWidth > areaWidth) {\n        currentWidth = areaWidth;\n        currentHeight = (size.height * areaWidth) / size.width;\n    }\n    return {\n        width: currentWidth,\n        height: currentHeight,\n    };\n}\nfunction fillBoundary(boundary) {\n    var _a = boundary.getBoundingClientRect(), width = _a.width, height = _a.height;\n    return {\n        width: width,\n        height: height,\n    };\n}\n\nexport { fillBoundary, fitBoundary };\n","import 'tslib';\nimport { isFunction } from '../utils/index.js';\nimport { createAspectRatio } from '../service/utils.js';\nimport '../types/index.js';\nimport '../state/setCoordinates.js';\n\nfunction defaultStencilConstraints(rawSettings, stencilProps) {\n    if (!rawSettings.aspectRatio) {\n        return {\n            aspectRatio: createAspectRatio(isFunction(stencilProps.aspectRatio) ? stencilProps.aspectRatio() : stencilProps.aspectRatio),\n        };\n    }\n    return {};\n}\n\nexport { defaultStencilConstraints };\n","import { __assign } from 'tslib';\nimport { isFunction } from '../utils/index.js';\nimport { mergePositionRestrictions, createAspectRatio } from '../service/utils.js';\nimport { mergeSizeRestrictions } from '../service/sizeRestrictions.js';\nimport '../types/index.js';\nimport '../state/setCoordinates.js';\nimport { defaultPositionRestrictions } from './defaultPositionRestrictions.js';\nexport { defaultPositionRestrictions } from './defaultPositionRestrictions.js';\nimport { defaultVisibleArea } from './defaultVisibleArea.js';\nexport { defaultVisibleArea } from './defaultVisibleArea.js';\nimport { defaultSize } from './defaultSize.js';\nexport { defaultSize } from './defaultSize.js';\nimport { pixelsRestrictions } from './defaultSizeRestrictions.js';\nexport { pixelsRestrictions, retrieveSizeRestrictions } from './defaultSizeRestrictions.js';\nimport { defaultPosition } from './defaultPosition.js';\nexport { defaultPosition } from './defaultPosition.js';\nimport { defaultAreaPositionRestrictions } from './defaultAreaPositionRestrictions.js';\nexport { defaultAreaPositionRestrictions } from './defaultAreaPositionRestrictions.js';\nimport { defaultAreaSizeRestrictions } from './defaultAreaSizeRestrictions.js';\nexport { defaultAreaSizeRestrictions } from './defaultAreaSizeRestrictions.js';\nexport { fillBoundary, fitBoundary } from './defaultBoundary.js';\nexport { defaultStencilConstraints } from './defaultStencilConstraints.js';\n\nfunction withDefaultSizeRestrictions(sizeRestrictions) {\n    return function (state, basicSettings) {\n        var value = isFunction(sizeRestrictions) ? sizeRestrictions(state, basicSettings) : sizeRestrictions;\n        return mergeSizeRestrictions(pixelsRestrictions(state, basicSettings), value);\n    };\n}\nfunction withDefaultPositionRestrictions(positionRestrictions) {\n    return function (state, basicSettings) {\n        var value = isFunction(positionRestrictions)\n            ? positionRestrictions(state, basicSettings)\n            : positionRestrictions;\n        return mergePositionRestrictions(defaultPositionRestrictions(state, basicSettings), value);\n    };\n}\nfunction withDefaultAreaPositionRestrictions(areaPositionRestrictions) {\n    return function (state, basicSettings) {\n        var value = isFunction(areaPositionRestrictions)\n            ? areaPositionRestrictions(state, basicSettings)\n            : areaPositionRestrictions;\n        return mergePositionRestrictions(defaultAreaPositionRestrictions(state, basicSettings), value);\n    };\n}\nfunction withDefaultAreaSizeRestrictions(areaSizeRestrictions) {\n    return function (state, basicSettings) {\n        var value = isFunction(areaSizeRestrictions)\n            ? areaSizeRestrictions(state, basicSettings)\n            : areaSizeRestrictions;\n        return mergeSizeRestrictions(defaultAreaSizeRestrictions(state, basicSettings), value);\n    };\n}\nfunction createDefaultSettings(params) {\n    return __assign(__assign({}, params), { sizeRestrictions: function (state, basicSettings) {\n            var restrictions;\n            if (params.sizeRestrictions) {\n                restrictions = isFunction(params.sizeRestrictions)\n                    ? params.sizeRestrictions(state, basicSettings)\n                    : params.sizeRestrictions;\n            }\n            else {\n                restrictions = pixelsRestrictions(state, basicSettings);\n            }\n            return restrictions;\n        }, areaPositionRestrictions: function (state, basicSettings) {\n            if (params.areaPositionRestrictions) {\n                return isFunction(params.areaPositionRestrictions)\n                    ? params.areaPositionRestrictions(state, basicSettings)\n                    : params.areaPositionRestrictions;\n            }\n            else {\n                return defaultAreaPositionRestrictions(state, basicSettings);\n            }\n        }, areaSizeRestrictions: function (state, basicSettings) {\n            if (params.areaSizeRestrictions) {\n                return isFunction(params.areaSizeRestrictions)\n                    ? params.areaSizeRestrictions(state, basicSettings)\n                    : params.areaSizeRestrictions;\n            }\n            else {\n                return defaultAreaSizeRestrictions(state, basicSettings);\n            }\n        }, positionRestrictions: function (state, basicSettings) {\n            if (params.positionRestrictions) {\n                return isFunction(params.positionRestrictions)\n                    ? params.positionRestrictions(state, basicSettings)\n                    : params.positionRestrictions;\n            }\n            else {\n                return defaultPositionRestrictions(state, basicSettings);\n            }\n        }, defaultCoordinates: function (state, basicSettings) {\n            if (params.defaultCoordinates) {\n                return isFunction(params.defaultCoordinates)\n                    ? params.defaultCoordinates(state, basicSettings)\n                    : params.defaultCoordinates;\n            }\n            else {\n                var defaultSizeAlgorithm = params.defaultSize;\n                if (!defaultSizeAlgorithm) {\n                    defaultSizeAlgorithm = defaultSize;\n                }\n                var size = isFunction(defaultSizeAlgorithm)\n                    ? defaultSizeAlgorithm(state, basicSettings)\n                    : defaultSizeAlgorithm;\n                var defaultPositionAlgorithm_1 = params.defaultPosition || defaultPosition;\n                return [\n                    size,\n                    function (state) { return (__assign({}, (isFunction(defaultPositionAlgorithm_1)\n                        ? defaultPositionAlgorithm_1(state, basicSettings)\n                        : defaultPositionAlgorithm_1))); },\n                ];\n            }\n        }, defaultVisibleArea: function (state, basicSettings) {\n            if (params.defaultVisibleArea) {\n                return isFunction(params.defaultVisibleArea)\n                    ? params.defaultVisibleArea(state, basicSettings)\n                    : params.defaultVisibleArea;\n            }\n            else {\n                return defaultVisibleArea(state, basicSettings);\n            }\n        }, aspectRatio: function (state, basicSettings) {\n            return createAspectRatio(isFunction(params.aspectRatio) ? params.aspectRatio(state, basicSettings) : params.aspectRatio);\n        } });\n}\n\nexport { createDefaultSettings, withDefaultAreaPositionRestrictions, withDefaultAreaSizeRestrictions, withDefaultPositionRestrictions, withDefaultSizeRestrictions };\n","import { __assign, __rest, __spreadArrays } from 'tslib';\nimport { getOptions, deepClone, debounce, isArray, isFunction, deepCompare, isUndefined, isObject } from '../utils/index.js';\nimport { getCoefficient, isConsistentState, getStencilCoordinates, getRoundedCoordinates } from '../service/helpers.js';\nimport { copyState } from '../state/copyState.js';\nimport { setCoordinates, SetCoordinatesMode } from '../state/setCoordinates.js';\nimport { setVisibleArea } from '../state/setVisibleArea.js';\nimport { createState } from '../state/createState.js';\nimport { moveCoordinates } from '../state/moveCoordinates.js';\nimport { resizeCoordinates } from '../state/resizeCoordinates.js';\nimport { setBoundary } from '../state/setBoundary.js';\nimport { transformImage } from '../state/transformImage.js';\nimport { reconcileState } from '../state/reconcileState.js';\nimport { normalizeImageTransform, normalizeFlip, normalizeMoveDirections, fillMoveDirections, normalizeResizeDirections, fillResizeDirections } from '../service/normalize.js';\nimport { hasInteractions } from '../service/interactions.js';\n\nfunction runCallback(callback, getInstance) {\n    if (callback && getInstance) {\n        var instance = getInstance();\n        if (instance) {\n            callback(instance);\n        }\n    }\n}\nfunction runCallbacks(callbacks, getInstance) {\n    callbacks.forEach(function (callback) {\n        runCallback(callback, getInstance);\n    });\n}\nvar AbstractCropperInstance = /** @class */ (function () {\n    function AbstractCropperInstance() {\n        var _this = this;\n        this.getTransitions = function () {\n            var data = _this.getData();\n            var transitions = _this.getProps().transitions;\n            return __assign(__assign({}, getOptions(transitions, {\n                timingFunction: 'ease-in-out',\n                duration: 350,\n            })), { active: data.transitions });\n        };\n        this.getInteractions = function () {\n            var interactions = _this.getData().interactions;\n            return deepClone(interactions);\n        };\n        this.hasInteractions = function () {\n            var interactions = _this.getData().interactions;\n            return hasInteractions(interactions);\n        };\n        this.startTransitions = function () {\n            var _a = _this.getProps(), onTransitionsStart = _a.onTransitionsStart, onUpdate = _a.onUpdate, getInstance = _a.getInstance;\n            var _b = _this.getData(), transitions = _b.transitions, data = __rest(_b, [\"transitions\"]);\n            _this.setData(__assign(__assign({}, data), { transitions: true }));\n            if (!transitions) {\n                runCallbacks([onTransitionsStart, onUpdate], getInstance);\n            }\n            _this.endTransitions();\n        };\n        this.endTransitions = debounce(function () {\n            var _a = _this.getProps(), onTransitionsEnd = _a.onTransitionsEnd, onUpdate = _a.onUpdate, getInstance = _a.getInstance;\n            _this.setData(__assign(__assign({}, _this.getData()), { transitions: false }));\n            runCallbacks([onTransitionsEnd, onUpdate], getInstance);\n        }, function () {\n            return _this.getTransitions().duration;\n        });\n        this.applyPostProcess = function (action, state) {\n            var _a = _this.getProps(), settings = _a.settings, postProcess = _a.postProcess;\n            var name = action.name, _b = action.interaction, interaction = _b === void 0 ? false : _b, _c = action.transitions, transitions = _c === void 0 ? false : _c, _d = action.immediately, immediately = _d === void 0 ? false : _d;\n            var preparedAction = {\n                name: name,\n                interaction: interaction,\n                transitions: transitions,\n                immediately: immediately,\n            };\n            if (isArray(postProcess)) {\n                return postProcess.reduce(function (processedState, p) { return p(processedState, settings, preparedAction); }, state);\n            }\n            else if (isFunction(postProcess)) {\n                return postProcess(state, settings, preparedAction);\n            }\n            else {\n                return state;\n            }\n        };\n        this.updateState = function (modifier, options, callbacks) {\n            if (options === void 0) { options = {}; }\n            if (callbacks === void 0) { callbacks = []; }\n            var _a = options.transitions, transitions = _a === void 0 ? false : _a;\n            var _b = _this.getProps(), onTransitionsStart = _b.onTransitionsStart, getInstance = _b.getInstance, onChange = _b.onChange, onUpdate = _b.onUpdate, settings = _b.settings;\n            var previousData = _this.getData();\n            var state = isFunction(modifier) ? modifier(previousData.state, settings) : modifier;\n            var tolerance = state ? 1e-3 * getCoefficient(state) : 1e-3;\n            var somethingChanged = !deepCompare(previousData.state, state, tolerance);\n            var affectTransitionProperties = [\n                'coordinates',\n                'boundary',\n                'visibleArea',\n                'imageSize',\n                'transforms',\n            ].some(function (property) { var _a; return !deepCompare((_a = previousData.state) === null || _a === void 0 ? void 0 : _a[property], state === null || state === void 0 ? void 0 : state[property], tolerance); });\n            var currentData = previousData;\n            if (somethingChanged) {\n                if (transitions && affectTransitionProperties) {\n                    _this.endTransitions();\n                }\n                currentData = __assign(__assign({}, currentData), { state: copyState(state), transitions: transitions && affectTransitionProperties });\n                _this.setData(currentData);\n                runCallback(onChange, getInstance);\n            }\n            if (currentData.transitions && !previousData.transitions) {\n                runCallback(onTransitionsStart, getInstance);\n            }\n            runCallbacks(__spreadArrays(callbacks, [onUpdate]), getInstance);\n        };\n        this.setInteractions = function (interactions) {\n            var _a = _this.getProps(), onInteractionStart = _a.onInteractionStart, onInteractionEnd = _a.onInteractionEnd, getInstance = _a.getInstance;\n            var previousInteractions = _this.getInteractions();\n            var currentInteractions = __assign(__assign({}, previousInteractions), interactions);\n            if (!deepCompare(previousInteractions, currentInteractions)) {\n                _this.setData(__assign(__assign({}, _this.getData()), { interactions: currentInteractions }));\n            }\n            if (hasInteractions(previousInteractions) !== hasInteractions(currentInteractions)) {\n                if (!hasInteractions(previousInteractions)) {\n                    runCallback(onInteractionStart, getInstance);\n                }\n                else {\n                    var state_1 = _this.getData().state;\n                    _this.updateState(function () {\n                        return state_1 &&\n                            _this.applyPostProcess({\n                                name: 'interactionEnd',\n                                immediately: true,\n                                transitions: true,\n                            }, state_1);\n                    }, {\n                        transitions: true,\n                    }, [onInteractionEnd]);\n                }\n            }\n        };\n        this.resetState = function (boundary, image) {\n            _this.updateState(_this.createDefaultState(boundary, image));\n        };\n        this.clear = function () {\n            _this.updateState(null);\n        };\n        this.reconcileState = function (options) {\n            if (options === void 0) { options = {}; }\n            var _a = _this.getProps(), reconcileStateAlgorithm = _a.reconcileStateAlgorithm, settings = _a.settings;\n            var state = _this.getData().state;\n            var _b = options.transitions, transitions = _b === void 0 ? false : _b;\n            if (state && !isConsistentState(state, settings)) {\n                var reconciledState = (reconcileStateAlgorithm || reconcileState)(state, settings);\n                reconciledState = _this.applyPostProcess({\n                    name: 'reconcileState',\n                    immediately: true,\n                    transitions: transitions,\n                }, reconciledState);\n                _this.updateState(reconciledState, {\n                    transitions: transitions,\n                });\n            }\n        };\n        this.transformImage = function (transform, options) {\n            if (options === void 0) { options = {}; }\n            var _a = options.transitions, transitions = _a === void 0 ? true : _a, _b = options.interaction, interaction = _b === void 0 ? true : _b, _c = options.immediately, immediately = _c === void 0 ? false : _c, _d = options.normalize, normalize = _d === void 0 ? true : _d;\n            var _e = _this.getProps(), transformImageAlgorithm = _e.transformImageAlgorithm, onTransformImage = _e.onTransformImage, onTransformImageEnd = _e.onTransformImageEnd, settings = _e.settings;\n            var state = _this.getData().state;\n            var callbacks = [];\n            if (state) {\n                if (normalize) {\n                    transform = normalizeImageTransform(state, transform);\n                }\n                var result = _this.applyPostProcess({\n                    name: 'transformImage',\n                    transitions: transitions,\n                    immediately: immediately,\n                }, (transformImageAlgorithm || transformImage)(state, settings, transform));\n                callbacks.push(onTransformImage);\n                if (interaction) {\n                    _this.setInteractions({\n                        transformImage: {\n                            rotate: !isUndefined(transform.rotate),\n                            flip: !isUndefined(transform.flip),\n                            scale: !isUndefined(transform.scale),\n                            move: !isUndefined(transform.move),\n                        },\n                    });\n                }\n                else {\n                    result = _this.applyPostProcess({\n                        name: 'transformImageEnd',\n                        transitions: transitions,\n                        immediately: true,\n                    }, result);\n                    callbacks.push(onTransformImageEnd);\n                }\n                _this.updateState(result, {\n                    transitions: immediately && transitions,\n                }, callbacks);\n            }\n        };\n        this.transformImageEnd = function (options) {\n            if (options === void 0) { options = {}; }\n            var _a = options.immediately, immediately = _a === void 0 ? true : _a, _b = options.transitions, transitions = _b === void 0 ? true : _b;\n            var state = _this.getData().state;\n            var onTransformImageEnd = _this.getProps().onTransformImageEnd;\n            _this.updateState(function () { return state && _this.applyPostProcess({ name: 'transformImageEnd', immediately: immediately, transitions: transitions }, state); }, {\n                transitions: transitions,\n            }, [onTransformImageEnd]);\n            _this.setInteractions({\n                transformImage: {\n                    rotate: false,\n                    flip: false,\n                    scale: false,\n                    move: false,\n                },\n            });\n        };\n        this.zoomImage = function (scale, options) {\n            if (options === void 0) { options = {}; }\n            var _a = options.interaction, interaction = _a === void 0 ? false : _a, _b = options.immediately, immediately = _b === void 0 ? true : _b, _c = options.transitions, transitions = _c === void 0 ? true : _c, _d = options.normalize, normalize = _d === void 0 ? false : _d;\n            _this.transformImage({\n                scale: scale,\n            }, { interaction: interaction, immediately: immediately, transitions: transitions, normalize: normalize });\n        };\n        this.moveImage = function (left, top, options) {\n            if (options === void 0) { options = {}; }\n            var _a = options.interaction, interaction = _a === void 0 ? false : _a, _b = options.immediately, immediately = _b === void 0 ? true : _b, _c = options.transitions, transitions = _c === void 0 ? true : _c, _d = options.normalize, normalize = _d === void 0 ? false : _d;\n            _this.transformImage({\n                move: {\n                    left: left,\n                    top: top,\n                },\n            }, { interaction: interaction, immediately: immediately, transitions: transitions, normalize: normalize });\n        };\n        this.flipImage = function (horizontal, vertical, options) {\n            if (options === void 0) { options = {}; }\n            var _a = options.interaction, interaction = _a === void 0 ? false : _a, _b = options.immediately, immediately = _b === void 0 ? true : _b, _c = options.transitions, transitions = _c === void 0 ? true : _c, _d = options.normalize, normalize = _d === void 0 ? true : _d;\n            var state = _this.getState();\n            var flip = {\n                horizontal: horizontal,\n                vertical: vertical,\n            };\n            _this.transformImage({\n                flip: state && normalize ? normalizeFlip(state, flip) : flip,\n            }, { interaction: interaction, immediately: immediately, transitions: transitions });\n        };\n        this.rotateImage = function (rotate, options) {\n            if (options === void 0) { options = {}; }\n            var _a = options.interaction, interaction = _a === void 0 ? false : _a, _b = options.immediately, immediately = _b === void 0 ? true : _b, _c = options.transitions, transitions = _c === void 0 ? true : _c, _d = options.normalize, normalize = _d === void 0 ? false : _d;\n            _this.transformImage({\n                rotate: rotate,\n            }, { interaction: interaction, immediately: immediately, transitions: transitions, normalize: normalize });\n        };\n        this.reset = function (boundary, image) {\n            _this.resetState(boundary, image);\n        };\n        this.setState = function (modifier, options) {\n            if (options === void 0) { options = {}; }\n            var settings = _this.getSettings();\n            var state = _this.getData().state;\n            var _a = options.transitions, transitions = _a === void 0 ? true : _a, _b = options.immediately, immediately = _b === void 0 ? false : _b, _c = options.interaction, interaction = _c === void 0 ? false : _c, _d = options.postprocess, postprocess = _d === void 0 ? false : _d;\n            var newState = modifier && (isFunction(modifier) ? modifier(state, settings) : __assign(__assign({}, state), modifier));\n            _this.updateState(function () {\n                return postprocess\n                    ? newState &&\n                        _this.applyPostProcess({\n                            name: 'setState',\n                            immediately: immediately,\n                            transitions: transitions,\n                            interaction: interaction,\n                        }, newState)\n                    : newState;\n            }, {\n                transitions: transitions,\n            });\n        };\n        this.setCoordinates = function (transforms, options) {\n            if (options === void 0) { options = {}; }\n            var state = _this.getData().state;\n            var _a = _this.getProps(), setCoordinatesAlgorithm = _a.setCoordinatesAlgorithm, settings = _a.settings;\n            var _b = options.transitions, transitions = _b === void 0 ? true : _b, _c = options.immediately, immediately = _c === void 0 ? true : _c;\n            _this.updateState(function () {\n                return state &&\n                    _this.applyPostProcess({\n                        name: 'setCoordinates',\n                        immediately: immediately,\n                        transitions: transitions,\n                    }, (setCoordinatesAlgorithm || setCoordinates)(state, settings, transforms, SetCoordinatesMode.zoom));\n            }, {\n                transitions: transitions,\n            });\n        };\n        this.setVisibleArea = function (visibleArea, options) {\n            if (options === void 0) { options = {}; }\n            var _a = options.transitions, transitions = _a === void 0 ? true : _a, _b = options.immediately, immediately = _b === void 0 ? true : _b;\n            var state = _this.getData().state;\n            var _c = _this.getProps(), setVisibleAreaAlgorithm = _c.setVisibleAreaAlgorithm, settings = _c.settings;\n            _this.updateState(function () {\n                return state &&\n                    _this.applyPostProcess({ name: 'setVisibleArea', immediately: immediately, transitions: transitions }, (setVisibleAreaAlgorithm || setVisibleArea)(state, settings, visibleArea));\n            }, {\n                transitions: transitions,\n            });\n        };\n        this.setBoundary = function (boundary, options) {\n            if (options === void 0) { options = {}; }\n            var state = _this.getData().state;\n            var _a = _this.getProps(), setBoundaryAlgorithm = _a.setBoundaryAlgorithm, settings = _a.settings;\n            var _b = options.transitions, transitions = _b === void 0 ? false : _b, _c = options.immediately, immediately = _c === void 0 ? true : _c;\n            if (boundary) {\n                _this.updateState(function () {\n                    return state &&\n                        _this.applyPostProcess({ name: 'setBoundary', immediately: immediately, transitions: transitions }, (setBoundaryAlgorithm || setBoundary)(state, settings, boundary));\n                });\n            }\n            else {\n                _this.updateState(null);\n            }\n        };\n        this.moveCoordinates = function (directions, options) {\n            if (options === void 0) { options = {}; }\n            var data = _this.getData();\n            var _a = _this.getProps(), moveCoordinatesAlgorithm = _a.moveCoordinatesAlgorithm, onMove = _a.onMove, onMoveEnd = _a.onMoveEnd, settings = _a.settings;\n            var _b = options.interaction, interaction = _b === void 0 ? true : _b, _c = options.transitions, transitions = _c === void 0 ? false : _c, _d = options.immediately, immediately = _d === void 0 ? false : _d, _e = options.normalize, normalize = _e === void 0 ? true : _e;\n            var callbacks = [];\n            if (!data.transitions && data.state) {\n                var normalizedDirections = normalize\n                    ? normalizeMoveDirections(data.state, directions)\n                    : fillMoveDirections(directions);\n                var result = _this.applyPostProcess({ name: 'moveCoordinates', interaction: interaction, immediately: immediately, transitions: transitions }, (moveCoordinatesAlgorithm || moveCoordinates)(data.state, settings, normalizedDirections));\n                callbacks.push(onMove);\n                if (interaction) {\n                    _this.setInteractions({\n                        moveCoordinates: true,\n                    });\n                }\n                else {\n                    result = _this.applyPostProcess({ name: 'moveCoordinatesEnd', interaction: interaction, immediately: immediately, transitions: transitions }, result);\n                    callbacks.push(onMoveEnd);\n                }\n                _this.updateState(result, {\n                    transitions: immediately && transitions,\n                }, callbacks);\n            }\n        };\n        this.moveCoordinatesEnd = function (options) {\n            if (options === void 0) { options = {}; }\n            var state = _this.getData().state;\n            var onMoveEnd = _this.getProps().onMoveEnd;\n            var _a = options.transitions, transitions = _a === void 0 ? true : _a, _b = options.immediately, immediately = _b === void 0 ? false : _b;\n            _this.updateState(function () { return state && _this.applyPostProcess({ name: 'moveCoordinatesEnd', transitions: transitions, immediately: immediately }, state); }, {\n                transitions: transitions,\n            }, [onMoveEnd]);\n            _this.setInteractions({\n                moveCoordinates: false,\n            });\n        };\n        this.resizeCoordinates = function (anchor, directions, parameters, options) {\n            if (options === void 0) { options = {}; }\n            var state = _this.getData().state;\n            var _a = _this.getProps(), resizeCoordinatesAlgorithm = _a.resizeCoordinatesAlgorithm, onResize = _a.onResize, onResizeEnd = _a.onResizeEnd, settings = _a.settings;\n            var _b = options.interaction, interaction = _b === void 0 ? true : _b, _c = options.transitions, transitions = _c === void 0 ? false : _c, _d = options.immediately, immediately = _d === void 0 ? false : _d, _e = options.normalize, normalize = _e === void 0 ? true : _e;\n            var transitionsOptions = _this.getTransitions();\n            if (!transitionsOptions.active && state) {\n                var callbacks = [];\n                var normalizedDirections = normalize\n                    ? normalizeResizeDirections(state, directions)\n                    : fillResizeDirections(directions);\n                var result = _this.applyPostProcess({ name: 'resizeCoordinates', interaction: interaction, immediately: immediately, transitions: transitions }, (resizeCoordinatesAlgorithm || resizeCoordinates)(state, settings, anchor, normalizedDirections, isObject(parameters) ? parameters : {}));\n                callbacks.push(onResize);\n                if (interaction) {\n                    _this.setInteractions({\n                        resizeCoordinates: true,\n                    });\n                }\n                else {\n                    result = _this.applyPostProcess({ name: 'resizeCoordinatesEnd', interaction: interaction, immediately: immediately, transitions: transitions }, result);\n                    callbacks.push(onResizeEnd);\n                }\n                _this.updateState(result, {\n                    transitions: immediately && transitions,\n                }, callbacks);\n            }\n        };\n        this.resizeCoordinatesEnd = function (options) {\n            if (options === void 0) { options = {}; }\n            var onResizeEnd = _this.getProps().onResizeEnd;\n            var state = _this.getData().state;\n            var _a = options.transitions, transitions = _a === void 0 ? true : _a, _b = options.immediately, immediately = _b === void 0 ? false : _b;\n            _this.updateState(function () { return state && _this.applyPostProcess({ name: 'resizeCoordinatesEnd', transitions: transitions, immediately: immediately }, state); }, {\n                transitions: transitions,\n            }, [onResizeEnd]);\n            _this.setInteractions({\n                resizeCoordinates: false,\n            });\n        };\n        this.getStencilCoordinates = function () {\n            var state = _this.getData().state;\n            return getStencilCoordinates(state);\n        };\n        this.getCoordinates = function (options) {\n            if (options === void 0) { options = {}; }\n            var state = _this.getData().state;\n            var settings = _this.getProps().settings;\n            if (state && state.coordinates) {\n                var _a = options.round, round = _a === void 0 ? true : _a;\n                if (round) {\n                    return getRoundedCoordinates(state, settings);\n                }\n                else {\n                    return __assign({}, state.coordinates);\n                }\n            }\n            else {\n                return null;\n            }\n        };\n        this.getVisibleArea = function () {\n            var state = _this.getData().state;\n            if (state === null || state === void 0 ? void 0 : state.visibleArea) {\n                return __assign({}, state.visibleArea);\n            }\n            else {\n                return null;\n            }\n        };\n        this.getSettings = function () {\n            var settings = _this.getProps().settings;\n            return __assign({}, settings);\n        };\n        this.getState = function () {\n            var state = _this.getData().state;\n            return copyState(state);\n        };\n        this.getTransforms = function () {\n            var state = _this.getData().state;\n            return state\n                ? deepClone(state.transforms)\n                : {\n                    rotate: 0,\n                    flip: {\n                        horizontal: false,\n                        vertical: false,\n                    },\n                };\n        };\n        this.createDefaultState = function (boundary, image) {\n            var _a = _this.getProps(), createStateAlgorithm = _a.createStateAlgorithm, settings = _a.settings;\n            return _this.applyPostProcess({\n                name: 'createState',\n                immediately: true,\n                transitions: false,\n            }, (createStateAlgorithm || createState)({\n                image: image,\n                boundary: boundary,\n            }, settings));\n        };\n        this.isConsistent = function () {\n            var state = _this.getData().state;\n            var settings = _this.getProps().settings;\n            return state ? isConsistentState(state, settings) : true;\n        };\n    }\n    return AbstractCropperInstance;\n}());\n\nexport { AbstractCropperInstance };\n","var timingFunctions = {\n    linear: function (t) {\n        return t;\n    },\n    'ease-in': function (t) {\n        return Math.pow(t, 1.675);\n    },\n    'ease-out': function (t) {\n        return 1 - Math.pow(1 - t, 1.675);\n    },\n    'ease-in-out': function (t) {\n        return 0.5 * (Math.sin((t - 0.5) * Math.PI) + 1);\n    },\n};\nvar Animation = /** @class */ (function () {\n    function Animation() {\n        this.active = false;\n    }\n    Animation.prototype.start = function (animation) {\n        var _a;\n        this.onStart = animation.onStart;\n        this.onProgress = animation.onProgress;\n        this.onStop = animation.onStop;\n        if (!this.active) {\n            (_a = this.onStart) === null || _a === void 0 ? void 0 : _a.call(this);\n        }\n        if (this.id) {\n            window.cancelAnimationFrame(this.id);\n        }\n        this.startTime = performance.now();\n        this.timingFunction = animation.timingFunction;\n        this.endTime = this.startTime + animation.duration;\n        this.active = true;\n        this.animate();\n    };\n    Animation.prototype.animate = function () {\n        var _this = this;\n        if (this.startTime && this.endTime) {\n            var timingFunction = timingFunctions[this.timingFunction];\n            if (!timingFunction) {\n                if (process.env.NODE_ENV !== 'production') {\n                    console.warn(\"[Animation] The timing function '\" + timingFunction + \"' is not supported. Available timing function: 'linear', 'ease-in', 'ease-in-out', 'ease-out'. Reset to 'ease-out'.\");\n                }\n                timingFunction = timingFunctions['ease-out'];\n            }\n            var percent = 1 - (this.endTime - performance.now()) / (this.endTime - this.startTime);\n            var progress = Math.min(1, timingFunction(percent));\n            if (this.onProgress) {\n                this.onProgress(progress);\n            }\n            if (percent < 1) {\n                this.id = window.requestAnimationFrame(function () { return _this.animate(); });\n            }\n            else {\n                this.stop();\n            }\n        }\n        else {\n            this.stop();\n        }\n    };\n    Animation.prototype.stop = function () {\n        this.active = false;\n        if (this.id) {\n            window.cancelAnimationFrame(this.id);\n        }\n        if (this.onStop) {\n            this.onStop();\n        }\n    };\n    return Animation;\n}());\n\nexport { Animation };\n","import { __assign } from 'tslib';\nimport { isNumeric } from '../utils/index.js';\nimport { rotateSize, rotatePoint, getCenter } from '../service/utils.js';\nimport { isInitializedState } from '../service/helpers.js';\nimport '../types/index.js';\nimport '../state/setCoordinates.js';\nimport { approximateSize } from '../service/approximateSize.js';\n\nfunction prepareSource(canvas, image, _a) {\n    var rotate = _a.rotate, flip = _a.flip;\n    var originalSize = {\n        width: 'naturalWidth' in image ? image.naturalWidth : image.width,\n        height: 'naturalHeight' in image ? image.naturalHeight : image.height,\n    };\n    var transformedSize = rotateSize(originalSize, rotate);\n    var ctx = canvas.getContext('2d');\n    canvas.height = transformedSize.height;\n    canvas.width = transformedSize.width;\n    if (ctx) {\n        ctx.save();\n        // Rotation:\n        var canvasCenter = rotatePoint(getCenter(__assign({ left: 0, top: 0 }, originalSize)), rotate);\n        ctx.translate(-(canvasCenter.left - transformedSize.width / 2), -(canvasCenter.top - transformedSize.height / 2));\n        ctx.rotate((rotate * Math.PI) / 180);\n        // Reflection;\n        ctx.translate(flip.horizontal ? originalSize.width : 0, flip.vertical ? originalSize.height : 0);\n        ctx.scale(flip.horizontal ? -1 : 1, flip.vertical ? -1 : 1);\n        ctx.drawImage(image, 0, 0, originalSize.width, originalSize.height);\n        ctx.restore();\n    }\n    return canvas;\n}\nfunction updateCanvas(canvas, source, coordinates, resultSize, options) {\n    canvas.width = resultSize ? resultSize.width : coordinates.width;\n    canvas.height = resultSize ? resultSize.height : coordinates.height;\n    var ctx = canvas.getContext('2d');\n    if (ctx) {\n        ctx.clearRect(0, 0, canvas.width, canvas.height);\n        if (options) {\n            if (options.imageSmoothingEnabled) {\n                ctx.imageSmoothingEnabled = options.imageSmoothingEnabled;\n            }\n            if (options.imageSmoothingQuality) {\n                ctx.imageSmoothingQuality = options.imageSmoothingQuality;\n            }\n            if (options.fillColor) {\n                ctx.fillStyle = options.fillColor;\n                ctx.fillRect(0, 0, canvas.width, canvas.height);\n                ctx.save();\n            }\n        }\n        var offsetX = coordinates.left < 0 ? -coordinates.left : 0;\n        var offsetY = coordinates.top < 0 ? -coordinates.top : 0;\n        ctx.drawImage(source, coordinates.left + offsetX, coordinates.top + offsetY, coordinates.width, coordinates.height, offsetX * (canvas.width / coordinates.width), offsetY * (canvas.height / coordinates.height), canvas.width, canvas.height);\n    }\n    return canvas;\n}\nfunction drawCroppedArea(state, image, resultCanvas, spareCanvas, options) {\n    if (isInitializedState(state)) {\n        var transforms = state.transforms, coordinates = state.coordinates;\n        var imageTransformed = transforms.rotate !== 0 || transforms.flip.horizontal || transforms.flip.vertical;\n        var source = imageTransformed ? prepareSource(spareCanvas, image, transforms) : image;\n        var params = __assign({ minWidth: 0, minHeight: 0, maxWidth: Infinity, maxHeight: Infinity, maxArea: Infinity, imageSmoothingEnabled: true, imageSmoothingQuality: 'high', fillColor: 'transparent' }, options);\n        var firstNumeric = function (array) { return array.find(function (el) { return isNumeric(el); }); };\n        var size = approximateSize({\n            sizeRestrictions: {\n                minWidth: firstNumeric([params.width, params.minWidth]) || 0,\n                minHeight: firstNumeric([params.height, params.minHeight]) || 0,\n                maxWidth: firstNumeric([params.width, params.maxWidth]) || Infinity,\n                maxHeight: firstNumeric([params.height, params.maxHeight]) || Infinity,\n            },\n            width: coordinates.width,\n            height: coordinates.height,\n            aspectRatio: {\n                minimum: coordinates.width / coordinates.height,\n                maximum: coordinates.width / coordinates.height,\n            },\n        });\n        if (params.maxArea && size.width * size.height > params.maxArea) {\n            var scale = Math.sqrt(params.maxArea / (size.width * size.height));\n            size = {\n                width: Math.round(scale * size.width),\n                height: Math.round(scale * size.height),\n            };\n        }\n        return updateCanvas(resultCanvas, source, coordinates, size, params);\n    }\n    else {\n        return null;\n    }\n}\n\nexport { drawCroppedArea, prepareSource, updateCanvas };\n","function stretchCropperBoundary(boundary, stretcher, size) {\n    // Reset stretcher\n    stretcher.style.width = \"0px\";\n    stretcher.style.height = \"0px\";\n    // Try to fit the size by width:\n    stretcher.style.width = Math.max(boundary.clientWidth, size.width) + \"px\";\n    // After that try to fit the size by height and resulted width:\n    var ratio = size.width / size.height;\n    stretcher.style.height = Math.max(boundary.clientHeight, stretcher.clientWidth / ratio) + \"px\";\n    stretcher.style.width = stretcher.clientHeight * ratio + \"px\";\n}\nfunction stretchPreviewBoundary(boundary, stretcher, size) {\n    // Reset stretcher\n    stretcher.style.width = \"0px\";\n    stretcher.style.height = \"0px\";\n    // Try to fit the size by width:\n    stretcher.style.width = Math.max(boundary.getBoundingClientRect().width, size.width) + \"px\";\n    // After that try to fit the size by height and resulted width:\n    var ratio = size.width / size.height;\n    stretcher.style.height = Math.max(boundary.getBoundingClientRect().height, stretcher.getBoundingClientRect().width / ratio) + \"px\";\n    stretcher.style.width = stretcher.getBoundingClientRect().height * ratio + \"px\";\n    if (stretcher.clientWidth / stretcher.clientHeight > boundary.clientWidth / boundary.clientHeight) {\n        if (stretcher.clientWidth > boundary.clientWidth) {\n            stretcher.style.width = boundary.clientWidth + \"px\";\n            stretcher.style.height = boundary.clientWidth / ratio + \"px\";\n        }\n    }\n    else {\n        if (stretcher.clientHeight > boundary.clientHeight) {\n            stretcher.style.height = boundary.clientHeight + \"px\";\n            stretcher.style.width = boundary.clientHeight * ratio + \"px\";\n        }\n    }\n}\n\nexport { stretchCropperBoundary, stretchPreviewBoundary };\n","import { __assign } from 'tslib';\nimport { isCrossOriginURL, isBlob, isLocal } from '../utils/index.js';\nimport { ratio } from '../service/utils.js';\nimport { getTransformedImageSize, getCoefficient } from '../service/helpers.js';\nimport '../types/index.js';\nimport '../state/setCoordinates.js';\n\nvar XHR_DONE = 4;\nfunction base64ToArrayBuffer(base64) {\n    base64 = base64.replace(/^data:([^;]+);base64,/gim, '');\n    var binary = atob(base64);\n    var len = binary.length;\n    var buffer = new ArrayBuffer(len);\n    var view = new Uint8Array(buffer);\n    for (var i = 0; i < len; i++) {\n        view[i] = binary.charCodeAt(i);\n    }\n    return buffer;\n}\nfunction objectURLToBlob(url, callback) {\n    var http = new XMLHttpRequest();\n    http.open('GET', url, true);\n    http.responseType = 'blob';\n    http.onload = function () {\n        if (this.status == 200 || this.status === 0) {\n            callback(this.response);\n        }\n    };\n    http.send();\n}\nfunction getTransforms(orientation) {\n    var result = {\n        flip: {\n            horizontal: false,\n            vertical: false,\n        },\n        rotate: 0,\n    };\n    if (orientation) {\n        switch (orientation) {\n            case 2:\n                result.flip.horizontal = true;\n                break;\n            case 3:\n                result.rotate = -180;\n                break;\n            case 4:\n                result.flip.vertical = true;\n                break;\n            case 5:\n                result.rotate = 90;\n                result.flip.vertical = true;\n                break;\n            case 6:\n                result.rotate = 90;\n                break;\n            case 7:\n                result.rotate = 90;\n                result.flip.horizontal = true;\n                break;\n            case 8:\n                result.rotate = -90;\n                break;\n        }\n    }\n    return result;\n}\nfunction getImageData(img) {\n    return new Promise(function (resolve, reject) {\n        try {\n            if (img) {\n                if (/^data:/i.test(img)) {\n                    // Data URL\n                    resolve(base64ToArrayBuffer(img));\n                }\n                else if (/^blob:/i.test(img)) {\n                    // Blob\n                    var fileReader_1 = new FileReader();\n                    fileReader_1.onload = function (e) {\n                        var _a;\n                        resolve((_a = e.target) === null || _a === void 0 ? void 0 : _a.result);\n                    };\n                    objectURLToBlob(img, function (blob) {\n                        fileReader_1.readAsArrayBuffer(blob);\n                    });\n                }\n                else {\n                    // Simple URL\n                    var http_1 = new XMLHttpRequest();\n                    http_1.onreadystatechange = function () {\n                        if (http_1.readyState !== XHR_DONE)\n                            return;\n                        if (http_1.status === 200 || http_1.status === 0) {\n                            resolve(http_1.response);\n                        }\n                        else {\n                            reject('Warning: could not load an image to parse its orientation');\n                        }\n                    };\n                    http_1.onprogress = function () {\n                        // Abort the request directly if it not a JPEG image for better performance\n                        if (http_1.getResponseHeader('content-type') !== 'image/jpeg') {\n                            http_1.abort();\n                        }\n                    };\n                    http_1.withCredentials = false;\n                    http_1.open('GET', img, true);\n                    http_1.responseType = 'arraybuffer';\n                    http_1.send(null);\n                }\n            }\n            else {\n                reject('Error: the image is empty');\n            }\n        }\n        catch (e) {\n            reject(e);\n        }\n    });\n}\nfunction getStyleTransforms(transforms) {\n    var _a = transforms.rotate, rotate = _a === void 0 ? 0 : _a, _b = transforms.flip, flip = _b === void 0 ? { horizontal: false, vertical: false } : _b, _c = transforms.scale, scale = _c === void 0 ? 1 : _c;\n    return \" rotate(\" + rotate + \"deg) scaleX(\" + scale * (flip.horizontal ? -1 : 1) + \") scaleY(\" + scale * (flip.vertical ? -1 : 1) + \")\";\n}\nfunction getStringFromCharCode(dataView, start, length) {\n    var str = '';\n    var i;\n    for (i = start, length += start; i < length; i++) {\n        str += String.fromCharCode(dataView.getUint8(i));\n    }\n    return str;\n}\nfunction resetAndGetOrientation(arrayBuffer) {\n    try {\n        var dataView = new DataView(arrayBuffer);\n        var orientation_1;\n        var exifIDCode = void 0;\n        var tiffOffset = void 0;\n        var littleEndian = void 0;\n        var app1Start = void 0;\n        var ifdStart = void 0;\n        // Only handle JPEG image (start by 0xFFD8)\n        if (dataView.getUint8(0) === 0xff && dataView.getUint8(1) === 0xd8) {\n            var length_1 = dataView.byteLength;\n            var offset = 2;\n            while (offset + 1 < length_1) {\n                if (dataView.getUint8(offset) === 0xff && dataView.getUint8(offset + 1) === 0xe1) {\n                    app1Start = offset;\n                    break;\n                }\n                offset++;\n            }\n        }\n        if (app1Start) {\n            exifIDCode = app1Start + 4;\n            tiffOffset = app1Start + 10;\n            if (getStringFromCharCode(dataView, exifIDCode, 4) === 'Exif') {\n                var endianness = dataView.getUint16(tiffOffset);\n                littleEndian = endianness === 0x4949;\n                if (littleEndian || endianness === 0x4d4d /* bigEndian */) {\n                    if (dataView.getUint16(tiffOffset + 2, littleEndian) === 0x002a) {\n                        var firstIFDOffset = dataView.getUint32(tiffOffset + 4, littleEndian);\n                        if (firstIFDOffset >= 0x00000008) {\n                            ifdStart = tiffOffset + firstIFDOffset;\n                        }\n                    }\n                }\n            }\n        }\n        if (ifdStart) {\n            var length_2 = dataView.getUint16(ifdStart, littleEndian);\n            for (var i = 0; i < length_2; i++) {\n                var offset = ifdStart + i * 12 + 2;\n                if (dataView.getUint16(offset, littleEndian) === 0x0112 /* Orientation */) {\n                    // 8 is the offset of the current tag's value\n                    offset += 8;\n                    // Get the original orientation value\n                    orientation_1 = dataView.getUint16(offset, littleEndian);\n                    // Override the orientation with its default value\n                    dataView.setUint16(offset, 1, littleEndian);\n                    break;\n                }\n            }\n        }\n        return orientation_1;\n    }\n    catch (error) {\n        return null;\n    }\n}\nfunction arrayBufferToDataURL(arrayBuffer) {\n    var chunks = [];\n    // Chunk Typed Array for better performance\n    var chunkSize = 8192;\n    var uint8 = new Uint8Array(arrayBuffer);\n    while (uint8.length > 0) {\n        var value = uint8.subarray(0, chunkSize);\n        chunks.push(String.fromCharCode.apply(null, (Array.from ? Array.from(value) : value.slice())));\n        uint8 = uint8.subarray(chunkSize);\n    }\n    return \"data:image/jpeg;base64,\" + btoa(chunks.join(''));\n}\nfunction getImage(_a) {\n    var src = _a.src, _b = _a.arrayBuffer, arrayBuffer = _b === void 0 ? null : _b, _c = _a.orientation, orientation = _c === void 0 ? null : _c;\n    var options = {\n        src: src,\n        arrayBuffer: arrayBuffer,\n        revoke: false,\n        transforms: {\n            flip: {\n                horizontal: false,\n                vertical: false,\n            },\n            rotate: 0,\n        },\n    };\n    if (arrayBuffer && orientation && orientation > 1) {\n        if (isBlob(src) || !isLocal(src)) {\n            options.src = URL.createObjectURL(new Blob([arrayBuffer]));\n            options.revoke = true;\n        }\n        else {\n            options.src = arrayBufferToDataURL(arrayBuffer);\n        }\n    }\n    else {\n        options.src = src;\n    }\n    if (orientation) {\n        options.transforms = getTransforms(orientation);\n    }\n    return options;\n}\nfunction parseImage(src, settings) {\n    if (settings === void 0) { settings = {}; }\n    var checkOrientation = settings.checkOrientation, parse = settings.parse;\n    return new Promise(function (resolve) {\n        if (checkOrientation || parse) {\n            getImageData(src)\n                .then(function (data) {\n                var orientation = resetAndGetOrientation(data);\n                resolve(getImage(data\n                    ? { src: src, arrayBuffer: data, orientation: orientation }\n                    : { src: src, arrayBuffer: null, orientation: null }));\n            })\n                .catch(function (error) {\n                console.warn(error);\n                resolve(getImage({ src: src }));\n            });\n        }\n        else {\n            resolve(getImage({ src: src }));\n        }\n    });\n}\nfunction createImage(src, settings) {\n    if (settings === void 0) { settings = {}; }\n    return new Promise(function (resolve, reject) {\n        var image = document.createElement('img');\n        if (settings.crossOrigin) {\n            image.crossOrigin = settings.crossOrigin !== true ? settings.crossOrigin : 'anonymous';\n        }\n        image.src = src;\n        image.style.visibility = 'hidden';\n        image.style.position = 'fixed';\n        document.body.appendChild(image);\n        if (image.complete) {\n            resolve(image);\n            document.body.removeChild(image);\n        }\n        else {\n            image.addEventListener('load', function () {\n                resolve(image);\n                document.body.removeChild(image);\n            });\n            image.addEventListener('error', function () {\n                reject(null);\n                document.body.removeChild(image);\n            });\n        }\n    });\n}\nfunction loadImage(src, settings) {\n    if (settings === void 0) { settings = {}; }\n    return parseImage(src, __assign(__assign({}, settings), { crossOrigin: isCrossOriginURL(src) && settings.crossOrigin })).then(function (options) {\n        return new Promise(function (resolve, reject) {\n            createImage(options.src, settings)\n                .then(function (image) {\n                resolve(__assign(__assign({}, options), { width: image.naturalWidth, height: image.naturalHeight }));\n            })\n                .catch(function () {\n                reject(null);\n            });\n        });\n    });\n}\nfunction getImageStyle(image, state, area, coefficient, transitions) {\n    if (transitions === void 0) { transitions = null; }\n    var optimalImageSize = image.width > image.height\n        ? {\n            width: Math.min(512, image.width),\n            height: Math.min(512, image.width) / (image.width / image.height),\n        }\n        : {\n            height: Math.min(512, image.height),\n            width: Math.min(512, image.height) * (image.width / image.height),\n        };\n    var actualImageSize = getTransformedImageSize(state);\n    var imageTransforms = {\n        rotate: state.transforms.rotate,\n        flip: {\n            horizontal: state.transforms.flip.horizontal,\n            vertical: state.transforms.flip.vertical,\n        },\n        translateX: area.left / coefficient,\n        translateY: area.top / coefficient,\n        scale: 1 / coefficient,\n    };\n    var compensations = {\n        rotate: {\n            left: (optimalImageSize.width - actualImageSize.width) / (2 * coefficient),\n            top: (optimalImageSize.height - actualImageSize.height) / (2 * coefficient),\n        },\n        scale: {\n            left: ((1 - 1 / coefficient) * optimalImageSize.width) / 2,\n            top: ((1 - 1 / coefficient) * optimalImageSize.height) / 2,\n        },\n    };\n    var transforms = __assign(__assign({}, imageTransforms), { scale: imageTransforms.scale * (image.width / optimalImageSize.width) });\n    var result = {\n        width: optimalImageSize.width + \"px\",\n        height: optimalImageSize.height + \"px\",\n        left: '0px',\n        top: '0px',\n        transition: 'none',\n        transform: \"translate3d(\" + (-compensations.rotate.left - compensations.scale.left - imageTransforms.translateX) + \"px, \" + (-compensations.rotate.top - compensations.scale.top - imageTransforms.translateY) + \"px, 0px)\" + getStyleTransforms(transforms),\n        willChange: 'none',\n    };\n    if (transitions && transitions.active) {\n        result.willChange = 'transform';\n        result.transition = transitions.duration + \"ms \" + transitions.timingFunction;\n    }\n    return result;\n}\nfunction getBackgroundStyle(image, state, transitions) {\n    if (transitions === void 0) { transitions = null; }\n    if (image && state && state.visibleArea) {\n        return getImageStyle(image, state, state.visibleArea, getCoefficient(state), transitions);\n    }\n    else {\n        return {};\n    }\n}\nfunction getPreviewStyle(image, state, size, transitions) {\n    if (transitions === void 0) { transitions = null; }\n    if (image && state && state.visibleArea && state.coordinates) {\n        return getImageStyle(image, state, state.coordinates, ratio(state.coordinates) > ratio(size)\n            ? state.coordinates.width / size.width\n            : state.coordinates.height / size.height, transitions);\n    }\n    else {\n        return {};\n    }\n}\n\nexport { createImage, getBackgroundStyle, getImageStyle, getPreviewStyle, getStyleTransforms, loadImage };\n","import {\n\tapplyMove,\n\tapplyScale,\n\tdiff,\n\tfitToSizeRestrictions,\n\tgetAreaPositionRestrictions,\n\tgetAreaSizeRestrictions,\n\tgetCenter,\n\tgetPositionRestrictions,\n\tisInitializedState,\n\tmergePositionRestrictions,\n\tmoveToPositionRestrictions,\n\tratio,\n\tcoordinatesToPositionRestrictions,\n} from 'advanced-cropper/service';\nimport { CoreSettings, CropperState, PostprocessAction, Size } from 'advanced-cropper';\nimport { copyState } from 'advanced-cropper/state';\n\nexport function hybridStencilAutoZoomAlgorithm(state: CropperState, settings: CoreSettings): CropperState {\n\tif (isInitializedState(state)) {\n\t\tconst result = copyState(state);\n\n\t\t// Checks that coordinates has the same ratio that coordinates:\n\t\tconst stencil: Size = {\n\t\t\twidth: 0,\n\t\t\theight: 0,\n\t\t};\n\n\t\tif (ratio(result.boundary) > ratio(result.coordinates)) {\n\t\t\tstencil.height = result.boundary.height * 0.8;\n\t\t\tstencil.width = stencil.height * ratio(result.coordinates);\n\t\t} else {\n\t\t\tstencil.width = result.boundary.width * 0.8;\n\t\t\tstencil.height = stencil.width * ratio(result.coordinates);\n\t\t}\n\n\t\t// First of all try to resize visible area as much as possible:\n\t\tresult.visibleArea = applyScale(\n\t\t\tresult.visibleArea,\n\t\t\t(result.coordinates.width * result.boundary.width) / (result.visibleArea.width * stencil.width),\n\t\t);\n\n\t\t// Check that visible area doesn't break the area restrictions:\n\t\tconst scale = fitToSizeRestrictions(result.visibleArea, getAreaSizeRestrictions(result, settings));\n\n\t\tresult.visibleArea = applyScale(result.visibleArea, scale);\n\n\t\tif (scale !== 1) {\n\t\t\tstencil.height /= scale;\n\t\t\tstencil.width /= scale;\n\t\t}\n\n\t\tresult.visibleArea = applyMove(\n\t\t\tresult.visibleArea,\n\t\t\tdiff(getCenter(result.coordinates), getCenter(result.visibleArea)),\n\t\t);\n\n\t\t// Center stencil in visible area:\n\t\tresult.visibleArea = moveToPositionRestrictions(\n\t\t\tresult.visibleArea,\n\t\t\tgetAreaPositionRestrictions(result, settings),\n\t\t);\n\n\t\tresult.coordinates = moveToPositionRestrictions(\n\t\t\tresult.coordinates,\n\t\t\tmergePositionRestrictions(\n\t\t\t\tcoordinatesToPositionRestrictions(result.visibleArea),\n\t\t\t\tgetPositionRestrictions(result, settings),\n\t\t\t),\n\t\t);\n\n\t\treturn result;\n\t}\n\treturn state;\n}\n\nexport function hybridStencilAutoZoom(\n\tstate: CropperState,\n\tsettings: CoreSettings,\n\taction: PostprocessAction,\n): CropperState {\n\tif (action.immediately) {\n\t\treturn hybridStencilAutoZoomAlgorithm(state, settings);\n\t}\n\treturn state;\n}\n","import { useRef } from 'react';\nimport { deprecationWarning } from '../service/utils';\n\nexport function useDeprecationWarning() {\n\tconst fired = useRef<string[]>([]);\n\n\treturn (message: string) => {\n\t\tif (fired.current.indexOf(message) === -1) {\n\t\t\tdeprecationWarning(message);\n\t\t\tfired.current.push(message);\n\t\t}\n\t};\n}\n","export function deprecationWarning(text: string) {\n\tif (process.env.NODE_ENV === 'development') {\n\t\tconsole.warn(`Deprecation warning: ${text}`);\n\t}\n}\n","/*!\n  Copyright (c) 2018 Jed Watson.\n  Licensed under the MIT License (MIT), see\n  http://jedwatson.github.io/classnames\n*/\n/* global define */\n\n(function () {\n\t'use strict';\n\n\tvar hasOwn = {}.hasOwnProperty;\n\n\tfunction classNames() {\n\t\tvar classes = [];\n\n\t\tfor (var i = 0; i < arguments.length; i++) {\n\t\t\tvar arg = arguments[i];\n\t\t\tif (!arg) continue;\n\n\t\t\tvar argType = typeof arg;\n\n\t\t\tif (argType === 'string' || argType === 'number') {\n\t\t\t\tclasses.push(arg);\n\t\t\t} else if (Array.isArray(arg)) {\n\t\t\t\tif (arg.length) {\n\t\t\t\t\tvar inner = classNames.apply(null, arg);\n\t\t\t\t\tif (inner) {\n\t\t\t\t\t\tclasses.push(inner);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else if (argType === 'object') {\n\t\t\t\tif (arg.toString === Object.prototype.toString) {\n\t\t\t\t\tfor (var key in arg) {\n\t\t\t\t\t\tif (hasOwn.call(arg, key) && arg[key]) {\n\t\t\t\t\t\t\tclasses.push(key);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tclasses.push(arg.toString());\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn classes.join(' ');\n\t}\n\n\tif (typeof module !== 'undefined' && module.exports) {\n\t\tclassNames.default = classNames;\n\t\tmodule.exports = classNames;\n\t} else if (typeof define === 'function' && typeof define.amd === 'object' && define.amd) {\n\t\t// register as 'classnames', consistent with npm package name\n\t\tdefine('classnames', [], function () {\n\t\t\treturn classNames;\n\t\t});\n\t} else {\n\t\twindow.classNames = classNames;\n\t}\n}());\n","import { useEffect } from 'react';\nimport { useFirstMountState } from './useFirstMountState';\n\nexport const useUpdateEffect: typeof useEffect = (effect, deps) => {\n\tconst isFirstMount = useFirstMountState();\n\n\tuseEffect(() => {\n\t\tif (!isFirstMount) {\n\t\t\treturn effect();\n\t\t}\n\t}, deps);\n};\n","import { useRef } from 'react';\n\nexport function useFirstMountState(): boolean {\n\tconst isFirst = useRef(true);\n\n\tif (isFirst.current) {\n\t\tisFirst.current = false;\n\n\t\treturn true;\n\t}\n\n\treturn isFirst.current;\n}\n","import { SetStateAction, useRef, useState } from \"react\";\nimport { useUpdateEffect } from \"./useUpdateEffect\";\n\ntype DispatchWithCallback<S> = (value: SetStateAction<S>, callback?: Function) => void;\n\nexport function useStateWithCallback<S>(initialState?: S | (() => S)): [S, DispatchWithCallback<S>];\nexport function useStateWithCallback<S = undefined>(): [S | undefined, DispatchWithCallback<S  | undefined>];\nexport function useStateWithCallback<S = undefined>(initialState?: S | (() => S)): [S | undefined, DispatchWithCallback<S | undefined>]  {\n\tconst [state, setState] = useState(initialState);\n\tconst [callback, setCallback] = useState<Function | null | undefined>(null);\n\tconst previousState = useRef(initialState);\n\n\tuseUpdateEffect(() => {\n\t\tif (callback) {\n\t\t\tcallback(state, previousState.current);\n\t\t}\n\t}, [callback])\n\n\treturn [\n\t\tstate,\n\t\t(value: SetStateAction<S | undefined>, callback?: Function) => {\n\t\t\tpreviousState.current = state;\n\t\t\tsetState(value);\n\t\t\tsetCallback(() => callback);\n\t\t}\n\t]\n}\n","import {\n\tAbstractCropperInstance,\n\tAbstractCropperInstanceData,\n\tAbstractCropperInstanceProps,\n\tAbstractCropperInstanceSettings,\n\tgetEmptyInteractions,\n} from 'advanced-cropper';\n\nexport interface CropperInstanceProps<Settings extends AbstractCropperInstanceSettings, Instance> {\n\tgetProps: () => AbstractCropperInstanceProps<Settings, Instance>;\n\tsetData?: (data: AbstractCropperInstanceData) => void;\n}\n\nexport class CropperInstance<\n\tSettings extends AbstractCropperInstanceSettings,\n\tInstance = unknown,\n> extends AbstractCropperInstance<Settings, Instance> {\n\tdata: AbstractCropperInstanceData;\n\tnotify: () => void;\n\tprops: () => AbstractCropperInstanceProps<Settings, Instance>;\n\n\tconstructor(props: () => AbstractCropperInstanceProps<Settings, Instance>, onChange: () => void) {\n\t\tsuper();\n\t\tthis.props = props;\n\t\tthis.notify = onChange;\n\t\tthis.data = {\n\t\t\tstate: null,\n\t\t\ttransitions: false,\n\t\t\tinteractions: getEmptyInteractions(),\n\t\t};\n\t}\n\n\tprotected getProps() {\n\t\treturn this.props();\n\t}\n\n\tprotected setData(data: AbstractCropperInstanceData) {\n\t\tthis.data = data;\n\t\tthis.notify();\n\t}\n\n\tprotected getData(): AbstractCropperInstanceData {\n\t\treturn this.data;\n\t}\n}\n","import { useState } from 'react';\n\nexport function useForceRerender() {\n\tconst [tick, setTick] = useState({});\n\n\treturn () => {\n\t\tsetTick({});\n\t};\n}\n","import { useRef } from 'react';\nimport {\n\tImageRestriction,\n\tcreateDefaultSettings,\n\tAbstractCropperInstanceParameters,\n\tAbstractCropperInstanceCallbacks,\n\tAbstractCropperInstanceSettings,\n\tDefaultSettings,\n} from 'advanced-cropper';\nimport { CropperInstance } from '../instance/CropperInstance';\nimport { useForceRerender } from './useForceRerender';\nimport { usePersistentFunction } from './usePersistentFunction';\n\nexport type CropperInstanceSettings = DefaultSettings & AbstractCropperInstanceSettings;\n\nexport type CropperInstanceSettingsProp<Settings extends CropperInstanceSettings> = Partial<\n\tPick<Settings, keyof CropperInstanceSettings>\n> &\n\tOmit<Settings, keyof CropperInstanceSettings>;\n\nexport function useCropperInstance<Settings extends CropperInstanceSettings, Instance = unknown>(\n\tprops: () => AbstractCropperInstanceParameters<Settings> &\n\t\tAbstractCropperInstanceCallbacks<Instance> & {\n\t\t\tsettings?: CropperInstanceSettingsProp<Settings>;\n\t\t},\n) {\n\tconst rerender = useForceRerender();\n\n\tconst getProps = usePersistentFunction(() => {\n\t\tconst { settings, ...parameters } = props();\n\n\t\tconst extendedSettings = {\n\t\t\timageRestriction: ImageRestriction.fitArea,\n\t\t\ttransformImage: {\n\t\t\t\tadjustStencil: true,\n\t\t\t},\n\t\t\t...settings,\n\t\t};\n\n\t\tconst extendedParameters = {\n\t\t\ttransitions: true,\n\t\t\t...parameters,\n\t\t};\n\n\t\treturn {\n\t\t\tsettings: {\n\t\t\t\t...extendedSettings,\n\t\t\t\t...createDefaultSettings<Settings>(extendedSettings),\n\t\t\t\t// It's needed because of the nature of the settings field\n\t\t\t} as Settings,\n\t\t\t...extendedParameters,\n\t\t};\n\t});\n\n\tconst cropper = useRef(new CropperInstance<Settings, Instance>(getProps, rerender));\n\n\treturn cropper.current;\n}\nexport type CropperStateHook = ReturnType<typeof useCropperInstance>;\n","import { useRef } from 'react';\n\nexport function usePersistentFunction<Props, Arguments extends any[]>(props: (...args: Arguments) => Props) {\n\tconst propsRef = useRef(props);\n\n\tpropsRef.current = props;\n\n\treturn (...args: Arguments) => propsRef.current(...args);\n}\n","import { useEffect, useRef, useState } from 'react';\nimport { CropperImage, isUndefined, promiseTimeout, loadImage } from 'advanced-cropper';\nimport { useStateWithCallback } from \"./useStateWithCallback\";\n\nexport interface CropperImageHookSettings {\n\tsrc?: string | null;\n\tonLoadingStart?: () => void;\n\tonLoadingEnd?: () => void;\n\tonError?: () => void;\n\tonLoad?: (image?: CropperImage) => void;\n\tcrossOrigin?: 'anonymous' | 'use-credentials' | boolean;\n\tcheckOrientation?: boolean;\n\tcanvas?: string | boolean;\n\tunloadTime?: number;\n}\n\nexport function useCropperImage(options: CropperImageHookSettings) {\n\tconst { src, onLoadingStart, onLoadingEnd, onError, onLoad, crossOrigin, checkOrientation, canvas, unloadTime } = options;\n\tconst [image, setImage] = useState<CropperImage | null>(null);\n\tconst [loading, setLoading] = useState(false);\n\tconst [loaded, setLoaded] = useStateWithCallback(false);\n\n\tconst currentSrc = useRef<string | null>(null);\n\n\tuseEffect(() => {\n\t\tif (currentSrc.current !== src) {\n\t\t\tcurrentSrc.current = src || null;\n\t\t\tsetLoaded(false);\n\t\t\tif (src) {\n\t\t\t\tsetLoading(true);\n\t\t\t\tonLoadingStart?.();\n\t\t\t\tconst promises: Promise<unknown>[] = [\n\t\t\t\t\tloadImage(src, {\n\t\t\t\t\t\tcrossOrigin: isUndefined(crossOrigin) ? canvas : crossOrigin,\n\t\t\t\t\t\tcheckOrientation,\n\t\t\t\t\t}),\n\t\t\t\t];\n\n\t\t\t\tif (loaded && unloadTime) {\n\t\t\t\t\tpromises.push(promiseTimeout(unloadTime));\n\t\t\t\t}\n\t\t\t\tPromise.all(promises)\n\t\t\t\t\t.then((responses) => {\n\t\t\t\t\t\tconst [image] = responses as [CropperImage];\n\t\t\t\t\t\tif (currentSrc.current === src) {\n\t\t\t\t\t\t\tsetImage(image);\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t\t.catch(() => {\n\t\t\t\t\t\tif (currentSrc.current === src) {\n\t\t\t\t\t\t\tonError?.();\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t\t.finally(() => {\n\t\t\t\t\t\tif (currentSrc.current === src) {\n\t\t\t\t\t\t\tonLoadingEnd?.();\n\t\t\t\t\t\t\tsetLoading(false);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tif (unloadTime) {\n\t\t\t\t\t\tpromiseTimeout(unloadTime).then(() => {\n\t\t\t\t\t\t\tif (currentSrc.current === src) {\n\t\t\t\t\t\t\t\tsetImage(null)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t})\n\t\t\t\t} else {\n\t\t\t\t\t\tsetImage(null)\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}, [src, image]);\n\n\tuseEffect(() => {\n\t\tif (image) {\n\t\t\tsetLoaded(true, () => {\n\t\t\t\tonLoad?.(image);\n\t\t\t})\n\t\t}\n\t}, [image])\n\n\treturn {\n\t\tisLoading() {\n\t\t\treturn loading;\n\t\t},\n\t\tisLoaded() {\n\t\t\treturn loaded\n\t\t},\n\t\tgetImage() {\n\t\t\treturn image;\n\t\t},\n\t\tsetImage,\n\t};\n}\n","import { useEffect, useRef } from 'react';\n\nexport const useWindowResize = (callback: (...args: unknown[]) => void) => {\n\tconst callbackRef = useRef<Function>(callback);\n\n\tconst internalCallback = () => {\n\t\tif (callbackRef.current) {\n\t\t\tcallbackRef.current();\n\t\t}\n\t};\n\n\tuseEffect(() => {\n\t\tcallbackRef.current = callback;\n\t}, [callback]);\n\n\tuseEffect(() => {\n\t\twindow.addEventListener('resize', internalCallback);\n\t\twindow.addEventListener('orientationchange', internalCallback);\n\n\t\treturn () => {\n\t\t\twindow.removeEventListener('resize', internalCallback);\n\t\t\twindow.removeEventListener('orientationchange', internalCallback);\n\t\t};\n\t}, []);\n};\n","import { useImperativeHandle, useRef } from 'react';\nimport {\n\tAbstractCropperInstanceCallbacks,\n\tAbstractCropperInstanceParameters,\n\tCropperImage,\n\tDrawOptions,\n} from 'advanced-cropper';\nimport { StretchableBoundaryMethods } from '../components/service/StretchableBoundary';\nimport { CropperCanvasMethods } from '../components/service/CropperCanvas';\nimport { ExtendedSettings, SettingsExtension } from '../types';\nimport { AbstractCropperRef, AbstractCropperSettings } from '../components/AbstractCropper';\nimport { useStateWithCallback } from './useStateWithCallback';\nimport { CropperInstanceSettingsProp, useCropperInstance } from './useCropperInstance';\nimport { useCropperImage } from './useCropperImage';\nimport { useWindowResize } from './useWindowResize';\nimport { useUpdateEffect } from './useUpdateEffect';\nimport { useCropperAutoReconcile } from './useCropperAutoReconcile';\n\nexport interface AbstractCropperHookProps<Settings extends AbstractCropperSettings>\n\textends AbstractCropperInstanceParameters<Settings>,\n\t\tAbstractCropperInstanceCallbacks<AbstractCropperRef<Settings>> {\n\tsrc?: string | null;\n\tcheckOrientation?: boolean;\n\tcanvas?: boolean;\n\tcrossOrigin?: 'anonymous' | 'use-credentials' | boolean;\n\tonReady?: (cropper: AbstractCropperRef<Settings>) => void;\n\tonError?: (cropper: AbstractCropperRef<Settings>) => void;\n\tonUpdate?: (cropper: AbstractCropperRef<Settings>) => void;\n\tunloadTime?: number;\n\tautoReconcileState?: boolean;\n\tsettings?: CropperInstanceSettingsProp<Settings>;\n}\n\nexport function useAbstractCropper<Extension extends SettingsExtension = {}>(\n\tprops: () => AbstractCropperHookProps<ExtendedSettings<Extension>>,\n) {\n\tconst {\n\t\tsrc,\n\t\tonReady,\n\t\tonError,\n\t\tonUpdate,\n\t\tcanvas = true,\n\t\tunloadTime = 500,\n\t\tcrossOrigin = true,\n\t\tcheckOrientation = true,\n\t\tautoReconcileState = true,\n\t} = props();\n\n\tconst imageRef = useRef<HTMLElement>(null);\n\tconst boundaryRef = useRef<StretchableBoundaryMethods>(null);\n\tconst canvasRef = useRef<CropperCanvasMethods>(null);\n\tconst cropperRef = useRef<AbstractCropperRef<ExtendedSettings<Extension>>>(null);\n\n\tconst [currentImage, setCurrentImage] = useStateWithCallback<CropperImage | null>(null);\n\n\tconst cropper = useCropperInstance(() => ({\n\t\t...props(),\n\t\tgetInstance() {\n\t\t\treturn cropperRef.current;\n\t\t},\n\t}));\n\n\tconst cropperImage = useCropperImage({\n\t\tsrc,\n\t\tcrossOrigin,\n\t\tcheckOrientation,\n\t\tunloadTime,\n\t\tcanvas,\n\t\tonError() {\n\t\t\tif (cropperRef.current) {\n\t\t\t\tonError?.(cropperRef.current);\n\t\t\t}\n\t\t},\n\t});\n\n\tconst autoReconcile = useCropperAutoReconcile(cropper, autoReconcileState);\n\n\tconst resetCropper = async () => {\n\t\tif (boundaryRef.current) {\n\t\t\tautoReconcile.pause();\n\t\t\tconst image = cropperImage.getImage();\n\t\t\tconst boundary = await boundaryRef.current?.stretchTo(image);\n\t\t\tsetCurrentImage(image, () => {\n\t\t\t\tif (boundary && image) {\n\t\t\t\t\tcropper.reset(boundary, image);\n\t\t\t\t} else {\n\t\t\t\t\tcropper.clear();\n\t\t\t\t}\n\t\t\t});\n\t\t\tautoReconcile.resume();\n\t\t}\n\t};\n\n\tconst refreshCropper = async () => {\n\t\tif (boundaryRef.current) {\n\t\t\tautoReconcile.pause();\n\t\t\tconst image = cropperImage.getImage();\n\t\t\tconst boundary = await boundaryRef.current?.stretchTo(image);\n\t\t\tif (boundary && image) {\n\t\t\t\tconst state = cropper.getState();\n\t\t\t\tif (state) {\n\t\t\t\t\tif (boundary.width !== state.boundary.width || boundary.height !== state.boundary.height) {\n\t\t\t\t\t\tcropper.setBoundary(boundary);\n\t\t\t\t\t\t// It's important because, probably, after the boundary reset\n\t\t\t\t\t\t// the cropper can meet some restrictions that were broken before\n\t\t\t\t\t\tcropper.reconcileState();\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tcropper.reset(boundary, image);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tcropper.clear();\n\t\t\t}\n\t\t\tautoReconcile.resume();\n\t\t}\n\t};\n\tconst cropperInterface = {\n\t\treset: () => resetCropper(),\n\t\trefresh: () => refreshCropper(),\n\t\tsetImage: (image: CropperImage) => setCurrentImage(image),\n\t\treconcileState: cropper.reconcileState,\n\t\tmoveCoordinates: cropper.moveCoordinates,\n\t\tmoveCoordinatesEnd: cropper.moveCoordinatesEnd,\n\t\tresizeCoordinates: cropper.resizeCoordinates,\n\t\tclear: cropper.clear,\n\t\tresizeCoordinatesEnd: cropper.resizeCoordinatesEnd,\n\t\tmoveImage: cropper.moveImage,\n\t\tflipImage: cropper.flipImage,\n\t\tzoomImage: cropper.zoomImage,\n\t\trotateImage: cropper.rotateImage,\n\t\ttransformImage: cropper.transformImage,\n\t\ttransformImageEnd: cropper.transformImageEnd,\n\t\tsetCoordinates: cropper.setCoordinates,\n\t\tsetVisibleArea: cropper.setVisibleArea,\n\t\tstartTransitions: cropper.startTransitions,\n\t\tsetState: cropper.setState,\n\t\thasInteractions: cropper.hasInteractions,\n\t\tgetStencilCoordinates: cropper.getStencilCoordinates,\n\t\tgetCoordinates: cropper.getCoordinates,\n\t\tgetVisibleArea: cropper.getVisibleArea,\n\t\tgetTransforms: cropper.getTransforms,\n\t\tgetTransitions: cropper.getTransitions,\n\t\tgetInteractions: cropper.getInteractions,\n\t\tgetSettings: cropper.getSettings,\n\t\tgetState: cropper.getState,\n\t\tgetDefaultState() {\n\t\t\tconst state = cropper.getState();\n\t\t\tconst image = cropperImage.getImage();\n\t\t\tif (state && image) {\n\t\t\t\treturn cropper.createDefaultState(state.boundary, image);\n\t\t\t} else {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t},\n\t\tgetCanvas: (options?: DrawOptions) => {\n\t\t\tconst state = cropper.getState();\n\t\t\tif (imageRef.current && canvasRef.current && state) {\n\t\t\t\treturn canvasRef.current.draw(state, imageRef.current, options);\n\t\t\t} else {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t},\n\t\tgetImage: () => {\n\t\t\treturn currentImage ? { ...currentImage } : null;\n\t\t},\n\t\tisLoading: cropperImage.isLoading,\n\t\tisLoaded: cropperImage.isLoaded,\n\t};\n\n\tuseWindowResize(() => {\n\t\trefreshCropper();\n\t});\n\n\tuseUpdateEffect(() => {\n\t\tresetCropper();\n\t}, [cropperImage.getImage()]);\n\n\tuseUpdateEffect(() => {\n\t\tif (cropperRef.current && currentImage) {\n\t\t\tonReady?.(cropperRef.current);\n\t\t}\n\t}, [currentImage])\n\n\tuseUpdateEffect(() => {\n\t\tif (cropperRef.current) {\n\t\t\tonUpdate?.(cropperRef.current);\n\t\t}\n\t}, [cropperImage.isLoaded(), cropperImage.isLoading()]);\n\n\tuseImperativeHandle(cropperRef, () => cropperInterface);\n\n\treturn {\n\t\tcropper: cropperInterface,\n\t\trefs: {\n\t\t\timage: imageRef,\n\t\t\tboundary: boundaryRef,\n\t\t\tcanvas: canvasRef,\n\t\t},\n\t\timage: currentImage,\n\t};\n}\n","import { useLayoutEffect, useState } from 'react';\n\ninterface CropperInstance {\n\thasInteractions: () => boolean;\n\treconcileState: () => void;\n}\n\nexport function useCropperAutoReconcile(cropper: CropperInstance, enabled = true) {\n\tconst [active, setActive] = useState(enabled);\n\n\tuseLayoutEffect(() => {\n\t\tif (active && !cropper.hasInteractions()) {\n\t\t\tcropper.reconcileState();\n\t\t}\n\t});\n\n\treturn {\n\t\tpause() {\n\t\t\tsetActive(false);\n\t\t},\n\t\tresume() {\n\t\t\tsetActive(true);\n\t\t},\n\t};\n}\n","import React, { ReactNode, forwardRef, useImperativeHandle, useRef, CSSProperties } from 'react';\nimport cn from 'classnames';\nimport {\n\tBoundarySizeAlgorithm,\n\tSize,\n\tstretchCropperBoundary,\n\tBoundaryStretchAlgorithm,\n\tfillBoundary,\n} from 'advanced-cropper';\n\ninterface Props {\n\tclassName?: string;\n\tstyle?: CSSProperties;\n\tstretcherClassName?: string;\n\tcontentClassName?: string;\n\tstretchAlgorithm?: BoundaryStretchAlgorithm;\n\tsizeAlgorithm?: BoundarySizeAlgorithm;\n\tchildren?: ReactNode;\n}\n\nexport interface StretchableBoundaryMethods {\n\tstretchTo: (size: Size | null) => Promise<Size | null>;\n\treset: () => void;\n}\n\nexport const StretchableBoundary = forwardRef(\n\t(\n\t\t{\n\t\t\tclassName,\n\t\t\tstyle,\n\t\t\tstretcherClassName,\n\t\t\tcontentClassName,\n\t\t\tstretchAlgorithm = stretchCropperBoundary,\n\t\t\tsizeAlgorithm = fillBoundary,\n\t\t\tchildren,\n\t\t}: Props,\n\t\tref,\n\t) => {\n\t\tconst stretcherRef = useRef<HTMLDivElement>(null);\n\t\tconst boundaryRef = useRef<HTMLDivElement>(null);\n\n\t\tuseImperativeHandle(ref, () => ({\n\t\t\treset: () => {\n\t\t\t\tconst stretcher = stretcherRef.current;\n\t\t\t\tif (stretcher) {\n\t\t\t\t\tstretcher.style.height = '';\n\t\t\t\t\tstretcher.style.width = '';\n\t\t\t\t}\n\t\t\t},\n\t\t\tstretchTo: (size: Size | null) => {\n\t\t\t\tconst stretcher = stretcherRef.current;\n\t\t\t\tconst boundary = boundaryRef.current;\n\n\t\t\t\tif (size?.width && size?.height && stretcher && boundary) {\n\t\t\t\t\tstretchAlgorithm(boundary, stretcher, size);\n\t\t\t\t\tconst result = sizeAlgorithm(boundary, size);\n\t\t\t\t\treturn Promise.resolve(result.width && result.height ? result : null);\n\t\t\t\t} else {\n\t\t\t\t\tif (stretcher) {\n\t\t\t\t\t\tstretcher.style.height = '';\n\t\t\t\t\t\tstretcher.style.width = '';\n\t\t\t\t\t}\n\t\t\t\t\treturn Promise.resolve(null);\n\t\t\t\t}\n\t\t\t},\n\t\t}));\n\n\t\treturn (\n\t\t\t<div ref={boundaryRef} style={style} className={cn('advanced-cropper-boundary', className)}>\n\t\t\t\t<div ref={stretcherRef} className={cn(['advanced-cropper-boundary__stretcher', stretcherClassName])} />\n\t\t\t\t<div className={cn(['advanced-cropper-boundary__content', contentClassName])}>{children}</div>\n\t\t\t</div>\n\t\t);\n\t},\n);\n\nStretchableBoundary.displayName = 'StretchableBoundary';\n","import React, { CSSProperties, FC, ReactNode } from 'react';\nimport cn from 'classnames';\n\ninterface Props {\n\tvisible?: unknown;\n\tclassName?: string;\n\tstyle?: CSSProperties;\n\tchildren?: ReactNode;\n}\n\nexport const CropperFade: FC<Props> = ({ visible, className, style, children }) => {\n\treturn (\n\t\t<div\n\t\t\tstyle={style}\n\t\t\tclassName={cn(className, 'advanced-cropper-fade', Boolean(visible) && 'advanced-cropper-fade--visible')}\n\t\t>\n\t\t\t{children}\n\t\t</div>\n\t);\n};\n","import React, { CSSProperties, FC, ReactNode } from 'react';\nimport cn from 'classnames';\nimport { CropperState } from 'advanced-cropper';\nimport { CropperFade } from './CropperFade';\n\ninterface DesiredCropperRef {\n\tgetState: () => CropperState | null;\n\tisLoading: () => boolean;\n\tisLoaded: () => boolean;\n}\n\nexport interface CropperWrapperProps {\n\tcropper?: DesiredCropperRef;\n\tclassName?: string;\n\tstyle?: CSSProperties;\n\tchildren?: ReactNode;\n\tdisabled?: boolean;\n}\n\nexport const CropperWrapper: FC<CropperWrapperProps> = ({ cropper, children, className, style }) => {\n\tconst state = cropper ? cropper.getState() : null;\n\tconst loaded = cropper ? cropper.isLoaded() : false;\n\treturn (\n\t\t<div className={cn(className, 'advanced-cropper-wrapper')} style={style}>\n\t\t\t<CropperFade visible={state && loaded} className={'advanced-cropper-wrapper__fade'}>\n\t\t\t\t{children}\n\t\t\t</CropperFade>\n\t\t</div>\n\t);\n};\n","import { MouseEvent } from 'react';\n\nexport function preventDefault(e: MouseEvent) {\n\te.preventDefault();\n}\n","import React, { CSSProperties, forwardRef } from 'react';\nimport cn from 'classnames';\nimport { CropperTransitions, CropperImage, CropperState, getBackgroundStyle } from 'advanced-cropper';\nimport { preventDefault } from '../../service/events';\n\ninterface DesiredCropperRef {\n\tgetState: () => CropperState | null;\n\tgetTransitions: () => CropperTransitions;\n\tgetImage: () => CropperImage | null;\n}\n\nexport interface CropperBackgroundImageProps {\n\tclassName?: string;\n\tcropper: DesiredCropperRef;\n\tcrossOrigin?: 'anonymous' | 'use-credentials' | boolean;\n\tstyle?: CSSProperties;\n}\n\nexport const CropperBackgroundImage = forwardRef<HTMLImageElement, CropperBackgroundImageProps>(\n\t({ className, style, cropper, crossOrigin = true }: CropperBackgroundImageProps, ref) => {\n\t\tconst state = cropper.getState();\n\t\tconst transitions = cropper.getTransitions();\n\t\tconst image = cropper.getImage();\n\n\t\tconst transformStyles = image && state ? getBackgroundStyle(image, state, transitions) : {};\n\n\t\tconst src = image ? image.src : undefined;\n\n\t\treturn src ? (\n\t\t\t<img\n\t\t\t\tkey={src}\n\t\t\t\tref={ref}\n\t\t\t\tclassName={cn('advanced-cropper-background-image', className)}\n\t\t\t\tsrc={src}\n\t\t\t\tcrossOrigin={crossOrigin === true ? 'anonymous' : crossOrigin || undefined}\n\t\t\t\tstyle={{\n\t\t\t\t\t...transformStyles,\n\t\t\t\t\t...style,\n\t\t\t\t}}\n\t\t\t\tonMouseDown={preventDefault}\n\t\t\t/>\n\t\t) : null;\n\t},\n);\n\nCropperBackgroundImage.displayName = 'CropperBackgroundImage';\n","import React, { forwardRef, useImperativeHandle, useRef } from 'react';\nimport { CropperState, DrawOptions, drawCroppedArea } from 'advanced-cropper';\n\nexport interface CropperCanvasMethods {\n\tdraw: (state: CropperState, image: HTMLElement, options?: DrawOptions) => HTMLCanvasElement | null;\n}\n\nexport const CropperCanvas = forwardRef((_, ref) => {\n\tconst canvasRef = useRef<HTMLCanvasElement>(null);\n\tconst spareCanvasRef = useRef<HTMLCanvasElement>(null);\n\n\tuseImperativeHandle(ref, () => ({\n\t\tdraw: (state: CropperState, image: HTMLElement, options: DrawOptions = {}) => {\n\t\t\tif (image && canvasRef.current && spareCanvasRef.current) {\n\t\t\t\treturn drawCroppedArea(\n\t\t\t\t\tstate,\n\t\t\t\t\timage as HTMLImageElement | HTMLCanvasElement,\n\t\t\t\t\tcanvasRef.current,\n\t\t\t\t\tspareCanvasRef.current,\n\t\t\t\t\toptions,\n\t\t\t\t);\n\t\t\t} else {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t},\n\t}));\n\n\treturn (\n\t\t<>\n\t\t\t<canvas className=\"advanced-cropper-canvas\" ref={canvasRef} />\n\t\t\t<canvas className=\"advanced-cropper-canvas\" ref={spareCanvasRef} />\n\t\t</>\n\t);\n});\n\nCropperCanvas.displayName = 'CropperCanvas';\n","import React, { ReactNode, Component, RefObject, createRef } from 'react';\nimport cn from 'classnames';\nimport { MoveDirections, Point, SimpleTouch, distance } from 'advanced-cropper';\n\ninterface Props {\n\tclassName?: string;\n\tchildren?: ReactNode;\n\tdisabled?: boolean;\n\tonMove?: (directions: MoveDirections, nativeEvent: MouseEvent | TouchEvent) => void;\n\tonMoveEnd?: () => void;\n\tonMoveStart?: () => void;\n\tonLeave?: () => void;\n\tonEnter?: () => void;\n\tuseAnchor?: boolean;\n\tactivationDistance?: number;\n}\n\nexport class DraggableElement extends Component<Props> {\n\ttouches: SimpleTouch[];\n\tstarted: boolean;\n\thovered: boolean;\n\tanchor: Point;\n\tcontainer: RefObject<HTMLDivElement>;\n\n\tstatic defaultProps = {\n\t\tdisabled: false,\n\t\tactivationDistance: 30,\n\t\tuseAnchor: true,\n\t\trerender: true,\n\t};\n\n\tconstructor(props: Props) {\n\t\tsuper(props);\n\n\t\tthis.touches = [];\n\t\tthis.hovered = false;\n\t\tthis.started = false;\n\t\tthis.anchor = {\n\t\t\tleft: 0,\n\t\t\ttop: 0,\n\t\t};\n\t\tthis.container = createRef();\n\t}\n\n\tprocessMove = (e: MouseEvent | TouchEvent, newTouches: SimpleTouch[]) => {\n\t\tconst container = this.container.current;\n\n\t\tif (container && this.touches.length) {\n\t\t\tconst { left, top } = container.getBoundingClientRect();\n\t\t\tif (this.touches.length === 1 && newTouches.length === 1) {\n\t\t\t\tif (this.props.onMove) {\n\t\t\t\t\tconst movingToAnchor = {\n\t\t\t\t\t\tleft:\n\t\t\t\t\t\t\tMath.abs(newTouches[0].clientX - this.anchor.left - left) <\n\t\t\t\t\t\t\tMath.abs(this.touches[0].clientX - this.anchor.left - left),\n\t\t\t\t\t\ttop:\n\t\t\t\t\t\t\tMath.abs(newTouches[0].clientY - this.anchor.top - top) <\n\t\t\t\t\t\t\tMath.abs(this.touches[0].clientY - this.anchor.top - top),\n\t\t\t\t\t};\n\n\t\t\t\t\tconst direction = {\n\t\t\t\t\t\tleft: 0,\n\t\t\t\t\t\ttop: 0,\n\t\t\t\t\t};\n\n\t\t\t\t\tif (!this.props.useAnchor || !movingToAnchor.left) {\n\t\t\t\t\t\tdirection.left = newTouches[0].clientX - this.touches[0].clientX;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (!this.props.useAnchor || !movingToAnchor.top) {\n\t\t\t\t\t\tdirection.top = newTouches[0].clientY - this.touches[0].clientY;\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.props?.onMove(direction, e);\n\n\t\t\t\t\tthis.touches = [...newTouches];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t};\n\n\tprocessEnd = () => {\n\t\tconst { onMoveEnd, onLeave } = this.props;\n\t\tif (!this.props.disabled && this.touches.length) {\n\t\t\tonMoveEnd?.();\n\t\t}\n\t\tif (this.hovered) {\n\t\t\tonLeave?.();\n\t\t\tthis.hovered = false;\n\t\t}\n\t\tthis.touches = [];\n\t};\n\n\tinitAnchor = (touch: SimpleTouch) => {\n\t\tconst container = this.container.current;\n\t\tif (container) {\n\t\t\tconst { left, top } = container.getBoundingClientRect();\n\t\t\tthis.anchor = {\n\t\t\t\tleft: touch.clientX - left,\n\t\t\t\ttop: touch.clientY - top,\n\t\t\t};\n\t\t}\n\t};\n\n\tonMouseOver = () => {\n\t\tconst { onEnter, disabled } = this.props;\n\t\tif (!this.hovered && !disabled) {\n\t\t\tthis.hovered = true;\n\t\t\tonEnter?.();\n\t\t}\n\t};\n\n\tonMouseLeave = () => {\n\t\tconst { onLeave } = this.props;\n\t\tif (this.hovered && !this.touches.length) {\n\t\t\tthis.hovered = false;\n\t\t\tonLeave?.();\n\t\t}\n\t};\n\n\tonTouchStart = (e: TouchEvent) => {\n\t\tconst { onEnter, onMoveStart, disabled } = this.props;\n\t\tif (e.cancelable) {\n\t\t\tthis.touches = Array.from(e.touches);\n\n\t\t\tconst shouldStartMove = !disabled && e.touches.length === 1;\n\t\t\tif (shouldStartMove) {\n\t\t\t\tthis.touches = Array.from(e.touches);\n\t\t\t\tonMoveStart?.();\n\t\t\t}\n\n\t\t\tif (!this.hovered && !disabled) {\n\t\t\t\tthis.hovered = true;\n\t\t\t\tonEnter?.();\n\t\t\t}\n\n\t\t\tif (this.started || shouldStartMove) {\n\t\t\t\te.preventDefault();\n\t\t\t\te.stopPropagation();\n\t\t\t}\n\t\t}\n\t};\n\n\tonTouchEnd = () => {\n\t\tthis.started = false;\n\t\tthis.processEnd();\n\t};\n\n\tonTouchMove = (e: TouchEvent) => {\n\t\tif (this.touches.length >= 1) {\n\t\t\tif (this.started) {\n\t\t\t\tthis.processMove(e, Array.from(e.touches));\n\t\t\t\te.preventDefault();\n\t\t\t\te.stopPropagation();\n\t\t\t} else if (\n\t\t\t\tdistance(\n\t\t\t\t\t{ left: this.touches[0].clientX, top: this.touches[0].clientY },\n\t\t\t\t\t{ left: e.touches[0].clientX, top: e.touches[0].clientY },\n\t\t\t\t) > (this.props.activationDistance || 0)\n\t\t\t) {\n\t\t\t\tthis.initAnchor({\n\t\t\t\t\tclientX: e.touches[0].clientX,\n\t\t\t\t\tclientY: e.touches[0].clientY,\n\t\t\t\t});\n\t\t\t\tthis.started = true;\n\t\t\t}\n\t\t}\n\t};\n\n\tonMouseDown = (e: MouseEvent) => {\n\t\tconst { onMoveStart, disabled } = this.props;\n\t\tif (!disabled && e.button === 0) {\n\t\t\tconst touch = {\n\t\t\t\tclientX: e.clientX,\n\t\t\t\tclientY: e.clientY,\n\t\t\t};\n\t\t\tthis.touches = [touch];\n\t\t\tthis.initAnchor(touch);\n\t\t\te.stopPropagation();\n\t\t\tonMoveStart?.();\n\t\t}\n\t};\n\n\tonMouseMove = (e: MouseEvent) => {\n\t\tif (!this.props.disabled && this.touches.length) {\n\t\t\tthis.processMove(e, [\n\t\t\t\t{\n\t\t\t\t\tclientX: e.clientX,\n\t\t\t\t\tclientY: e.clientY,\n\t\t\t\t},\n\t\t\t]);\n\t\t\tif (e.preventDefault && e.cancelable) {\n\t\t\t\te.preventDefault();\n\t\t\t}\n\t\t\te.stopPropagation();\n\t\t}\n\t};\n\n\tonMouseUp = () => {\n\t\tthis.processEnd();\n\t};\n\n\tcomponentWillUnmount() {\n\t\twindow.removeEventListener('mouseup', this.onMouseUp);\n\t\twindow.removeEventListener('mousemove', this.onMouseMove);\n\t\twindow.removeEventListener('touchmove', this.onTouchMove);\n\t\twindow.removeEventListener('touchend', this.onTouchEnd);\n\t\tconst container = this.container.current;\n\t\tif (container) {\n\t\t\tcontainer.removeEventListener('touchstart', this.onTouchStart);\n\t\t\tcontainer.removeEventListener('mousedown', this.onMouseDown);\n\t\t}\n\t}\n\n\tcomponentDidMount() {\n\t\twindow.addEventListener('mouseup', this.onMouseUp, { passive: false });\n\t\twindow.addEventListener('mousemove', this.onMouseMove, { passive: false });\n\t\twindow.addEventListener('touchmove', this.onTouchMove, { passive: false });\n\t\twindow.addEventListener('touchend', this.onTouchEnd, { passive: false });\n\n\t\tconst container = this.container.current;\n\t\tif (container) {\n\t\t\t// Add event listeners here due to https://github.com/facebook/react/issues/9809#issuecomment-414072263\n\t\t\tcontainer.addEventListener('touchstart', this.onTouchStart, {\n\t\t\t\tpassive: false,\n\t\t\t});\n\t\t\tcontainer.addEventListener('mousedown', this.onMouseDown, {\n\t\t\t\tpassive: false,\n\t\t\t});\n\t\t}\n\t}\n\n\tcomponentDidUpdate(prevProps: Readonly<Props>) {\n\t\tif (this.props.disabled && !prevProps.disabled) {\n\t\t\tthis.touches = [];\n\t\t}\n\t}\n\n\trender() {\n\t\tconst { children, className } = this.props;\n\t\treturn (\n\t\t\t<div\n\t\t\t\tclassName={cn('advanced-cropper-draggable-element', className)}\n\t\t\t\tref={this.container}\n\t\t\t\tonMouseOver={this.onMouseOver}\n\t\t\t\tonMouseLeave={this.onMouseLeave}\n\t\t\t>\n\t\t\t\t{children}\n\t\t\t</div>\n\t\t);\n\t}\n}\n","import React, { ReactNode } from 'react';\nimport cn from 'classnames';\nimport { HorizontalCardinalDirection, MoveDirections, VerticalCardinalDirection } from 'advanced-cropper';\nimport { DraggableElement } from './DraggableElement';\n\ninterface Props {\n\tclassName?: string;\n\tchildren?: ReactNode;\n\tonDrag?: (directions: MoveDirections, event: TouchEvent | MouseEvent) => void;\n\tonDragEnd?: () => void;\n\tonLeave?: () => void;\n\tonEnter?: () => void;\n\tdisabled?: boolean;\n\tposition?: HorizontalCardinalDirection | VerticalCardinalDirection;\n}\n\nexport const LineWrapper = ({\n\tposition,\n\tclassName,\n\tdisabled,\n\tonDrag,\n\tonDragEnd,\n\tonLeave,\n\tonEnter,\n\tchildren,\n}: Props) => {\n\treturn (\n\t\t<DraggableElement\n\t\t\tclassName={cn([\n\t\t\t\t'advanced-cropper-line-wrapper',\n\t\t\t\tposition && `advanced-cropper-line-wrapper--${position}`,\n\t\t\t\tdisabled && `advanced-cropper-line-wrapper--disabled`,\n\t\t\t\tclassName,\n\t\t\t])}\n\t\t\tdisabled={disabled}\n\t\t\tonMove={onDrag}\n\t\t\tonMoveEnd={onDragEnd}\n\t\t\tonLeave={onLeave}\n\t\t\tonEnter={onEnter}\n\t\t\tactivationDistance={0}\n\t\t>\n\t\t\t<div\n\t\t\t\tclassName={cn([\n\t\t\t\t\t'advanced-cropper-line-wrapper__content',\n\t\t\t\t\tposition && `advanced-cropper-line-wrapper__content--${position}`,\n\t\t\t\t])}\n\t\t\t>\n\t\t\t\t{children}\n\t\t\t</div>\n\t\t</DraggableElement>\n\t);\n};\n","import React, { useState } from 'react';\nimport cn from 'classnames';\nimport { CardinalDirection, MoveDirections } from 'advanced-cropper';\nimport { LineWrapper } from '../service/LineWrapper';\n\ninterface Props {\n\tdefaultClassName?: string;\n\thoverClassName?: string;\n\twrapperClassName?: string;\n\tposition?: CardinalDirection;\n\tdisabled?: boolean;\n\tonMove?: (directions: MoveDirections, event: TouchEvent | MouseEvent) => void;\n\tonMoveEnd?: () => void;\n}\n\nexport const SimpleLine = ({\n\tposition,\n\thoverClassName,\n\twrapperClassName,\n\tdefaultClassName,\n\tdisabled,\n\tonMove,\n\tonMoveEnd,\n}: Props) => {\n\tconst [hover, setHover] = useState(false);\n\n\tconst onEnter = () => {\n\t\tsetHover(true);\n\t};\n\n\tconst onLeave = () => {\n\t\tsetHover(false);\n\t};\n\n\treturn (\n\t\t<LineWrapper\n\t\t\tclassName={cn('advanced-cropper-simple-line-wrapper', wrapperClassName, {\n\t\t\t\t[`advanced-cropper-simple-line-wrapper--${position}`]: !!position,\n\t\t\t})}\n\t\t\tposition={position}\n\t\t\tdisabled={disabled}\n\t\t\tonDrag={onMove}\n\t\t\tonDragEnd={onMoveEnd}\n\t\t\tonLeave={onLeave}\n\t\t\tonEnter={onEnter}\n\t\t>\n\t\t\t<div\n\t\t\t\tclassName={cn(\n\t\t\t\t\t'advanced-cropper-simple-line',\n\t\t\t\t\thover && 'advanced-cropper-simple-line--hover',\n\t\t\t\t\tdefaultClassName,\n\t\t\t\t\thover && hoverClassName,\n\t\t\t\t\t{\n\t\t\t\t\t\t[`advanced-cropper-simple-line--${position}`]: !!position,\n\t\t\t\t\t},\n\t\t\t\t)}\n\t\t\t/>\n\t\t</LineWrapper>\n\t);\n};\n","import React, { CSSProperties, ReactNode } from 'react';\nimport classnames from 'classnames';\nimport {\n\tHorizontalCardinalDirection,\n\tMoveDirections,\n\tVerticalCardinalDirection,\n\tgetDirectionNames,\n} from 'advanced-cropper';\nimport { DraggableElement } from './DraggableElement';\n\ninterface Props {\n\tclassName?: string;\n\tstyle?: CSSProperties;\n\tchildren?: ReactNode;\n\tonDrag?: (shift: MoveDirections, event: MouseEvent | TouchEvent) => void;\n\tonDragEnd?: () => void;\n\tonLeave?: () => void;\n\tonEnter?: () => void;\n\tdisabled?: boolean;\n\thorizontalPosition?: HorizontalCardinalDirection;\n\tverticalPosition?: VerticalCardinalDirection;\n}\n\nexport const HandlerWrapper = ({\n\thorizontalPosition,\n\tverticalPosition,\n\tclassName,\n\tdisabled,\n\tonDrag,\n\tonDragEnd,\n\tonLeave,\n\tonEnter,\n\tchildren,\n\tstyle,\n}: Props) => {\n\tconst position =\n\t\thorizontalPosition || verticalPosition\n\t\t\t? getDirectionNames(horizontalPosition, verticalPosition).snakeCase\n\t\t\t: null;\n\n\treturn (\n\t\t<div\n\t\t\tstyle={style}\n\t\t\tclassName={classnames(\n\t\t\t\tclassName,\n\t\t\t\t'advanced-cropper-handler-wrapper',\n\t\t\t\tposition && `advanced-cropper-handler-wrapper--${position}`,\n\t\t\t\tdisabled && 'advanced-cropper-handler-wrapper--disabled',\n\t\t\t)}\n\t\t>\n\t\t\t<DraggableElement\n\t\t\t\tclassName={'advanced-cropper-handler-wrapper__draggable'}\n\t\t\t\tdisabled={disabled}\n\t\t\t\tonMove={onDrag}\n\t\t\t\tonMoveEnd={onDragEnd}\n\t\t\t\tonLeave={onLeave}\n\t\t\t\tonEnter={onEnter}\n\t\t\t\tactivationDistance={0}\n\t\t\t>\n\t\t\t\t{children}\n\t\t\t</DraggableElement>\n\t\t</div>\n\t);\n};\n","import React, { CSSProperties, useState } from 'react';\nimport cn from 'classnames';\nimport { HorizontalCardinalDirection, MoveDirections, VerticalCardinalDirection } from 'advanced-cropper';\nimport { HandlerWrapper } from '../service/HandlerWrapper';\n\ninterface Props {\n\tdefaultClassName?: string;\n\thoverClassName?: string;\n\twrapperClassName?: string;\n\twrapperStyle?: CSSProperties;\n\tverticalPosition?: VerticalCardinalDirection;\n\thorizontalPosition?: HorizontalCardinalDirection;\n\tdisabled?: boolean;\n\tonMove?: (shift: MoveDirections, event: TouchEvent | MouseEvent) => void;\n\tonMoveEnd?: () => void;\n}\n\nexport const SimpleHandler = ({\n\tverticalPosition,\n\thorizontalPosition,\n\thoverClassName,\n\twrapperClassName,\n\tdefaultClassName,\n\twrapperStyle,\n\tdisabled,\n\tonMove,\n\tonMoveEnd,\n}: Props) => {\n\tconst [hover, setHover] = useState(false);\n\n\tconst onEnter = () => {\n\t\tsetHover(true);\n\t};\n\n\tconst onLeave = () => {\n\t\tsetHover(false);\n\t};\n\n\treturn (\n\t\t<HandlerWrapper\n\t\t\tstyle={wrapperStyle}\n\t\t\tclassName={cn(\n\t\t\t\t'advanced-cropper-simple-handler-wrapper',\n\t\t\t\twrapperClassName,\n\t\t\t\tverticalPosition && `advanced-cropper-simple-handler-wrapper--${verticalPosition}`,\n\t\t\t\thorizontalPosition && `advanced-cropper-simple-handler-wrapper--${horizontalPosition}`,\n\t\t\t\thorizontalPosition &&\n\t\t\t\t\tverticalPosition &&\n\t\t\t\t\t`advanced-cropper-simple-handler-wrapper--${horizontalPosition}-${verticalPosition}`,\n\t\t\t\thover && 'advanced-cropper-simple-handler-wrapper--hover',\n\t\t\t)}\n\t\t\tverticalPosition={verticalPosition}\n\t\t\thorizontalPosition={horizontalPosition}\n\t\t\tdisabled={disabled}\n\t\t\tonDrag={onMove}\n\t\t\tonDragEnd={onMoveEnd}\n\t\t\tonLeave={onLeave}\n\t\t\tonEnter={onEnter}\n\t\t>\n\t\t\t<div\n\t\t\t\tclassName={cn(\n\t\t\t\t\t'advanced-cropper-simple-handler',\n\t\t\t\t\thover && 'advanced-cropper-simple-handler--hover',\n\t\t\t\t\tdefaultClassName,\n\t\t\t\t\thover && hoverClassName,\n\t\t\t\t\t{\n\t\t\t\t\t\t[`advanced-cropper-simple-handler--${verticalPosition}`]: !!verticalPosition,\n\t\t\t\t\t\t[`advanced-cropper-simple-handler--${horizontalPosition}`]: !!horizontalPosition,\n\t\t\t\t\t\t[`advanced-cropper-simple-handler--${horizontalPosition}-${verticalPosition}`]:\n\t\t\t\t\t\t\thorizontalPosition && verticalPosition,\n\t\t\t\t\t},\n\t\t\t\t)}\n\t\t\t/>\n\t\t</HandlerWrapper>\n\t);\n};\n","import React, { useMemo, ReactNode, CSSProperties, useState, FC } from 'react';\nimport cn from 'classnames';\nimport {\n\tCardinalDirection,\n\tOrdinalDirection,\n\tHorizontalCardinalDirection,\n\tVerticalCardinalDirection,\n\tMoveDirections,\n\tResizeOptions,\n\tgetDirectionNames,\n\tisCardinalDirection,\n\tisObject,\n\tCoordinates,\n\tResizeAnchor,\n} from 'advanced-cropper';\nimport { SimpleLine } from '../lines/SimpleLine';\nimport { SimpleHandler } from '../handlers/SimpleHandler';\n\nconst HORIZONTAL_DIRECTIONS = ['east', 'west', null] as const;\nconst VERTICAL_DIRECTIONS = ['south', 'north', null] as const;\n\ntype HandlerComponent = FC<any>;\n\ntype LineComponent = FC<any>;\n\ninterface HandlerClassNames extends Partial<Record<OrdinalDirection, string>> {\n\tdefault?: string;\n\tdisabled?: string;\n\thover?: string;\n}\n\ninterface LineClassNames extends Partial<Record<CardinalDirection, string>> {\n\tdefault?: string;\n\tdisabled?: string;\n\thover?: string;\n}\n\ninterface Props {\n\tstyle?: CSSProperties;\n\tclassName?: string;\n\thandlerComponent?: HandlerComponent;\n\thandlers?: boolean | Partial<Record<OrdinalDirection, boolean>>;\n\thandlerClassNames?: HandlerClassNames;\n\thandlerWrapperClassNames?: HandlerClassNames;\n\tlines?: boolean | Partial<Record<CardinalDirection, boolean>>;\n\tlineComponent?: LineComponent;\n\tlineClassNames?: LineClassNames;\n\tlineWrapperClassNames?: LineClassNames;\n\tdisabled?: boolean;\n\tonResize?: (anchor: ResizeAnchor, directions: MoveDirections, options: ResizeOptions) => void;\n\tonResizeEnd?: () => void;\n\tchildren?: ReactNode;\n\treference?: Coordinates | null;\n}\n\ninterface HandlerNode {\n\tname: OrdinalDirection;\n\tcomponent: HandlerComponent;\n\tclassName: string;\n\twrapperClassName?: string;\n\tcontainerClassName?: string;\n\thoverClassName?: string;\n\tstyle?: CSSProperties;\n\tverticalPosition: VerticalCardinalDirection | null;\n\thorizontalPosition: HorizontalCardinalDirection | null;\n\tdisabled: boolean;\n}\n\ninterface LineNode {\n\tname: CardinalDirection;\n\tcomponent: LineComponent;\n\tclassName: string;\n\twrapperClassName?: string;\n\thoverClassName?: string;\n\tstyle?: CSSProperties;\n\tverticalPosition: VerticalCardinalDirection | null;\n\thorizontalPosition: HorizontalCardinalDirection | null;\n\tdisabled: boolean;\n}\n\ninterface PointNode {\n\tname: OrdinalDirection;\n\tclassName: string;\n\tverticalPosition: VerticalCardinalDirection | null;\n\thorizontalPosition: HorizontalCardinalDirection | null;\n}\n\nexport const BoundingBox = ({\n\tstyle,\n\tclassName,\n\tchildren,\n\tonResize,\n\tonResizeEnd,\n\thandlerComponent = SimpleHandler,\n\thandlers = {\n\t\teastNorth: true,\n\t\tnorth: true,\n\t\twestNorth: true,\n\t\twest: true,\n\t\twestSouth: true,\n\t\tsouth: true,\n\t\teastSouth: true,\n\t\teast: true,\n\t},\n\thandlerClassNames = {},\n\thandlerWrapperClassNames = {},\n\tlines = {\n\t\twest: true,\n\t\tnorth: true,\n\t\teast: true,\n\t\tsouth: true,\n\t},\n\tlineComponent = SimpleLine,\n\tlineClassNames = {},\n\tlineWrapperClassNames = {},\n\tdisabled = false,\n\treference = null,\n}: Props) => {\n\tconst [lastReference, setLastReference] = useState<Coordinates | null>(null);\n\n\tconst points = useMemo(() => {\n\t\tconst result: PointNode[] = [];\n\t\tHORIZONTAL_DIRECTIONS.forEach((hDirection) => {\n\t\t\tVERTICAL_DIRECTIONS.forEach((vDirection) => {\n\t\t\t\tif (hDirection !== vDirection) {\n\t\t\t\t\tlet { snakeCase, camelCase } = getDirectionNames(hDirection, vDirection);\n\t\t\t\t\tif (snakeCase && camelCase) {\n\t\t\t\t\t\tresult.push({\n\t\t\t\t\t\t\tname: camelCase,\n\t\t\t\t\t\t\tclassName: snakeCase,\n\t\t\t\t\t\t\tverticalPosition: vDirection,\n\t\t\t\t\t\t\thorizontalPosition: hDirection,\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t\treturn result;\n\t}, []);\n\n\tconst lineNodes = useMemo(() => {\n\t\tconst result: LineNode[] = [];\n\t\tpoints.forEach((point) => {\n\t\t\tif (isCardinalDirection(point.name) && (isObject(lines) ? lines[point.name] : lines)) {\n\t\t\t\tresult.push({\n\t\t\t\t\tname: point.name,\n\t\t\t\t\tcomponent: lineComponent,\n\t\t\t\t\tclassName: cn(\n\t\t\t\t\t\tlineClassNames.default,\n\t\t\t\t\t\tlineClassNames[point.name],\n\t\t\t\t\t\tdisabled && lineClassNames.disabled,\n\t\t\t\t\t),\n\t\t\t\t\twrapperClassName: cn(\n\t\t\t\t\t\t`advanced-cropper-bounding-box__line`,\n\t\t\t\t\t\t`advanced-cropper-bounding-box__line--${point.name}`,\n\t\t\t\t\t\tlineWrapperClassNames.default,\n\t\t\t\t\t\tlineWrapperClassNames[point.name],\n\t\t\t\t\t\tdisabled && lineWrapperClassNames.disabled,\n\t\t\t\t\t),\n\t\t\t\t\thoverClassName: lineClassNames.hover,\n\t\t\t\t\tverticalPosition: point.verticalPosition,\n\t\t\t\t\thorizontalPosition: point.horizontalPosition,\n\t\t\t\t\tdisabled,\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t\treturn result;\n\t}, [points, lines, lineComponent, lineClassNames, lineWrapperClassNames, disabled]);\n\n\tconst handlerNodes = useMemo(() => {\n\t\tconst result: HandlerNode[] = [];\n\t\tpoints.forEach((point) => {\n\t\t\tif (isObject(handlers) ? handlers[point.name] : handlers) {\n\t\t\t\tresult.push({\n\t\t\t\t\tname: point.name,\n\t\t\t\t\tcomponent: handlerComponent,\n\t\t\t\t\tclassName: cn(handlerClassNames.default, handlerClassNames[point.name]),\n\t\t\t\t\tcontainerClassName: cn(\n\t\t\t\t\t\t`advanced-cropper-bounding-box__handler-wrapper`,\n\t\t\t\t\t\t`advanced-cropper-bounding-box__handler-wrapper--${point.className}`,\n\t\t\t\t\t),\n\t\t\t\t\twrapperClassName: cn(\n\t\t\t\t\t\t`advanced-cropper-bounding-box__handler`,\n\t\t\t\t\t\t`advanced-cropper-bounding-box__handler--${point.className}`,\n\t\t\t\t\t\thandlerWrapperClassNames.default,\n\t\t\t\t\t\thandlerWrapperClassNames[point.name],\n\t\t\t\t\t),\n\t\t\t\t\thoverClassName: handlerClassNames.hover,\n\t\t\t\t\tverticalPosition: point.verticalPosition,\n\t\t\t\t\thorizontalPosition: point.horizontalPosition,\n\t\t\t\t\tdisabled,\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t\treturn result;\n\t}, [points, handlers, handlerComponent, handlerClassNames, handlerWrapperClassNames, disabled]);\n\n\tconst onHandlerMove =\n\t\t(horizontalPosition: HorizontalCardinalDirection | null, verticalPosition: VerticalCardinalDirection | null) =>\n\t\t({ left, top }: MoveDirections, nativeEvent: MouseEvent | TouchEvent) => {\n\t\t\tconst directions = {\n\t\t\t\tleft,\n\t\t\t\ttop,\n\t\t\t};\n\n\t\t\tlet respectDirection: 'width' | 'height' | undefined;\n\t\t\tif (!verticalPosition && horizontalPosition) {\n\t\t\t\trespectDirection = 'width';\n\t\t\t} else if (verticalPosition && !horizontalPosition) {\n\t\t\t\trespectDirection = 'height';\n\t\t\t}\n\n\t\t\tif (!disabled) {\n\t\t\t\tif (onResize) {\n\t\t\t\t\tconst anchor = getDirectionNames(horizontalPosition, verticalPosition).camelCase;\n\t\t\t\t\tif (anchor) {\n\t\t\t\t\t\tonResize(anchor, directions, {\n\t\t\t\t\t\t\treference: lastReference || reference,\n\t\t\t\t\t\t\tpreserveAspectRatio: nativeEvent && nativeEvent.shiftKey,\n\t\t\t\t\t\t\trespectDirection,\n\t\t\t\t\t\t\tcompensate: true,\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (!lastReference) {\n\t\t\t\t\tsetLastReference(reference);\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\tconst onHandlerMoveEnd = () => {\n\t\tonResizeEnd?.();\n\t\tsetLastReference(null);\n\t};\n\n\treturn (\n\t\t<div className={cn('advanced-cropper-bounding-box', className)} style={style}>\n\t\t\t{children}\n\t\t\t<div>\n\t\t\t\t{lineNodes.map((line) => (\n\t\t\t\t\t<line.component\n\t\t\t\t\t\tkey={line.name}\n\t\t\t\t\t\tdefaultClassName={line.className}\n\t\t\t\t\t\thoverClassName={line.hoverClassName}\n\t\t\t\t\t\twrapperClassName={line.wrapperClassName}\n\t\t\t\t\t\tposition={line.name}\n\t\t\t\t\t\tdisabled={line.disabled}\n\t\t\t\t\t\tonMove={onHandlerMove(line.horizontalPosition, line.verticalPosition)}\n\t\t\t\t\t\tonMoveEnd={onHandlerMoveEnd}\n\t\t\t\t\t/>\n\t\t\t\t))}\n\t\t\t</div>\n\t\t\t<div>\n\t\t\t\t{handlerNodes.map((handler) => {\n\t\t\t\t\tconst handlerElement = (\n\t\t\t\t\t\t<handler.component\n\t\t\t\t\t\t\tdefaultClassName={handler.className}\n\t\t\t\t\t\t\thoverClassName={handler.hoverClassName}\n\t\t\t\t\t\t\twrapperClassName={handler.wrapperClassName}\n\t\t\t\t\t\t\thorizontalPosition={handler.horizontalPosition}\n\t\t\t\t\t\t\tverticalPosition={handler.verticalPosition}\n\t\t\t\t\t\t\tdisabled={handler.disabled}\n\t\t\t\t\t\t\tonMove={onHandlerMove(handler.horizontalPosition, handler.verticalPosition)}\n\t\t\t\t\t\t\tonMoveEnd={onHandlerMoveEnd}\n\t\t\t\t\t\t/>\n\t\t\t\t\t);\n\n\t\t\t\t\treturn (\n\t\t\t\t\t\t<div key={handler.name} className={handler.containerClassName}>\n\t\t\t\t\t\t\t{handlerElement}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t);\n\t\t\t\t})}\n\t\t\t</div>\n\t\t</div>\n\t);\n};\n","import React, { FC } from 'react';\nimport classnames from 'classnames';\n\ninterface Props {\n\tclassName?: string;\n}\n\nexport const StencilOverlay: FC<Props> = ({ className, children }) => {\n\treturn <div className={classnames('advanced-cropper-stencil-overlay', className)}>{children}</div>;\n};\n","import React, { FC, ReactNode, useLayoutEffect, useRef, useState } from 'react';\nimport { Coordinates, CropperTransitions, deepCompare, isNumber } from 'advanced-cropper';\nimport classnames from 'classnames';\nimport { useTransition } from '../../hooks/useTransition';\n\ninterface Props {\n\tclassName?: string;\n\ttransitions?: CropperTransitions;\n\twidth?: number;\n\theight?: number;\n\tleft?: number;\n\ttop?: number;\n\tchildren?: ReactNode;\n}\n\nexport const ArtificialTransition: FC<Props> = ({ className, transitions, children, ...values }) => {\n\tconst root = useRef<HTMLDivElement>(null);\n\n\tconst transitionValues = useRef<Partial<Coordinates>>(values);\n\n\tconst [rememberedValues, setRememberedValues] = useState(values);\n\n\tconst [runTransitions, transitionsActive] = useTransition(transitions);\n\n\tuseLayoutEffect(() => {\n\t\tif (!deepCompare(rememberedValues, values)) {\n\t\t\tsetRememberedValues(values);\n\n\t\t\tconst startValues = transitionsActive\n\t\t\t\t? {\n\t\t\t\t\t\t...transitionValues.current,\n\t\t\t\t  }\n\t\t\t\t: rememberedValues;\n\n\t\t\trunTransitions((progress) => {\n\t\t\t\tconst properties = ['left', 'top', 'height', 'width'] as const;\n\n\t\t\t\tproperties.forEach((property) => {\n\t\t\t\t\tconst desiredValue = values[property];\n\t\t\t\t\tconst startValue = startValues[property];\n\n\t\t\t\t\ttransitionValues.current[property] =\n\t\t\t\t\t\tisNumber(startValue) && isNumber(desiredValue)\n\t\t\t\t\t\t\t? startValue + (desiredValue - startValue) * progress\n\t\t\t\t\t\t\t: desiredValue;\n\t\t\t\t});\n\n\t\t\t\tif (root.current) {\n\t\t\t\t\troot.current.style.width = `${transitionValues.current.width}px`;\n\t\t\t\t\troot.current.style.height = `${transitionValues.current.height}px`;\n\t\t\t\t\troot.current.style.transform = `translate3d(${transitionValues.current.left}px, ${transitionValues.current.top}px, 0px)`;\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\t// eslint-disable-next-line react-hooks/exhaustive-deps\n\t}, [rememberedValues, transitionsActive, values.width, values.height, values.top, values.left]);\n\n\tconst currentValues = transitionsActive ? transitionValues.current : values;\n\n\tconst rootStyle = {\n\t\tleft: 0,\n\t\ttop: 0,\n\t\twidth: `${currentValues.width}px`,\n\t\theight: `${currentValues.height}px`,\n\t\ttransform: `translate3d(${currentValues.left}px, ${currentValues.top}px, 0px)`,\n\t};\n\n\treturn (\n\t\t<div ref={root} className={classnames('advanced-cropper-artificial-transition', className)} style={rootStyle}>\n\t\t\t{children}\n\t\t</div>\n\t);\n};\n","import { CropperTransitions, Animation } from 'advanced-cropper';\nimport { useRef, useState } from 'react';\n\nexport function useTransition<T>(transitions: CropperTransitions | null = null): [(callback: (progress: number) => void) => void, boolean] {\n\tconst animation = useRef(new Animation());\n\tconst [active, setActive] = useState(false);\n\n\treturn [\n\t\t(callback: (progress: number) => void) => {\n\t\t\tif (transitions && transitions.active) {\n\t\t\t\t\tanimation.current.start({\n\t\t\t\t\t\t...transitions,\n\t\t\t\t\t\tonStart() {\n\t\t\t\t\t\t\tsetActive(true);\n\t\t\t\t\t\t},\n\t\t\t\t\t\tonProgress(progress) {\n\t\t\t\t\t\t\tcallback(progress);\n\t\t\t\t\t\t},\n\t\t\t\t\t\tonStop() {\n\t\t\t\t\t\t\tsetActive(false);\n\t\t\t\t\t\t},\n\t\t\t\t\t});\n \t\t\t} else if (!animation.current.active) {\n\t\t\t\tcallback(1);\n\t\t\t}\n\t\t},\n\t\tactive,\n\t];\n}\n","import React, { FC, ReactNode } from 'react';\nimport { CropperTransitions } from 'advanced-cropper';\nimport classnames from 'classnames';\n\nimport { ArtificialTransition } from './ArtificialTransition';\n\ninterface Props {\n\tchildren?: ReactNode;\n\tclassName?: string;\n\ttransitions?: CropperTransitions;\n\twidth?: number;\n\theight?: number;\n\tleft: number;\n\ttop: number;\n}\n\nexport const StencilWrapper: FC<Props> = ({ className, transitions, width, height, left, top, children }) => {\n\treturn (\n\t\t<ArtificialTransition\n\t\t\tclassName={classnames('advanced-cropper-stencil-wrapper', className)}\n\t\t\ttransitions={transitions}\n\t\t\twidth={width}\n\t\t\theight={height}\n\t\t\ttop={top}\n\t\t\tleft={left}\n\t\t>\n\t\t\t{children}\n\t\t</ArtificialTransition>\n\t);\n};\n","import React, { FC, ReactNode, useState } from 'react';\nimport cn from 'classnames';\nimport { useUpdateEffect } from '../../hooks/useUpdateEffect';\n\nexport interface StencilGridProps {\n\tvisible?: boolean;\n\tcolumns?: number;\n\trows?: number;\n\tclassName?: string;\n}\n\nexport const StencilGrid: FC<StencilGridProps> = ({ columns = 3, rows = 3, visible = false, className }) => {\n\tconst nodes: ReactNode[] = [];\n\n\tconst [currentColumns, setCurrentColumns] = useState(columns);\n\tconst [currentRows, setCurrentRows] = useState(rows);\n\n\tuseUpdateEffect(() => {\n\t\tif (visible) {\n\t\t\tsetCurrentRows(rows);\n\t\t\tsetCurrentColumns(columns);\n\t\t}\n\t}, [visible, columns, rows]);\n\n\tfor (let i = 0; i < currentRows; i++) {\n\t\tconst cells: ReactNode[] = [];\n\t\tfor (let j = 0; j < currentColumns; j++) {\n\t\t\tcells.push(\n\t\t\t\t<div\n\t\t\t\t\tkey={j}\n\t\t\t\t\tclassName={cn(\n\t\t\t\t\t\t'advanced-cropper-stencil-grid__cell',\n\t\t\t\t\t\ti === 0 && 'advanced-cropper-stencil-grid__cell--top',\n\t\t\t\t\t\ti === currentRows - 1 && 'advanced-cropper-stencil-grid__cell--bottom',\n\t\t\t\t\t\tj === 0 && 'advanced-cropper-stencil-grid__cell--left',\n\t\t\t\t\t\tj === currentColumns - 1 && 'advanced-cropper-stencil-grid__cell--right',\n\t\t\t\t\t)}\n\t\t\t\t/>,\n\t\t\t);\n\t\t}\n\t\tnodes.push(\n\t\t\t<div key={i} className={'advanced-cropper-stencil-grid__row'}>\n\t\t\t\t{cells}\n\t\t\t</div>,\n\t\t);\n\t}\n\n\treturn (\n\t\t<div\n\t\t\tclassName={cn(\n\t\t\t\t'advanced-cropper-stencil-grid',\n\t\t\t\tvisible && 'advanced-cropper-stencil-grid--visible',\n\t\t\t\tclassName,\n\t\t\t)}\n\t\t>\n\t\t\t{nodes}\n\t\t</div>\n\t);\n};\n","import React, { FC, forwardRef, useImperativeHandle } from 'react';\nimport cn from 'classnames';\nimport {\n\tCardinalDirection,\n\tOrdinalDirection,\n\tCropperTransitions,\n\tCropperState,\n\tMoveDirections,\n\tResizeOptions,\n\tgetStencilCoordinates,\n\tCropperInteractions,\n\tResizeAnchor,\n\tisFunction,\n\tCoordinates,\n\tRawAspectRatio,\n\tcreateAspectRatio,\n} from 'advanced-cropper';\nimport { SimpleLine } from '../lines/SimpleLine';\nimport { SimpleHandler } from '../handlers/SimpleHandler';\nimport { BoundingBox } from '../service/BoundingBox';\nimport { StencilOverlay } from '../service/StencilOverlay';\nimport { DraggableArea } from '../service/DraggableArea';\nimport { StencilWrapper } from '../service/StencilWrapper';\nimport { StencilGrid } from '../service/StencilGrid';\n\ntype HandlerComponent = FC<any>;\n\ntype LineComponent = FC<any>;\n\ninterface HandlerClassNames extends Partial<Record<OrdinalDirection, string>> {\n\tdefault?: string;\n\tdisabled?: string;\n\thover?: string;\n}\n\ninterface LineClassNames extends Partial<Record<CardinalDirection, string>> {\n\tdefault?: string;\n\tdisabled?: string;\n\thover?: string;\n}\n\ninterface DesiredCropperRef {\n\tgetState: () => CropperState | null;\n\tgetTransitions: () => CropperTransitions;\n\tgetInteractions: () => CropperInteractions;\n\thasInteractions: () => boolean;\n\tresizeCoordinates: (anchor: ResizeAnchor, directions: Partial<MoveDirections>, parameters: unknown) => void;\n\tresizeCoordinatesEnd: () => void;\n\tmoveCoordinates: (directions: Partial<MoveDirections>) => void;\n\tmoveCoordinatesEnd: () => void;\n}\n\ninterface Props {\n\tcropper: DesiredCropperRef;\n\tcoordinates?: Coordinates | ((state: CropperState | null) => Coordinates);\n\thandlerComponent?: HandlerComponent;\n\thandlers?: Partial<Record<OrdinalDirection, boolean>>;\n\thandlerClassNames?: HandlerClassNames;\n\thandlerWrapperClassNames?: HandlerClassNames;\n\tlines?: Partial<Record<CardinalDirection, boolean>>;\n\tlineComponent?: LineComponent;\n\tlineClassNames?: LineClassNames;\n\tlineWrapperClassNames?: LineClassNames;\n\tclassName?: string;\n\tmovingClassName?: string;\n\tresizingClassName?: string;\n\tgridClassName?: string;\n\tpreviewClassName?: string;\n\tboundingBoxClassName?: string;\n\toverlayClassName?: string;\n\tdraggableAreaClassName?: string;\n\tminAspectRatio?: number;\n\tmaxAspectRatio?: number;\n\taspectRatio?: RawAspectRatio;\n\tmovable?: boolean;\n\tresizable?: boolean;\n\tgrid?: boolean;\n\tdisabled?: boolean;\n}\n\ninterface Methods {\n\taspectRatio: RawAspectRatio;\n}\n\nexport const RectangleStencil = forwardRef<Methods, Props>(\n\t(\n\t\t{\n\t\t\tcropper,\n\t\t\tcoordinates,\n\t\t\taspectRatio,\n\t\t\tminAspectRatio,\n\t\t\tmaxAspectRatio,\n\t\t\thandlerComponent = SimpleHandler,\n\t\t\thandlers = {\n\t\t\t\teastNorth: true,\n\t\t\t\tnorth: true,\n\t\t\t\twestNorth: true,\n\t\t\t\twest: true,\n\t\t\t\twestSouth: true,\n\t\t\t\tsouth: true,\n\t\t\t\teastSouth: true,\n\t\t\t\teast: true,\n\t\t\t},\n\t\t\thandlerClassNames = {},\n\t\t\thandlerWrapperClassNames = {},\n\t\t\tlines = {\n\t\t\t\twest: true,\n\t\t\t\tnorth: true,\n\t\t\t\teast: true,\n\t\t\t\tsouth: true,\n\t\t\t},\n\t\t\tlineComponent = SimpleLine,\n\t\t\tlineClassNames = {},\n\t\t\tlineWrapperClassNames = {},\n\t\t\tresizable = true,\n\t\t\tmovable = true,\n\t\t\tgrid,\n\t\t\tgridClassName,\n\t\t\tclassName,\n\t\t\tmovingClassName,\n\t\t\tresizingClassName,\n\t\t\tpreviewClassName,\n\t\t\tboundingBoxClassName,\n\t\t\toverlayClassName,\n\t\t\tdraggableAreaClassName,\n\t\t\tdisabled,\n\t\t}: Props,\n\t\tref,\n\t) => {\n\t\tconst state = cropper.getState();\n\t\tconst transitions = cropper.getTransitions();\n\t\tconst interactions = cropper.getInteractions();\n\n\t\tconst resizeAllowed = resizable && !disabled;\n\t\tconst moveAllowed = movable && !disabled;\n\n\t\tuseImperativeHandle(ref, () => ({\n\t\t\taspectRatio: createAspectRatio(\n\t\t\t\taspectRatio || {\n\t\t\t\t\tminimum: minAspectRatio,\n\t\t\t\t\tmaximum: maxAspectRatio,\n\t\t\t\t},\n\t\t\t),\n\t\t}));\n\n\t\tconst onMove = (directions: MoveDirections) => {\n\t\t\tif (cropper && moveAllowed) {\n\t\t\t\tcropper.moveCoordinates(directions);\n\t\t\t}\n\t\t};\n\n\t\tconst onMoveEnd = () => {\n\t\t\tif (cropper) {\n\t\t\t\tcropper.moveCoordinatesEnd();\n\t\t\t}\n\t\t};\n\n\t\tconst onResize = (anchor: ResizeAnchor, directions: MoveDirections, options: ResizeOptions) => {\n\t\t\tif (cropper && resizeAllowed) {\n\t\t\t\tcropper.resizeCoordinates(anchor, directions, options);\n\t\t\t}\n\t\t};\n\n\t\tconst onResizeEnd = () => {\n\t\t\tif (cropper) {\n\t\t\t\tcropper.resizeCoordinatesEnd();\n\t\t\t}\n\t\t};\n\n\t\tconst { width, height, left, top } = coordinates\n\t\t\t? isFunction(coordinates)\n\t\t\t\t? coordinates(state)\n\t\t\t\t: coordinates\n\t\t\t: getStencilCoordinates(state);\n\n\t\treturn (\n\t\t\tstate && (\n\t\t\t\t<StencilWrapper\n\t\t\t\t\tclassName={cn(\n\t\t\t\t\t\t'advanced-cropper-rectangle-stencil',\n\t\t\t\t\t\tclassName,\n\t\t\t\t\t\tinteractions.moveCoordinates && movingClassName,\n\t\t\t\t\t\tinteractions.resizeCoordinates && resizingClassName,\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t'advanced-cropper-rectangle-stencil--movable': moveAllowed,\n\t\t\t\t\t\t\t'advanced-cropper-rectangle-stencil--moving': interactions.moveCoordinates,\n\t\t\t\t\t\t\t'advanced-cropper-rectangle-stencil--resizable': resizeAllowed,\n\t\t\t\t\t\t\t'advanced-cropper-rectangle-stencil--resizing': interactions.resizeCoordinates,\n\t\t\t\t\t\t\t'advanced-cropper-rectangle-stencil--disabled': disabled,\n\t\t\t\t\t\t},\n\t\t\t\t\t)}\n\t\t\t\t\twidth={width}\n\t\t\t\t\theight={height}\n\t\t\t\t\tleft={left}\n\t\t\t\t\ttop={top}\n\t\t\t\t\ttransitions={transitions}\n\t\t\t\t>\n\t\t\t\t\t<BoundingBox\n\t\t\t\t\t\treference={state.coordinates}\n\t\t\t\t\t\tclassName={cn(boundingBoxClassName, 'advanced-cropper-rectangle-stencil__bounding-box')}\n\t\t\t\t\t\thandlers={handlers}\n\t\t\t\t\t\thandlerComponent={handlerComponent}\n\t\t\t\t\t\thandlerClassNames={handlerClassNames}\n\t\t\t\t\t\thandlerWrapperClassNames={handlerWrapperClassNames}\n\t\t\t\t\t\tlines={lines}\n\t\t\t\t\t\tlineComponent={lineComponent}\n\t\t\t\t\t\tlineClassNames={lineClassNames}\n\t\t\t\t\t\tlineWrapperClassNames={lineWrapperClassNames}\n\t\t\t\t\t\tonResize={onResize}\n\t\t\t\t\t\tonResizeEnd={onResizeEnd}\n\t\t\t\t\t\tdisabled={!resizeAllowed}\n\t\t\t\t\t>\n\t\t\t\t\t\t<DraggableArea\n\t\t\t\t\t\t\tdisabled={!moveAllowed}\n\t\t\t\t\t\t\tonMove={onMove}\n\t\t\t\t\t\t\tonMoveEnd={onMoveEnd}\n\t\t\t\t\t\t\tclassName={cn('advanced-cropper-rectangle-stencil__draggable-area', draggableAreaClassName)}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<StencilOverlay\n\t\t\t\t\t\t\t\tclassName={cn('advanced-cropper-rectangle-stencil__overlay', overlayClassName)}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t{grid && (\n\t\t\t\t\t\t\t\t\t<StencilGrid\n\t\t\t\t\t\t\t\t\t\tvisible={cropper.hasInteractions()}\n\t\t\t\t\t\t\t\t\t\tcolumns={interactions.transformImage.rotate ? 9 : 3}\n\t\t\t\t\t\t\t\t\t\trows={interactions.transformImage.rotate ? 9 : 3}\n\t\t\t\t\t\t\t\t\t\tclassName={cn('advanced-cropper-rectangle-stencil__grid', gridClassName)}\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t<div className={cn('advanced-cropper-rectangle-stencil__preview', previewClassName)} />\n\t\t\t\t\t\t\t</StencilOverlay>\n\t\t\t\t\t\t</DraggableArea>\n\t\t\t\t\t</BoundingBox>\n\t\t\t\t</StencilWrapper>\n\t\t\t)\n\t\t);\n\t},\n);\n\nRectangleStencil.displayName = 'RectangleStencil';\n","import { useMemo } from 'react';\nimport { getOptions } from 'advanced-cropper';\nimport { RotateImageOptions } from '../types';\n\ninterface DefinedRotateImageOptions {\n\ttouch: boolean;\n}\n\nexport function useRotateImageOptions(rotateImage: RotateImageOptions | boolean): DefinedRotateImageOptions {\n\treturn useMemo(\n\t\t() =>\n\t\t\tgetOptions(\n\t\t\t\trotateImage,\n\t\t\t\t{\n\t\t\t\t\ttouch: true,\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\ttouch: false,\n\t\t\t\t},\n\t\t\t),\n\t\t[rotateImage],\n\t);\n}\n","import { useMemo } from 'react';\nimport { getOptions } from 'advanced-cropper';\nimport { ScaleImageOptions } from '../types';\n\ninterface DefinedScaleImageOptions {\n\ttouch: boolean;\n\twheel:\n\t\t| boolean\n\t\t| {\n\t\t\t\tratio: number;\n\t\t  };\n}\n\nexport function useScaleImageOptions(scaleImage: ScaleImageOptions | boolean): DefinedScaleImageOptions {\n\treturn useMemo(\n\t\t() =>\n\t\t\tgetOptions(\n\t\t\t\tscaleImage,\n\t\t\t\t{\n\t\t\t\t\ttouch: true,\n\t\t\t\t\twheel: {\n\t\t\t\t\t\tratio: 0.1,\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\ttouch: false,\n\t\t\t\t\twheel: false,\n\t\t\t\t},\n\t\t\t),\n\t\t[scaleImage],\n\t);\n}\n","import { useMemo } from 'react';\nimport { getOptions } from 'advanced-cropper';\nimport { MoveImageOptions } from '../types';\n\ninterface DefinedMoveImageOptions {\n\ttouch: boolean;\n\tmouse: boolean;\n}\n\nexport function useMoveImageOptions(moveImage: MoveImageOptions | boolean): DefinedMoveImageOptions {\n\treturn useMemo(\n\t\t() =>\n\t\t\tgetOptions(\n\t\t\t\tmoveImage,\n\t\t\t\t{\n\t\t\t\t\ttouch: true,\n\t\t\t\t\tmouse: true,\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\ttouch: false,\n\t\t\t\t\tmouse: false,\n\t\t\t\t},\n\t\t\t),\n\t\t[moveImage],\n\t);\n}\n","import React, { ReactNode, CSSProperties, Component, RefObject, createRef } from 'react';\nimport {\n\tdebounce,\n\tDebouncedFunction,\n\tImageTransform,\n\tPoint,\n\tSimpleTouch,\n\ttouchesToImageTransform,\n\twheelEventToImageTransform,\n} from 'advanced-cropper';\n\ninterface Props {\n\tonTransform?: (transform: ImageTransform) => void;\n\tonTransformEnd?: () => void;\n\tonEvent?: (transformEvent: TransformableImageEvent, nativeEvent: Event) => unknown;\n\tdisabled?: boolean;\n\ttouchMove?: boolean;\n\tmouseMove?: boolean;\n\ttouchScale?: boolean;\n\ttouchRotate?: boolean;\n\twheelScale?:\n\t\t| boolean\n\t\t| {\n\t\t\t\tratio: number;\n\t\t  };\n\ttimeout?: number;\n\tchildren?: ReactNode;\n\tclassName?: string;\n\tstyle?: CSSProperties;\n\tpreventDefault?: boolean;\n}\n\nexport class TransformableImageEvent {\n\tconstructor({ active }: { active: boolean }) {\n\t\tthis.active = active;\n\t\tthis.defaultPrevented = false;\n\t}\n\tpreventDefault() {\n\t\tthis.defaultPrevented = true;\n\t}\n\tdefaultPrevented: boolean;\n\tactive: boolean;\n}\n\nexport class TransformableImage extends Component<Props> {\n\ttouches: (SimpleTouch & { identifier?: number })[];\n\ttransforming: boolean;\n\tanchor: Point;\n\tcontainer: RefObject<HTMLDivElement>;\n\tdebouncedProcessEnd: DebouncedFunction<TransformableImage['processEnd']>;\n\n\tstatic defaultProps = {\n\t\ttouchMove: true,\n\t\tmouseMove: true,\n\t\ttouchScale: true,\n\t\ttouchRotate: false,\n\t\twheelScale: true,\n\t\ttimeout: 500,\n\t};\n\n\tconstructor(props: Props) {\n\t\tsuper(props);\n\t\tthis.transforming = false;\n\t\tthis.touches = [];\n\t\tthis.anchor = {\n\t\t\tleft: 0,\n\t\t\ttop: 0,\n\t\t};\n\t\tthis.container = createRef();\n\t\tthis.debouncedProcessEnd = debounce(this.processEnd, props.timeout);\n\t}\n\n\tprocessMove = (newTouches: SimpleTouch[]) => {\n\t\tconst { onTransform, touchScale, touchMove, touchRotate } = this.props;\n\t\tconst container = this.container.current;\n\t\tif (container && onTransform) {\n\t\t\tonTransform(\n\t\t\t\ttouchesToImageTransform(newTouches, this.touches, container, {\n\t\t\t\t\tscale: touchScale,\n\t\t\t\t\trotate: touchRotate,\n\t\t\t\t\tmove: touchMove,\n\t\t\t\t}),\n\t\t\t);\n\t\t\tthis.touches = newTouches;\n\t\t}\n\t};\n\n\tprocessEnd = () => {\n\t\tconst { onTransformEnd } = this.props;\n\t\tif (this.transforming) {\n\t\t\tthis.transforming = false;\n\t\t\tif (onTransformEnd) {\n\t\t\t\tonTransformEnd();\n\t\t\t}\n\t\t}\n\t};\n\n\tprocessStart = () => {\n\t\tthis.transforming = true;\n\t\tthis.debouncedProcessEnd.clear();\n\t};\n\n\tprocessEvent = (nativeEvent: Event) => {\n\t\tconst { onEvent, disabled, preventDefault = true } = this.props;\n\t\tconst transformEvent = new TransformableImageEvent({ active: this.transforming });\n\n\t\tif (onEvent) {\n\t\t\tonEvent(transformEvent, nativeEvent);\n\t\t} else if (preventDefault) {\n\t\t\tnativeEvent.preventDefault();\n\t\t\tnativeEvent.stopPropagation();\n\t\t}\n\n\t\treturn !disabled && !transformEvent.defaultPrevented;\n\t};\n\n\tonWheel = (event: WheelEvent) => {\n\t\tconst { onTransform, wheelScale } = this.props;\n\t\tconst container = this.container.current;\n\n\t\tif (wheelScale) {\n\t\t\tif (this.processEvent(event)) {\n\t\t\t\tthis.processStart();\n\t\t\t\tif (onTransform && container) {\n\t\t\t\t\tonTransform(\n\t\t\t\t\t\twheelEventToImageTransform(event, container, wheelScale === true ? 0.1 : wheelScale.ratio),\n\t\t\t\t\t);\n\t\t\t\t}\n\n\t\t\t\tif (!this.touches.length) {\n\t\t\t\t\tthis.debouncedProcessEnd();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t};\n\tonTouchStart = (event: TouchEvent) => {\n\t\tconst { touchMove, touchScale, touchRotate } = this.props;\n\t\tif (event.cancelable && (touchMove || ((touchScale || touchRotate) && event.touches.length > 1))) {\n\t\t\tif (this.processEvent(event)) {\n\t\t\t\tconst container = this.container.current;\n\t\t\t\tif (container) {\n\t\t\t\t\tconst { left, top, bottom, right } = container.getBoundingClientRect();\n\t\t\t\t\tthis.touches = Array.from(event.touches).filter(\n\t\t\t\t\t\t(touch) =>\n\t\t\t\t\t\t\ttouch.clientX > left &&\n\t\t\t\t\t\t\ttouch.clientX < right &&\n\t\t\t\t\t\t\ttouch.clientY > top &&\n\t\t\t\t\t\t\ttouch.clientY < bottom,\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t};\n\tonTouchEnd = (event: TouchEvent) => {\n\t\tif (event.touches.length === 0) {\n\t\t\tthis.touches = [];\n\t\t\tthis.processEnd();\n\t\t}\n\t};\n\n\tonTouchMove = (event: TouchEvent) => {\n\t\tif (this.touches.length) {\n\t\t\tconst touches = [...event.touches].filter(\n\t\t\t\t(touch) =>\n\t\t\t\t\t!touch.identifier ||\n\t\t\t\t\tthis.touches.find((anotherTouch) => anotherTouch.identifier === touch.identifier),\n\t\t\t);\n\n\t\t\tif (this.processEvent(event)) {\n\t\t\t\tthis.processMove(touches);\n\t\t\t\tthis.processStart();\n\t\t\t}\n\t\t}\n\t};\n\n\tonMouseDown = (event: MouseEvent) => {\n\t\tconst { mouseMove } = this.props;\n\t\tif (mouseMove && 'buttons' in event && event.buttons === 1) {\n\t\t\tif (this.processEvent(event)) {\n\t\t\t\tconst touch = {\n\t\t\t\t\tclientX: event.clientX,\n\t\t\t\t\tclientY: event.clientY,\n\t\t\t\t};\n\t\t\t\tthis.touches = [touch];\n\t\t\t\tthis.processStart();\n\t\t\t}\n\t\t}\n\t};\n\n\tonMouseMove = (event: MouseEvent) => {\n\t\tif (this.touches.length) {\n\t\t\tif (this.processEvent(event)) {\n\t\t\t\tthis.processMove([\n\t\t\t\t\t{\n\t\t\t\t\t\tclientX: event.clientX,\n\t\t\t\t\t\tclientY: event.clientY,\n\t\t\t\t\t},\n\t\t\t\t]);\n\t\t\t}\n\t\t}\n\t};\n\n\tonMouseUp = () => {\n\t\tthis.touches = [];\n\t\tthis.processEnd();\n\t};\n\n\tshouldComponentUpdate(): boolean {\n\t\treturn true;\n\t}\n\n\tcomponentWillUnmount() {\n\t\twindow.removeEventListener('mouseup', this.onMouseUp);\n\t\twindow.removeEventListener('mousemove', this.onMouseMove);\n\t\twindow.removeEventListener('touchmove', this.onTouchMove);\n\t\twindow.removeEventListener('touchend', this.onTouchEnd);\n\t\tconst container = this.container.current;\n\t\tif (container) {\n\t\t\tcontainer.removeEventListener('touchstart', this.onTouchStart);\n\t\t\tcontainer.removeEventListener('mousedown', this.onMouseDown);\n\t\t\tcontainer.removeEventListener('wheel', this.onWheel);\n\t\t}\n\t}\n\n\tcomponentDidMount() {\n\t\twindow.addEventListener('mouseup', this.onMouseUp, { passive: false });\n\t\twindow.addEventListener('mousemove', this.onMouseMove, { passive: false });\n\t\twindow.addEventListener('touchmove', this.onTouchMove, { passive: false });\n\t\twindow.addEventListener('touchend', this.onTouchEnd, { passive: false });\n\n\t\tconst container = this.container.current;\n\t\tif (container) {\n\t\t\t// Add event listeners here due to https://github.com/facebook/react/issues/9809#issuecomment-414072263\n\t\t\tcontainer.addEventListener('touchstart', this.onTouchStart, {\n\t\t\t\tpassive: false,\n\t\t\t});\n\t\t\tcontainer.addEventListener('mousedown', this.onMouseDown, {\n\t\t\t\tpassive: false,\n\t\t\t});\n\t\t\tcontainer.addEventListener('wheel', this.onWheel, {\n\t\t\t\tpassive: false,\n\t\t\t});\n\t\t}\n\t}\n\n\trender() {\n\t\tconst { className, children, style } = this.props;\n\t\treturn (\n\t\t\t<div className={className} style={style} ref={this.container}>\n\t\t\t\t{children}\n\t\t\t</div>\n\t\t);\n\t}\n}\n","import React, { forwardRef, PropsWithoutRef } from 'react';\n\nexport function createCropper<T, P = {}>(\n\trender: (props: P, ref: React.Ref<T>) => React.ReactElement | null,\n): (props: PropsWithoutRef<P> & React.RefAttributes<T>) => React.ReactElement | null {\n\treturn forwardRef<T, P>(render);\n}\n","import React, { CSSProperties, ReactNode } from 'react';\nimport { CropperTransitions, ImageTransform } from 'advanced-cropper';\nimport { useRotateImageOptions } from '../../hooks/useRotateImageOptions';\nimport { useScaleImageOptions } from '../../hooks/useScaleImageOptions';\nimport { useMoveImageOptions } from '../../hooks/useMoveImageOptions';\nimport { MoveImageOptions, RotateImageOptions, ScaleImageOptions } from '../../types';\nimport { TransformableImage } from './TransformableImage';\n\ninterface DesiredCropperRef {\n\ttransformImage: (transform: ImageTransform) => void;\n\ttransformImageEnd: () => void;\n\tgetTransitions: () => CropperTransitions;\n}\n\nexport interface CropperBackgroundWrapperProps {\n\tcropper: DesiredCropperRef;\n\trotateImage?: boolean | RotateImageOptions;\n\tscaleImage?: boolean | ScaleImageOptions;\n\tmoveImage?: boolean | MoveImageOptions;\n\tchildren?: ReactNode;\n\tclassName?: string;\n\tstyle?: CSSProperties;\n\ttimeout?: number;\n\tdisabled?: boolean;\n}\n\nexport const CropperBackgroundWrapper = ({\n\tscaleImage = true,\n\tmoveImage = true,\n\trotateImage = false,\n\tchildren,\n\tclassName,\n\tstyle,\n\tcropper,\n\ttimeout,\n\tdisabled\n}: CropperBackgroundWrapperProps) => {\n\tconst transitions = cropper.getTransitions();\n\n\tconst rotateImageOptions = useRotateImageOptions(rotateImage);\n\tconst scaleImageOptions = useScaleImageOptions(scaleImage);\n\tconst moveImageOptions = useMoveImageOptions(moveImage);\n\n\treturn (\n\t\t<TransformableImage\n\t\t\tclassName={className}\n\t\t\tstyle={style}\n\t\t\tonTransform={cropper.transformImage}\n\t\t\tonTransformEnd={cropper.transformImageEnd}\n\t\t\ttouchMove={moveImageOptions.touch}\n\t\t\tmouseMove={moveImageOptions.mouse}\n\t\t\ttouchScale={scaleImageOptions.touch}\n\t\t\twheelScale={scaleImageOptions.wheel}\n\t\t\ttouchRotate={rotateImageOptions.touch}\n\t\t\tdisabled={transitions.active || disabled}\n\t\t\tpreventDefault={!disabled}\n\t\t\ttimeout={timeout}\n\t\t>\n\t\t\t{children}\n\t\t</TransformableImage>\n\t);\n};\n","import React, { useImperativeHandle, useRef, CSSProperties, Ref } from 'react';\nimport cn from 'classnames';\nimport {\n\tDrawOptions,\n\tDefaultSettings,\n\tdefaultStencilConstraints,\n\tCoreSettings,\n\tCropperImage,\n\tCropperState,\n\tCropperTransitions,\n\tModifierSettings,\n\tInitializeSettings,\n} from 'advanced-cropper';\n\nimport {\n\tCropperBackgroundWrapperComponent,\n\tCropperWrapperComponent,\n\tStencilComponent,\n\tCropperBackgroundComponent,\n\tArbitraryProps,\n\tStencilConstraints,\n\tSettingsExtension,\n\tExtendedSettings,\n\tCustomCropperRef,\n\tCropperBoundaryComponent,\n} from '../types';\nimport { CropperStateHook, CropperInstanceSettings, CropperInstanceSettingsProp } from '../hooks/useCropperInstance';\nimport { createCropper } from '../service/cropper';\nimport { AbstractCropperHookProps, useAbstractCropper } from '../hooks/useAbstractCropper';\nimport { StretchableBoundary } from './service/StretchableBoundary';\nimport { CropperWrapper } from './service/CropperWrapper';\nimport { CropperBackgroundImage } from './service/CropperBackgroundImage';\nimport { CropperCanvas } from './service/CropperCanvas';\nimport { RectangleStencil } from './stencils/RectangleStencil';\nimport { CropperBackgroundWrapper } from './service/CropperBackgroundWrapper';\n\nexport type AbstractCropperSettingsProp<Settings extends CropperInstanceSettings> =\n\tCropperInstanceSettingsProp<Settings>;\n\nexport type AbstractCropperSettings = DefaultSettings & CoreSettings & ModifierSettings & InitializeSettings;\n\nexport interface AbstractCropperRef<Settings extends AbstractCropperSettings = AbstractCropperSettings> {\n\treset: () => void;\n\trefresh: () => void;\n\tclear: () => void;\n\tsetCoordinates: CropperStateHook['setCoordinates'];\n\tsetState: CropperStateHook['setState'];\n\tsetImage: (image: CropperImage) => void;\n\tflipImage: CropperStateHook['flipImage'];\n\tzoomImage: CropperStateHook['zoomImage'];\n\trotateImage: CropperStateHook['rotateImage'];\n\treconcileState: CropperStateHook['reconcileState'];\n\tmoveImage: CropperStateHook['moveImage'];\n\tmoveCoordinates: CropperStateHook['moveCoordinates'];\n\tmoveCoordinatesEnd: CropperStateHook['moveCoordinatesEnd'];\n\tresizeCoordinates: CropperStateHook['resizeCoordinates'];\n\tresizeCoordinatesEnd: CropperStateHook['resizeCoordinatesEnd'];\n\ttransformImage: CropperStateHook['transformImage'];\n\ttransformImageEnd: CropperStateHook['transformImageEnd'];\n\tgetCoordinates: CropperStateHook['getCoordinates'];\n\tgetVisibleArea: CropperStateHook['getVisibleArea'];\n\tgetTransforms: CropperStateHook['getTransforms'];\n\tgetStencilCoordinates: CropperStateHook['getStencilCoordinates'];\n\tgetDefaultState: () => CropperState | null;\n\tgetCanvas: (options?: DrawOptions) => HTMLCanvasElement | null;\n\tgetSettings: () => Settings;\n\tgetImage: () => CropperImage | null;\n\tgetState: () => CropperState | null;\n\tgetTransitions: () => CropperTransitions;\n\tisLoading: () => boolean;\n\tisLoaded: () => boolean;\n}\n\nexport interface AbstractCropperProps<Settings extends AbstractCropperSettings>\n\textends Omit<AbstractCropperHookProps<Settings>, 'settings'> {\n\tbackgroundComponent?: CropperBackgroundComponent;\n\tbackgroundProps?: ArbitraryProps;\n\tbackgroundClassName?: string;\n\tbackgroundWrapperComponent?: CropperBackgroundWrapperComponent;\n\tbackgroundWrapperProps?: ArbitraryProps;\n\tbackgroundWrapperClassName?: string;\n\twrapperComponent?: CropperWrapperComponent;\n\twrapperProps?: ArbitraryProps;\n\tstencilComponent?: StencilComponent;\n\tstencilProps?: ArbitraryProps;\n\tstencilConstraints?: StencilConstraints<AbstractCropperSettingsProp<Settings>>;\n\tclassName?: string;\n\tboundaryComponent?: CropperBoundaryComponent;\n\tboundaryProps?: ArbitraryProps;\n\tboundaryClassName?: string;\n\tstyle?: CSSProperties;\n\tsettings: CropperInstanceSettingsProp<Settings>;\n\tdisabled?: boolean;\n}\n\nexport type AbstractCropperIntrinsicProps<Settings extends AbstractCropperSettings> = Omit<\n\tAbstractCropperProps<Settings>,\n\t'settings'\n>;\n\nconst AbstractCropperComponent = <Extension extends SettingsExtension = {}>(\n\tprops: AbstractCropperProps<ExtendedSettings<Extension>>,\n\tref: Ref<CustomCropperRef<Extension>>,\n) => {\n\tconst {\n\t\tstyle,\n\t\tclassName,\n\t\tstencilComponent = RectangleStencil,\n\t\tstencilConstraints = defaultStencilConstraints,\n\t\tstencilProps = {},\n\t\twrapperComponent = CropperWrapper,\n\t\twrapperProps = {},\n\t\tbackgroundComponent = CropperBackgroundImage,\n\t\tbackgroundProps = {},\n\t\tbackgroundClassName,\n\t\tbackgroundWrapperComponent = CropperBackgroundWrapper,\n\t\tbackgroundWrapperProps = {},\n\t\tboundaryComponent = StretchableBoundary,\n\t\tboundaryProps,\n\t\tboundaryClassName,\n\t\tcanvas = true,\n\t\tcrossOrigin = true,\n\t\tdisabled,\n\t\tsettings,\n\t\t...parameters\n\t} = props;\n\n\tconst stencilRef = useRef<StencilComponent>(null);\n\n\tconst { cropper, image, refs } = useAbstractCropper(() => ({\n\t\t...parameters,\n\t\tcrossOrigin,\n\t\tstencilProps,\n\t\tcanvas,\n\t\tsettings: {\n\t\t\t...settings,\n\t\t\t...stencilConstraints(settings, {\n\t\t\t\t...stencilProps,\n\t\t\t\t...stencilRef.current,\n\t\t\t}),\n\t\t},\n\t}));\n\n\tconst StencilComponent = stencilComponent;\n\n\tconst WrapperComponent = wrapperComponent;\n\n\tconst BackgroundWrapperComponent = backgroundWrapperComponent;\n\n\tconst BackgroundComponent = backgroundComponent;\n\n\tconst BoundaryComponent = boundaryComponent;\n\n\tuseImperativeHandle(ref, () => cropper);\n\n\tconst deprecatedWrapperProps = {\n\t\tloading: cropper.isLoading(),\n\t\tloaded: cropper.isLoaded(),\n\t};\n\n\treturn (\n\t\t<WrapperComponent\n\t\t\t{...wrapperProps}\n\t\t\tdisabled={disabled}\n\t\t\tclassName={cn('advanced-cropper', className)}\n\t\t\tcropper={cropper}\n\t\t\tstyle={style}\n\t\t\t{...deprecatedWrapperProps}\n\t\t>\n\t\t\t<BoundaryComponent\n\t\t\t\t{...boundaryProps}\n\t\t\t\tref={refs.boundary}\n\t\t\t\tclassName={cn('advanced-cropper__boundary', boundaryClassName)}\n\t\t\t>\n\t\t\t\t<BackgroundWrapperComponent\n\t\t\t\t\t{...backgroundWrapperProps}\n\t\t\t\t\tdisabled={disabled}\n\t\t\t\t\tcropper={cropper}\n\t\t\t\t\tclassName={'advanced-cropper__background-wrapper'}\n\t\t\t\t>\n\t\t\t\t\t{cropper.getState() && (\n\t\t\t\t\t\t<BackgroundComponent\n\t\t\t\t\t\t\t{...backgroundProps}\n\t\t\t\t\t\t\tref={refs.image}\n\t\t\t\t\t\t\tcrossOrigin={crossOrigin}\n\t\t\t\t\t\t\tcropper={cropper}\n\t\t\t\t\t\t\tclassName={cn('advanced-cropper__background', backgroundClassName)}\n\t\t\t\t\t\t/>\n\t\t\t\t\t)}\n\t\t\t\t\t<StencilComponent {...stencilProps} disabled={disabled} ref={stencilRef} cropper={cropper} image={image} />\n\t\t\t\t</BackgroundWrapperComponent>\n\t\t\t\t{canvas && <CropperCanvas ref={refs.canvas} />}\n\t\t\t</BoundaryComponent>\n\t\t</WrapperComponent>\n\t);\n};\n\nexport const AbstractCropper = createCropper(AbstractCropperComponent);\n","export const defaultSettings = [\n\t'transformImage',\n\t'moveCoordinates',\n\t'resizeCoordinates',\n\t'defaultCoordinates',\n\t'defaultVisibleArea',\n\t'areaPositionRestrictions',\n\t'areaSizeRestrictions',\n\t'sizeRestrictions',\n\t'positionRestrictions',\n\t'aspectRatio',\n\t'minWidth',\n\t'minHeight',\n\t'maxWidth',\n\t'maxHeight',\n\t'defaultSize',\n\t'defaultPosition',\n\t'defaultTransforms',\n\t'imageRestriction',\n\t'priority',\n];\n","import { ExtendedSettings, SettingsExtension } from '../types';\nimport { AbstractCropperIntrinsicProps } from '../components/AbstractCropper';\nimport { defaultSettings } from '../service/constants';\nimport { CoreSettings, DefaultSettings, ModifierSettings } from '../../../../Advanced Cropper/advanced-cropper/dist';\n\ntype Props<Extension extends SettingsExtension> = AbstractCropperIntrinsicProps<ExtendedSettings<Extension>>;\n\nexport function useAbstractCropperProps<Extension extends SettingsExtension>(\n\tprops: Props<Extension>,\n\tsettings: string[] = defaultSettings,\n) {\n\tconst result: any = { settings: {}, props: {} };\n\n\t(Object.keys(props) as (keyof typeof props)[]).forEach((key) => {\n\t\tif (settings.some((setting) => setting === key)) {\n\t\t\tresult.settings[key] = props[key];\n\t\t} else {\n\t\t\tresult.props[key] = props[key];\n\t\t}\n\t});\n\n\treturn result as {\n\t\tsettings: Extension & Partial<DefaultSettings & CoreSettings & ModifierSettings>;\n\t\tprops: Props<Extension>;\n\t};\n}\n","import { __assign } from 'tslib';\nimport { isFunction } from '../../utils/index.js';\nimport { aspectRatioIntersection, createAspectRatio, ratio, applyScale, fitToSizeRestrictions, applyMove, diff, getCenter, moveToPositionRestrictions, mergePositionRestrictions, coordinatesToPositionRestrictions } from '../../service/utils.js';\nimport { getAreaSizeRestrictions, getSizeRestrictions, getAspectRatio, isInitializedState, getAreaPositionRestrictions } from '../../service/helpers.js';\nimport { copyState } from '../../state/copyState.js';\nimport '../../types/index.js';\nimport '../../state/setCoordinates.js';\nimport { approximateSize } from '../../service/approximateSize.js';\nimport { defaultStencilConstraints } from '../../defaults/defaultStencilConstraints.js';\n\nfunction fixedStencilConstraints(rawSettings, stencilOptions) {\n    var defaultConstraints = defaultStencilConstraints({}, stencilOptions);\n    return {\n        stencilSize: function (state, settings) {\n            var previousSize = isFunction(rawSettings.stencilSize)\n                ? rawSettings.stencilSize(state, settings)\n                : rawSettings.stencilSize;\n            return approximateSize(__assign(__assign({}, previousSize), { aspectRatio: aspectRatioIntersection(defaultConstraints.aspectRatio, createAspectRatio(ratio(previousSize))) }));\n        },\n    };\n}\nfunction getStencilSize(state, settings) {\n    var boundary = state.boundary;\n    var size = isFunction(settings.stencilSize) ? settings.stencilSize(state, settings) : settings.stencilSize;\n    if (size.width > boundary.width || size.height > boundary.height) {\n        size = approximateSize({\n            sizeRestrictions: {\n                maxWidth: boundary.width,\n                maxHeight: boundary.height,\n                minWidth: 0,\n                minHeight: 0,\n            },\n            width: size.width,\n            height: size.height,\n            aspectRatio: {\n                minimum: ratio(size),\n                maximum: ratio(size),\n            },\n        });\n    }\n    return size;\n}\nfunction sizeRestrictions(state, settings) {\n    var stencilSize = getStencilSize(state, __assign(__assign({}, settings), { stencilSize: settings.stencilSize }));\n    var areaRestrictions = getAreaSizeRestrictions(state, settings);\n    return {\n        maxWidth: (areaRestrictions.maxWidth * stencilSize.width) / state.boundary.width,\n        maxHeight: (areaRestrictions.maxHeight * stencilSize.height) / state.boundary.height,\n        minWidth: 0,\n        minHeight: 0,\n    };\n}\nfunction defaultSize(state, settings) {\n    var imageSize = state.imageSize, visibleArea = state.visibleArea, boundary = state.boundary;\n    var sizeRestrictions = getSizeRestrictions(state, settings);\n    var aspectRatio = getAspectRatio(state, settings);\n    var stencilSize = isFunction(settings.stencilSize) ? settings.stencilSize(state, settings) : settings.stencilSize;\n    var area = (visibleArea || imageSize);\n    var height, width;\n    if (ratio(area) > ratio(boundary)) {\n        height = (stencilSize.height * area.height) / boundary.height;\n        width = height * ratio(stencilSize);\n    }\n    else {\n        width = (stencilSize.width * area.width) / boundary.width;\n        height = width / ratio(stencilSize);\n    }\n    return approximateSize({\n        width: width,\n        height: height,\n        aspectRatio: aspectRatio,\n        sizeRestrictions: sizeRestrictions,\n    });\n}\nfunction aspectRatio(state, settings) {\n    var value = ratio(getStencilSize(state, settings));\n    return {\n        minimum: value,\n        maximum: value,\n    };\n}\nfunction fixedStencilAlgorithm(state, settings) {\n    if (isInitializedState(state)) {\n        var result = copyState(state);\n        var stencil = getStencilSize(state, settings);\n        // First of all try to resize visible area as much as possible:\n        result.visibleArea = applyScale(result.visibleArea, (result.coordinates.width * result.boundary.width) / (result.visibleArea.width * stencil.width));\n        // Check that visible area doesn't break the area restrictions:\n        var scale = fitToSizeRestrictions(result.visibleArea, getAreaSizeRestrictions(result, settings));\n        if (scale !== 1) {\n            result.visibleArea = applyScale(result.visibleArea, scale);\n            result.coordinates = applyScale(result.coordinates, scale);\n        }\n        result.visibleArea = applyMove(result.visibleArea, diff(getCenter(result.coordinates), getCenter(result.visibleArea)));\n        // Center stencil in visible area:\n        result.visibleArea = moveToPositionRestrictions(result.visibleArea, getAreaPositionRestrictions(result, settings));\n        result.coordinates = moveToPositionRestrictions(result.coordinates, mergePositionRestrictions(coordinatesToPositionRestrictions(result.visibleArea), getAreaPositionRestrictions(result, settings)));\n        return result;\n    }\n    return state;\n}\nfunction fixedStencil(state, settings, action) {\n    if (action && action.immediately) {\n        return fixedStencilAlgorithm(state, settings);\n    }\n    return state;\n}\n\nexport { aspectRatio, defaultSize, fixedStencil, fixedStencilAlgorithm, fixedStencilConstraints, getStencilSize, sizeRestrictions };\n","import React, { forwardRef, Ref } from 'react';\nimport {\n\tdefaultSize,\n\tsizeRestrictions,\n\taspectRatio,\n\tfixedStencil,\n\tStencilSize,\n\tfixedStencilConstraints,\n} from 'advanced-cropper/extensions/stencil-size';\nimport { withDefaultSizeRestrictions } from 'advanced-cropper/defaults';\nimport { CustomCropperProps, CustomCropperRef } from '../../types';\nimport { AbstractCropper } from '../AbstractCropper';\nimport { useAbstractCropperProps } from '../../hooks/useAbstractCropperProps';\nimport { defaultSettings } from '../../service/constants';\n\ntype UnavailableProps = 'sizeRestrictions' | 'aspectRatio';\n\nexport interface FixedCropperSettings {\n\tstencilSize: StencilSize<this>;\n}\n\nexport type FixedCropperProps = Omit<CustomCropperProps<FixedCropperSettings>, UnavailableProps>;\n\nexport type FixedCropperRef = CustomCropperRef<FixedCropperSettings>;\n\nexport const FixedCropper = forwardRef((props: FixedCropperProps, ref?: Ref<FixedCropperRef>) => {\n\tconst cropperProps = useAbstractCropperProps(props, [...defaultSettings, 'stencilSize']);\n\treturn (\n\t\t<AbstractCropper<FixedCropperSettings>\n\t\t\tpostProcess={fixedStencil}\n\t\t\tstencilConstraints={fixedStencilConstraints}\n\t\t\t{...cropperProps.props}\n\t\t\tsettings={{\n\t\t\t\tdefaultSize,\n\t\t\t\taspectRatio,\n\t\t\t\tsizeRestrictions: withDefaultSizeRestrictions(sizeRestrictions),\n\t\t\t\t...cropperProps.settings,\n\t\t\t\ttransformImage: {\n\t\t\t\t\t...cropperProps.settings.transformImage,\n\t\t\t\t\tadjustStencil: false,\n\t\t\t\t},\n\t\t\t}}\n\t\t\tref={ref}\n\t\t/>\n\t);\n});\n\nFixedCropper.displayName = 'FixedCropper';\n","import React, { forwardRef, Ref } from 'react';\nimport { isUndefined } from 'advanced-cropper';\nimport { StencilSize } from 'advanced-cropper/extensions/stencil-size';\nimport { CustomCropperProps, CustomCropperRef, ExtendedSettings, SettingsExtension } from '../../types';\nimport { hybridStencilAutoZoom } from '../../deprecated/hybridAutoZoom';\nimport { useDeprecationWarning } from '../../hooks/useDeprecationWarning';\nimport { AbstractCropper, AbstractCropperIntrinsicProps } from '../AbstractCropper';\nimport { useAbstractCropperProps } from '../../hooks/useAbstractCropperProps';\nimport { FixedCropper, FixedCropperRef, FixedCropperSettings } from './FixedCropper';\n\ninterface DeprecatedCropperSettings {\n\tstencilSize?: StencilSize;\n\tautoZoom?: boolean;\n}\n\nexport type CropperProps<Extension extends SettingsExtension = {}> = CustomCropperProps<Extension>;\n\nexport type CropperRef<Extension extends SettingsExtension = {}> = CustomCropperRef<Extension>;\n\nexport const Cropper = forwardRef((props: CropperProps, ref?: Ref<CropperRef>) => {\n\tconst cropperProps = useAbstractCropperProps(props);\n\n\tconst intrinsicProps = cropperProps.props;\n\n\t// Process the deprecated properties\n\tconst { stencilSize, autoZoom, ...actualSettings } = cropperProps.settings as DeprecatedCropperSettings;\n\n\tconst deprecationWarning = useDeprecationWarning();\n\n\tif (!isUndefined(autoZoom)) {\n\t\tif (intrinsicProps.postProcess || stencilSize) {\n\t\t\tdeprecationWarning(\n\t\t\t\t`prop 'autoZoom' is deprecated now and will be removed, use 'postProcess' prop to pass your auto zoom function.`,\n\t\t\t);\n\t\t} else {\n\t\t\tdeprecationWarning(\n\t\t\t\t`prop 'autoZoom' is deprecated now and will be removed, use 'postProcess' prop to pass your auto zoom function. The 'postProcess' automatically set to 'hybridAutoZoom'`,\n\t\t\t);\n\t\t\tintrinsicProps.postProcess = hybridStencilAutoZoom;\n\t\t}\n\t}\n\n\tif (!isUndefined(stencilSize)) {\n\t\tdeprecationWarning(\n\t\t\t`prop 'stencilSize' is deprecated for <Cropper/> component now and will be removed, use <FixedCropper/> component instead.`,\n\t\t);\n\t\treturn (\n\t\t\t<FixedCropper\n\t\t\t\tref={ref as Ref<FixedCropperRef>}\n\t\t\t\tstencilSize={stencilSize}\n\t\t\t\t{...actualSettings}\n\t\t\t\t{...(intrinsicProps as AbstractCropperIntrinsicProps<ExtendedSettings<FixedCropperSettings>>)}\n\t\t\t/>\n\t\t);\n\t}\n\n\treturn <AbstractCropper {...intrinsicProps} ref={ref} settings={actualSettings} />;\n});\n\nCropper.displayName = 'CropperComponent';\n","import React, { ComponentType, forwardRef, useImperativeHandle } from 'react';\nimport cn from 'classnames';\nimport {\n\tCardinalDirection,\n\tOrdinalDirection,\n\tCropperTransitions,\n\tCropperState,\n\tMoveDirections,\n\tResizeOptions,\n\tgetStencilCoordinates,\n\tCropperInteractions,\n\tResizeAnchor,\n\tisFunction,\n\tCoordinates,\n\tRawAspectRatio,\n} from 'advanced-cropper';\nimport { SimpleLine } from '../lines/SimpleLine';\nimport { SimpleHandler } from '../handlers/SimpleHandler';\nimport { BoundingBox } from '../service/BoundingBox';\nimport { StencilOverlay } from '../service/StencilOverlay';\nimport { DraggableArea } from '../service/DraggableArea';\nimport { StencilWrapper } from '../service/StencilWrapper';\nimport { StencilGrid } from '../service/StencilGrid';\n\ntype HandlerComponent = ComponentType<any>;\n\ntype LineComponent = ComponentType<any>;\n\ninterface HandlerClassNames extends Partial<Record<OrdinalDirection, string>> {\n\tdefault?: string;\n\tdisabled?: string;\n\thover?: string;\n}\n\ninterface LineClassNames extends Partial<Record<CardinalDirection, string>> {\n\tdefault?: string;\n\tdisabled?: string;\n\thover?: string;\n}\n\ninterface DesiredCropperRef {\n\tgetState: () => CropperState | null;\n\tgetTransitions: () => CropperTransitions;\n\tgetInteractions: () => CropperInteractions;\n\thasInteractions: () => boolean;\n\tresizeCoordinates: (anchor: ResizeAnchor, directions: Partial<MoveDirections>, parameters: unknown) => void;\n\tresizeCoordinatesEnd: () => void;\n\tmoveCoordinates: (directions: Partial<MoveDirections>) => void;\n\tmoveCoordinatesEnd: () => void;\n}\n\ninterface Props {\n\tcropper: DesiredCropperRef;\n\tcoordinates?: Coordinates | ((state: CropperState | null) => Coordinates);\n\thandlerComponent?: HandlerComponent;\n\thandlers?: Partial<Record<OrdinalDirection, boolean>>;\n\thandlerClassNames?: HandlerClassNames;\n\thandlerWrapperClassNames?: HandlerClassNames;\n\tlines?: Partial<Record<CardinalDirection, boolean>>;\n\tlineComponent?: LineComponent;\n\tlineClassNames?: LineClassNames;\n\tlineWrapperClassNames?: LineClassNames;\n\tclassName?: string;\n\tmovingClassName?: string;\n\tresizingClassName?: string;\n\tgridClassName?: string;\n\tpreviewClassName?: string;\n\tboundingBoxClassName?: string;\n\toverlayClassName?: string;\n\tdraggableAreaClassName?: string;\n\tmovable?: boolean;\n\tresizable?: boolean;\n\tdisabled?: boolean;\n\tgrid?: boolean;\n}\n\ninterface Methods {\n\taspectRatio: RawAspectRatio;\n}\n\nexport const CircleStencil = forwardRef<Methods, Props>(\n\t(\n\t\t{\n\t\t\tcropper,\n\t\t\tcoordinates,\n\t\t\thandlerComponent = SimpleHandler,\n\t\t\thandlers = {\n\t\t\t\teastNorth: true,\n\t\t\t\twestNorth: true,\n\t\t\t\twestSouth: true,\n\t\t\t\teastSouth: true,\n\t\t\t},\n\t\t\thandlerClassNames = {},\n\t\t\thandlerWrapperClassNames = {},\n\t\t\tlines = {\n\t\t\t\twest: true,\n\t\t\t\tnorth: true,\n\t\t\t\teast: true,\n\t\t\t\tsouth: true,\n\t\t\t},\n\t\t\tlineComponent = SimpleLine,\n\t\t\tlineClassNames = {},\n\t\t\tlineWrapperClassNames = {},\n\t\t\tresizable = true,\n\t\t\tmovable = true,\n\t\t\tgrid,\n\t\t\tgridClassName,\n\t\t\tclassName,\n\t\t\tmovingClassName,\n\t\t\tresizingClassName,\n\t\t\tpreviewClassName,\n\t\t\tboundingBoxClassName,\n\t\t\toverlayClassName,\n\t\t\tdraggableAreaClassName,\n\t\t\tdisabled,\n\t\t}: Props,\n\t\tref,\n\t) => {\n\t\tconst state = cropper.getState();\n\t\tconst transitions = cropper.getTransitions();\n\t\tconst interactions = cropper.getInteractions();\n\n\t\tconst resizeAllowed = resizable && !disabled;\n\t\tconst moveAllowed = movable && !disabled;\n\n\t\tuseImperativeHandle(ref, () => ({\n\t\t\taspectRatio: 1,\n\t\t\tboundingBox: 'circle',\n\t\t}));\n\n\t\tconst onMove = (directions: MoveDirections) => {\n\t\t\tif (cropper && moveAllowed) {\n\t\t\t\tcropper.moveCoordinates(directions);\n\t\t\t}\n\t\t};\n\n\t\tconst onMoveEnd = () => {\n\t\t\tif (cropper) {\n\t\t\t\tcropper.moveCoordinatesEnd();\n\t\t\t}\n\t\t};\n\n\t\tconst onResize = (anchor: ResizeAnchor, directions: MoveDirections, options: ResizeOptions) => {\n\t\t\tif (cropper && resizeAllowed) {\n\t\t\t\tcropper.resizeCoordinates(anchor, directions, options);\n\t\t\t}\n\t\t};\n\n\t\tconst onResizeEnd = () => {\n\t\t\tif (cropper) {\n\t\t\t\tcropper.resizeCoordinatesEnd();\n\t\t\t}\n\t\t};\n\n\t\tconst { width, height, left, top } = coordinates\n\t\t\t? isFunction(coordinates)\n\t\t\t\t? coordinates(state)\n\t\t\t\t: coordinates\n\t\t\t: getStencilCoordinates(state);\n\n\t\treturn (\n\t\t\tstate && (\n\t\t\t\t<StencilWrapper\n\t\t\t\t\tclassName={cn(\n\t\t\t\t\t\t'advanced-cropper-circle-stencil',\n\t\t\t\t\t\tclassName,\n\t\t\t\t\t\tinteractions.moveCoordinates && movingClassName,\n\t\t\t\t\t\tinteractions.resizeCoordinates && resizingClassName,\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t'advanced-cropper-circle-stencil--movable': moveAllowed,\n\t\t\t\t\t\t\t'advanced-cropper-circle-stencil--moving': interactions.moveCoordinates,\n\t\t\t\t\t\t\t'advanced-cropper-circle-stencil--resizable': resizeAllowed,\n\t\t\t\t\t\t\t'advanced-cropper-circle-stencil--resizing': interactions.resizeCoordinates,\n\t\t\t\t\t\t\t'advanced-cropper-circle-stencil--disabled': disabled,\n\t\t\t\t\t\t},\n\t\t\t\t\t)}\n\t\t\t\t\twidth={width}\n\t\t\t\t\theight={height}\n\t\t\t\t\tleft={left}\n\t\t\t\t\ttop={top}\n\t\t\t\t\ttransitions={transitions}\n\t\t\t\t>\n\t\t\t\t\t<BoundingBox\n\t\t\t\t\t\treference={state.coordinates}\n\t\t\t\t\t\tclassName={cn(boundingBoxClassName, 'advanced-cropper-circle-stencil__bounding-box')}\n\t\t\t\t\t\thandlers={handlers}\n\t\t\t\t\t\thandlerComponent={handlerComponent}\n\t\t\t\t\t\thandlerClassNames={handlerClassNames}\n\t\t\t\t\t\thandlerWrapperClassNames={handlerWrapperClassNames}\n\t\t\t\t\t\tlines={lines}\n\t\t\t\t\t\tlineComponent={lineComponent}\n\t\t\t\t\t\tlineClassNames={lineClassNames}\n\t\t\t\t\t\tlineWrapperClassNames={lineWrapperClassNames}\n\t\t\t\t\t\tonResize={onResize}\n\t\t\t\t\t\tonResizeEnd={onResizeEnd}\n\t\t\t\t\t\tdisabled={!resizeAllowed}\n\t\t\t\t\t>\n\t\t\t\t\t\t<DraggableArea\n\t\t\t\t\t\t\tdisabled={!moveAllowed}\n\t\t\t\t\t\t\tonMove={onMove}\n\t\t\t\t\t\t\tonMoveEnd={onMoveEnd}\n\t\t\t\t\t\t\tclassName={cn('advanced-cropper-circle-stencil__draggable-area', draggableAreaClassName)}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<StencilOverlay\n\t\t\t\t\t\t\t\tclassName={cn('advanced-cropper-circle-stencil__overlay', overlayClassName)}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t{grid && (\n\t\t\t\t\t\t\t\t\t<StencilGrid\n\t\t\t\t\t\t\t\t\t\tvisible={cropper.hasInteractions()}\n\t\t\t\t\t\t\t\t\t\tcolumns={interactions.transformImage.rotate ? 9 : 3}\n\t\t\t\t\t\t\t\t\t\trows={interactions.transformImage.rotate ? 9 : 3}\n\t\t\t\t\t\t\t\t\t\tclassName={cn('advanced-cropper-circle-stencil__grid', gridClassName)}\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t<div className={cn('advanced-cropper-circle-stencil__preview', previewClassName)} />\n\t\t\t\t\t\t\t</StencilOverlay>\n\t\t\t\t\t\t</DraggableArea>\n\t\t\t\t\t</BoundingBox>\n\t\t\t\t</StencilWrapper>\n\t\t\t)\n\t\t);\n\t},\n);\n\nCircleStencil.displayName = 'CircleStencil';\n","import React, { forwardRef, HTMLAttributes, RefObject } from 'react';\nimport cn from 'classnames';\n\ninterface Props extends HTMLAttributes<HTMLImageElement> {\n\tsrc?: string | null;\n\tcrossOrigin?: 'anonymous' | 'use-credentials' | boolean;\n}\n\nexport const CropperSource = forwardRef<HTMLImageElement, Props>(\n\t({ src, crossOrigin = true, ...props }: Props, ref) => {\n\t\treturn src ? (\n\t\t\t<img\n\t\t\t\tkey={src}\n\t\t\t\tref={ref as RefObject<HTMLImageElement>}\n\t\t\t\tsrc={src}\n\t\t\t\tclassName={cn('advanced-cropper-source')}\n\t\t\t\tcrossOrigin={crossOrigin === true ? 'anonymous' : crossOrigin || undefined}\n\t\t\t\t{...props}\n\t\t\t/>\n\t\t) : null;\n\t},\n);\n\nCropperSource.displayName = 'CropperSource';\n","import React, { CSSProperties, FC, ReactNode } from 'react';\nimport cn from 'classnames';\nimport { CropperFade } from '../service/CropperFade';\n\ninterface DesiredCropperRef {\n\tisLoaded: () => boolean;\n}\n\nexport interface CropperPreviewWrapperProps {\n\tcropper?: DesiredCropperRef;\n\tclassName?: string;\n\tstyle?: CSSProperties;\n\tchildren?: ReactNode;\n}\n\nexport const CropperPreviewWrapper: FC<CropperPreviewWrapperProps> = ({ children, cropper, className, style }) => {\n\treturn (\n\t\t<div className={cn(className, 'cropper-preview-wrapper')} style={style}>\n\t\t\t<CropperFade visible={cropper?.isLoaded()} className={'cropper-preview-wrapper__fade'}>\n\t\t\t\t{children}\n\t\t\t</CropperFade>\n\t\t</div>\n\t);\n};\n","import React, { CSSProperties } from 'react';\nimport cn from 'classnames';\nimport { CropperTransitions, CropperImage, CropperState, Size, getPreviewStyle } from 'advanced-cropper';\nimport { preventDefault } from '../../service/events';\n\ninterface DesiredCropperRef {\n\tgetState: () => CropperState | null;\n\tgetTransitions: () => CropperTransitions;\n\tgetImage: () => CropperImage | null;\n}\n\nexport interface CropperPreviewBackgroundProps {\n\tclassName?: string;\n\tcropper: DesiredCropperRef;\n\tcrossOrigin?: 'anonymous' | 'use-credentials' | boolean;\n\tsize?: Size | null;\n\tstyle?: CSSProperties;\n}\n\nexport const CropperPreviewBackground = ({\n\tclassName,\n\tcropper,\n\tcrossOrigin = true,\n\tsize,\n\tstyle,\n}: CropperPreviewBackgroundProps) => {\n\tconst state = cropper.getState();\n\tconst transitions = cropper.getTransitions();\n\tconst image = cropper.getImage();\n\n\tconst transformStyles = size && image && state?.coordinates ? getPreviewStyle(image, state, size, transitions) : {};\n\n\tconst src = image ? image.src : undefined;\n\n\treturn src ? (\n\t\t<img\n\t\t\tkey={src}\n\t\t\tclassName={cn('advanced-cropper-background-image', className)}\n\t\t\tsrc={src}\n\t\t\tcrossOrigin={crossOrigin === true ? 'anonymous' : crossOrigin || undefined}\n\t\t\tstyle={{\n\t\t\t\t...transformStyles,\n\t\t\t\t...style,\n\t\t\t}}\n\t\t\tonMouseDown={preventDefault}\n\t\t/>\n\t) : null;\n};\n","import React, {\n\tRefObject,\n\tComponentType,\n\tCSSProperties,\n\tforwardRef,\n\tuseImperativeHandle,\n\tuseLayoutEffect,\n\tuseRef,\n\tuseState,\n} from 'react';\nimport cn from 'classnames';\nimport {\n\tCropperImage,\n\tCropperState,\n\tCropperTransitions,\n\tSize,\n\tratio,\n\tisGreater,\n\tstretchPreviewBoundary,\n} from 'advanced-cropper';\nimport { StretchableBoundary, StretchableBoundaryMethods } from '../service/StretchableBoundary';\nimport { useWindowResize } from '../../hooks/useWindowResize';\nimport { ArbitraryProps, CropperBoundaryComponent } from '../../types';\nimport { useForceRerender } from '../../hooks/useForceRerender';\nimport { CropperPreviewWrapper } from './CropperPreviewWrapper';\nimport { CropperPreviewBackground } from './CropperPreviewBackground';\n\ninterface DesiredCropperRef {\n\tgetState: () => CropperState | null;\n\tgetImage: () => CropperImage | null;\n\tgetTransitions: () => CropperTransitions;\n\tisLoading: () => boolean;\n\tisLoaded: () => boolean;\n}\n\nexport interface CropperPreviewRef {\n\trefresh: () => void;\n\tupdate: (cropper?: DesiredCropperRef) => void;\n}\n\ntype PreviewWrapperComponent = ComponentType<{\n\tcropper: any;\n\tclassName?: string;\n\tstyle?: CSSProperties;\n\tloading?: boolean;\n\tloaded?: boolean;\n}>;\n\ntype PreviewBackgroundComponent = ComponentType<{\n\tcropper: any;\n\tsize: Size | null;\n\tclassName?: string;\n}>;\n\ninterface Props {\n\tstate?: CropperState | null;\n\timage?: CropperImage | null;\n\ttransitions?: CropperTransitions | null;\n\tloading?: boolean;\n\tloaded?: boolean;\n\tclassName?: string;\n\tcontentClassName?: string;\n\tbackgroundClassName?: string;\n\tbackgroundComponent?: PreviewBackgroundComponent;\n\tbackgroundProps?: ArbitraryProps;\n\tboundaryComponent?: CropperBoundaryComponent;\n\tboundaryProps?: ArbitraryProps;\n\tboundaryClassName?: string;\n\twrapperComponent?: PreviewWrapperComponent;\n\twrapperProps?: ArbitraryProps;\n\tstyle?: CSSProperties;\n\tcropper?: RefObject<DesiredCropperRef | null>;\n}\n\nexport const CropperPreview = forwardRef<CropperPreviewRef, Props>(\n\t(\n\t\t{\n\t\t\tclassName,\n\t\t\tcontentClassName,\n\t\t\tstate = null,\n\t\t\timage = null,\n\t\t\ttransitions = null,\n\t\t\tbackgroundComponent = CropperPreviewBackground,\n\t\t\tbackgroundProps,\n\t\t\tbackgroundClassName,\n\t\t\tboundaryComponent = StretchableBoundary,\n\t\t\tboundaryProps,\n\t\t\tboundaryClassName,\n\t\t\twrapperComponent = CropperPreviewWrapper,\n\t\t\twrapperProps,\n\t\t\tloaded = true,\n\t\t\tloading = false,\n\t\t\tstyle,\n\t\t\tcropper,\n\t\t}: Props,\n\t\tref,\n\t) => {\n\t\tconst rerender = useForceRerender();\n\n\t\tconst boundaryRef = useRef<StretchableBoundaryMethods>(null);\n\n\t\tconst internalInstance = useRef<DesiredCropperRef | null>(null);\n\n\t\tconst instance = cropper || (internalInstance.current ? internalInstance : {\n\t\t\tcurrent: {\n\t\t\t\tgetState: () => state,\n\t\t\t\tgetTransitions: () => transitions,\n\t\t\t\tgetImage: () => image,\n\t\t\t\tisLoaded: () => loaded,\n\t\t\t\tisLoading: () => loading,\n\t\t\t},\n\t\t});\n\n\t\tconst [size, setSize] = useState<Size | null>(null);\n\n\t\tconst coordinates = instance.current?.getState()?.coordinates;\n\n\t\tconst src = instance.current?.getImage()?.src;\n\n\t\tconst contentStyle = size\n\t\t\t? {\n\t\t\t\t\twidth: `${size.width}px`,\n\t\t\t\t\theight: `${size.height}px`,\n\t\t\t  }\n\t\t\t: {};\n\n\t\tconst refresh = () => {\n\t\t\tconst coordinates = instance.current?.getState()?.coordinates;\n\t\t\tif (boundaryRef.current && coordinates) {\n\t\t\t\tboundaryRef.current.stretchTo(coordinates).then((size) => {\n\t\t\t\t\tif (size && coordinates) {\n\t\t\t\t\t\tif (isGreater(ratio(coordinates), ratio(size))) {\n\t\t\t\t\t\t\tsetSize({\n\t\t\t\t\t\t\t\twidth: size.width,\n\t\t\t\t\t\t\t\theight: size.width / ratio(coordinates),\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tsetSize({\n\t\t\t\t\t\t\t\twidth: size.height * ratio(coordinates),\n\t\t\t\t\t\t\t\theight: size.height,\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tsetSize(null);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t\trerender();\n\t\t};\n\n\t\tuseWindowResize(refresh);\n\n\t\tuseLayoutEffect(refresh, [coordinates?.height, coordinates?.width]);\n\n\t\tuseImperativeHandle(ref, () => ({\n\t\t\trefresh,\n\t\t\tupdate(cropper?: DesiredCropperRef) {\n\t\t\t\tif (cropper) {\n\t\t\t\t\tinternalInstance.current = cropper;\n\t\t\t\t} else {\n\t\t\t\t\tinternalInstance.current = null;\n\t\t\t\t}\n\t\t\t\trefresh();\n\t\t\t}\n\t\t}));\n\n\t\tconst WrapperComponent = wrapperComponent;\n\n\t\tconst BackgroundComponent = backgroundComponent;\n\n\t\tconst BoundaryComponent = boundaryComponent;\n\n\t\treturn (\n\t\t\t<WrapperComponent\n\t\t\t\t{...wrapperProps}\n\t\t\t\tclassName={cn(className, 'advanced-cropper-preview')}\n\t\t\t\tcropper={instance.current}\n\t\t\t\tstyle={style}\n\t\t\t>\n\t\t\t\t<BoundaryComponent\n\t\t\t\t\tref={boundaryRef}\n\t\t\t\t\tstretchAlgorithm={stretchPreviewBoundary}\n\t\t\t\t\t{...boundaryProps}\n\t\t\t\t\tclassName={cn('advanced-cropper-preview__boundary', boundaryClassName)}\n\t\t\t\t>\n\t\t\t\t\t<div className={cn(contentClassName, 'advanced-cropper-preview__content')} style={contentStyle}>\n\t\t\t\t\t\t{instance.current && (\n\t\t\t\t\t\t\t<BackgroundComponent\n\t\t\t\t\t\t\t\t{...backgroundProps}\n\t\t\t\t\t\t\t\tcropper={instance.current}\n\t\t\t\t\t\t\t\tsize={size}\n\t\t\t\t\t\t\t\tclassName={cn(\n\t\t\t\t\t\t\t\t\tbackgroundClassName,\n\t\t\t\t\t\t\t\t\t'advanced-cropper-preview__image',\n\t\t\t\t\t\t\t\t\tsrc && 'advanced-cropper-preview__image--visible',\n\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t)}\n\t\t\t\t\t</div>\n\t\t\t\t</BoundaryComponent>\n\t\t\t</WrapperComponent>\n\t\t);\n\t},\n);\n","import { deepCompare } from '../utils/index.js';\n\nfunction isEqualState(a, b) {\n    return deepCompare(a, b);\n}\n\nexport { isEqualState };\n","import { MutableRefObject, LegacyRef, RefCallback } from 'react';\n\nexport function mergeRefs<T = any>(refs: (MutableRefObject<T> | LegacyRef<T>)[]): RefCallback<T> {\n\treturn (value) => {\n\t\trefs.forEach((ref) => {\n\t\t\tif (typeof ref === 'function') {\n\t\t\t\tref(value);\n\t\t\t} else if (ref != null) {\n\t\t\t\t(ref as MutableRefObject<T | null>).current = value;\n\t\t\t}\n\t\t});\n\t};\n}\n"],"names":["extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","prototype","hasOwnProperty","call","__extends","TypeError","String","__","this","constructor","create","__assign","assign","t","s","i","n","arguments","length","apply","__rest","e","indexOf","getOwnPropertySymbols","propertyIsEnumerable","__awaiter","thisArg","_arguments","P","generator","Promise","resolve","reject","fulfilled","value","step","next","rejected","result","done","then","__generator","body","f","y","g","_","label","sent","trys","ops","verb","throw","return","Symbol","iterator","v","op","pop","push","__read","o","m","r","ar","error","__spreadArray","to","from","pack","l","slice","concat","getDirectionNames","hDirection","vDirection","camelCase","snakeCase","toUpperCase","isBlob","url","test","isDataUrl","isLocal","isCrossOriginURL","pageLocation","window","location","urlMatch","exec","urlparts","protocol","host","port","portOf","Boolean","isArray","isFunction","isUndefined","obj","undefined","isObject","term","getOptions","options","defaultScheme","falseScheme","keys","forEach","key","parseNumber","number","parsedNumber","Number","isNaN","isBoolean","isNumber","isString","isNumeric","parseFloat","isFinite","distance","firstPoint","secondPoint","Math","sqrt","pow","left","top","isRoughlyEqual","a","tolerance","abs","isGreater","isLower","sign","promiseTimeout","timeout","setTimeout","deepClone","map","item","deepCompare","length_1","valueOf","toString","emptyCoordinates","width","height","isCardinalDirection","debounce","callback","delay","timestamp","later","args","_i","last","Date","now","delayValue","clear","clearTimeout","ImageRestriction","Priority","SetCoordinatesMode","ALL_DIRECTIONS","HORIZONTAL_DIRECTIONS","VERTICAL_DIRECTIONS","diff","firstObject","secondObject","getCenter","object","getOppositeSide","side","right","bottom","sizeDistance","applyDirections","coordinates","directions","inverseMove","applyMove","move","coordinatesToPositionRestrictions","applyScale","factor","center","progress","currentCenter","ratio","maxScale","size","restrictions","min","maxWidth","Infinity","maxHeight","minScale","max","minWidth","minHeight","getBrokenRatio","currentAspectRatio","aspectRatio","ratioBroken","minimum","maximum","fitToSizeRestrictions","sizeRestrictions","scale","getIntersections","positionRestrictions","intersections","direction","areaLimit","objectLimit","resizeToSizeRestrictions","rotateSize","angle","radians","PI","cos","sin","rotatePoint","point","anchor","positionToSizeRestrictions","mergePositionRestrictions","firstDirection","secondDirection","fitToPositionRestrictions","intersection","moveToPositionRestrictions","aspectRatioIntersection","main","subset","createAspectRatio","isConsistentSize","isConsistentPosition","getCloserSize","candidates","reference","traverse","ignoreMinimum","reduce","_a","preparedAspectRatio","isInitializedState","state","visibleArea","getAreaSizeRestrictions","settings","calculateAreaSizeRestrictions","getAreaPositionRestrictions","areaPositionRestrictions","getSizeRestrictions","calculateSizeRestrictions","getPositionRestrictions","getCoefficient","boundary","getStencilCoordinates","top_1","coefficient","getAspectRatio","getDefaultCoordinates","defaultCoordinates","getDefaultVisibleArea","defaultVisibleArea","getDefaultTransforms","transforms","flip","defaultTransforms","rotate","horizontal","vertical","getTransformedImageSize","imageSize","getMinimumSize","getRoundedCoordinates","roundCoordinates","round","floor","ceil","isConsistentState","reconcileSizeRestrictions","mergeSizeRestrictions","first","second","areaSizeRestrictions","copyState","approximateSize","params","candidate","fitVisibleArea","moveCoordinatesAlgorithm","movedCoordinates","setCoordinates","transform","mode","currentMode","unsafe","zoom","limit","prevCoordinates","newCoordinates","changes","resize","widthIntersections","heightIntersections","fitCoordinates","setVisibleArea","safe","createState","_b","_c","_d","_e","image","priority","moveCoordinates","fitDirections","preserveRatio","allowedDirections","compensate","fittedDirections","currentWidth","currentHeight","breaks","canBeCompensated","every","maxResize","multiplier_1","multiplier_2","distributeOverlap","overlap","resizeCoordinatesAlgorithm","limitations","actualCoordinates","preserveAspectRatio","respectDirection","overlapHeight","overlapWidth","anchorToMassPoint","plainAnchor","toLowerCase","anchorToAllowedDirections","anchorMoveToResizeDirections","normalizedDirections","el","anchoredResizeCoordinatesAlgorithm","resizeDirections","resizeCoordinates","minimumSize","setBoundary","rotateImageAlgorithm","imageCenter","shift","flipImageAlgorithm","changed","oldCenter","newCenter","transformImageAlgorithm","scaleFactor","scaleCenter","isAllowedScale","areaScale","stencilScale","scaleRestrictions","stencil","area","relativeCoordinates","transformImage","adjustStencil","reconcileState","brokenRatio","desiredSize","scaleModifier","normalizeResizeDirections","normalizeCenter","normalizeFlip","normalizedAngle","fillMoveDirections","fillResizeDirections","normalizeMoveDirections","normalizeImageTransform","calculateGeometricProperties","touches","container","getBoundingClientRect","centerMass","spread","touch","clientX","clientY","count","touchesToImageTransform","previousTouches","previousProperties","properties","diffs","x","atan2","wheelEventToImageTransform","event","deltaY","detail","wheelDelta","hasInteractions","interactions","getEmptyInteractions","defaultPositionRestrictions","limits","imageRestriction","boundaryRatio","coordinatesIntersection","imageRatio","areaProperties","defaultSize","sizeRestrictions_1","optimalRatio","retrieveSizeRestrictions","pixelsRestrictions","defaultPosition","defaultAreaPositionRestrictions","fillArea","fitArea","defaultAreaSizeRestrictions","fillBoundary","defaultStencilConstraints","rawSettings","stencilProps","withDefaultSizeRestrictions","basicSettings","createDefaultSettings","defaultSizeAlgorithm","defaultPositionAlgorithm_1","runCallback","getInstance","instance","runCallbacks","callbacks","exports","AbstractCropperInstance","_this","getTransitions","data","getData","transitions","getProps","timingFunction","duration","active","getInteractions","startTransitions","onTransitionsStart","onUpdate","setData","endTransitions","onTransitionsEnd","applyPostProcess","action","postProcess","name","interaction","immediately","preparedAction","processedState","updateState","modifier","onChange","previousData","somethingChanged","affectTransitionProperties","some","property","currentData","il","k","j","jl","__spreadArrays","setInteractions","onInteractionStart","onInteractionEnd","previousInteractions","currentInteractions","state_1","resetState","createDefaultState","reconcileStateAlgorithm","reconciledState","normalize","onTransformImage","onTransformImageEnd","transformImageEnd","zoomImage","moveImage","flipImage","getState","rotateImage","reset","setState","getSettings","postprocess","newState","setCoordinatesAlgorithm","setVisibleAreaAlgorithm","setBoundaryAlgorithm","onMove","onMoveEnd","moveCoordinatesEnd","parameters","onResize","onResizeEnd","resizeCoordinatesEnd","getCoordinates","getVisibleArea","getTransforms","createStateAlgorithm","isConsistent","timingFunctions","linear","Animation","start","animation","onStart","onProgress","onStop","id","cancelAnimationFrame","startTime","performance","endTime","animate","production","console","warn","percent","requestAnimationFrame","stop","prepareSource","canvas","originalSize","naturalWidth","naturalHeight","transformedSize","ctx","getContext","save","canvasCenter","translate","drawImage","restore","updateCanvas","source","resultSize","clearRect","imageSmoothingEnabled","imageSmoothingQuality","fillColor","fillStyle","fillRect","offsetX","offsetY","drawCroppedArea","resultCanvas","spareCanvas","maxArea","firstNumeric","array","find","stretchCropperBoundary","stretcher","style","clientWidth","clientHeight","stretchPreviewBoundary","getImageData","img","base64","replace","binary","atob","len","buffer","ArrayBuffer","view","Uint8Array","charCodeAt","base64ToArrayBuffer","fileReader_1","FileReader","onload","target","blob","readAsArrayBuffer","http","XMLHttpRequest","open","responseType","status","response","send","http_1","onreadystatechange","readyState","onprogress","getResponseHeader","abort","withCredentials","getStyleTransforms","resetAndGetOrientation","arrayBuffer","orientation_1","dataView","DataView","tiffOffset","littleEndian","app1Start","ifdStart","getUint8","byteLength","offset","str","fromCharCode","getStringFromCharCode","endianness","getUint16","firstIFDOffset","getUint32","length_2","setUint16","getImage","src","orientation","revoke","URL","createObjectURL","Blob","chunks","uint8","subarray","btoa","join","arrayBufferToDataURL","createImage","document","createElement","crossOrigin","visibility","position","appendChild","complete","removeChild","addEventListener","loadImage","checkOrientation","parse","catch","parseImage","getImageStyle","optimalImageSize","actualImageSize","imageTransforms","translateX","translateY","compensations","transition","willChange","getBackgroundStyle","getPreviewStyle","hybridStencilAutoZoom","hybridStencilAutoZoomAlgorithm","useDeprecationWarning","fired","useRef","message","text","current","hasOwn","classNames","classes","arg","argType","inner","module","default","useUpdateEffect","effect","deps","isFirst","isFirstMount","useEffect","useStateWithCallback","initialState","useState","setCallback","previousState","CropperInstance","_super","props","notify","useForceRerender","setTick","useCropperInstance","rerender","propsRef","usePersistentFunction","extendedSettings","extendedParameters","useCropperImage","onLoadingStart","onLoadingEnd","onError","onLoad","unloadTime","setImage","loading","setLoading","loaded","setLoaded","currentSrc","promises","all","responses","finally","isLoading","isLoaded","useWindowResize","callbackRef","internalCallback","removeEventListener","useAbstractCropper","onReady","_f","autoReconcileState","imageRef","boundaryRef","canvasRef","cropperRef","_g","currentImage","setCurrentImage","cropper","cropperImage","autoReconcile","enabled","setActive","useLayoutEffect","pause","resume","useCropperAutoReconcile","resetCropper","image_1","stretchTo","boundary_1","refreshCropper","cropperInterface","refresh","getDefaultState","getCanvas","draw","useImperativeHandle","refs","StretchableBoundary","forwardRef","ref","className","stretcherClassName","contentClassName","stretchAlgorithm","sizeAlgorithm","children","stretcherRef","React","cn","displayName","CropperFade","visible","CropperWrapper","preventDefault","CropperBackgroundImage","transformStyles","onMouseDown","CropperCanvas","spareCanvasRef","Fragment","DraggableElement","processMove","newTouches","movingToAnchor","useAnchor","processEnd","onLeave","disabled","hovered","initAnchor","top_2","onMouseOver","onEnter","onMouseLeave","onTouchStart","onMoveStart","cancelable","shouldStartMove","started","stopPropagation","onTouchEnd","onTouchMove","activationDistance","button","onMouseMove","onMouseUp","createRef","componentWillUnmount","componentDidMount","passive","componentDidUpdate","prevProps","render","defaultProps","Component","LineWrapper","onDrag","onDragEnd","SimpleLine","hoverClassName","wrapperClassName","defaultClassName","hover","setHover","HandlerWrapper","horizontalPosition","verticalPosition","classnames","SimpleHandler","wrapperStyle","BoundingBox","handlerComponent","handlers","eastNorth","north","westNorth","west","westSouth","south","eastSouth","east","handlerClassNames","handlerWrapperClassNames","lines","lineComponent","_h","lineClassNames","_j","lineWrapperClassNames","_k","_l","_m","lastReference","setLastReference","points","useMemo","lineNodes","component","handlerNodes","containerClassName","onHandlerMove","nativeEvent","shiftKey","onHandlerMoveEnd","line","handler","handlerElement","StencilOverlay","ArtificialTransition","values","root","transitionValues","rememberedValues","setRememberedValues","useTransition","runTransitions","transitionsActive","startValues_1","desiredValue","startValue","currentValues","rootStyle","StencilWrapper","StencilGrid","columns","rows","nodes","currentColumns","setCurrentColumns","currentRows","setCurrentRows","cells","RectangleStencil","minAspectRatio","maxAspectRatio","resizable","movable","grid","gridClassName","movingClassName","resizingClassName","previewClassName","boundingBoxClassName","overlayClassName","draggableAreaClassName","resizeAllowed","moveAllowed","DraggableArea","useRotateImageOptions","useScaleImageOptions","scaleImage","wheel","useMoveImageOptions","mouse","TransformableImageEvent","defaultPrevented","TransformableImage","onTransform","touchScale","touchMove","touchRotate","onTransformEnd","transforming","processStart","debouncedProcessEnd","processEvent","onEvent","transformEvent","onWheel","wheelScale","left_1","bottom_1","right_1","filter","identifier","anotherTouch","buttons","shouldComponentUpdate","mouseMove","CropperBackgroundWrapper","rotateImageOptions","scaleImageOptions","moveImageOptions","AbstractCropper","stencilComponent","stencilConstraints","wrapperComponent","wrapperProps","backgroundComponent","backgroundProps","backgroundClassName","backgroundWrapperComponent","backgroundWrapperProps","boundaryComponent","boundaryProps","boundaryClassName","stencilRef","_o","StencilComponent","WrapperComponent","BackgroundWrapperComponent","BackgroundComponent","BoundaryComponent","deprecatedWrapperProps","defaultSettings","useAbstractCropperProps","setting","fixedStencilConstraints","stencilOptions","defaultConstraints","stencilSize","previousSize","getStencilSize","areaRestrictions","fixedStencil","fixedStencilAlgorithm","FixedCropper","cropperProps","Cropper","intrinsicProps","autoZoom","actualSettings","deprecationWarning","CircleStencil","boundingBox","CropperSource","CropperPreviewWrapper","CropperPreviewBackground","CropperPreview","internalInstance","_p","setSize","contentStyle","update","areaHeight","areaWidth","turnsCount","firstCandidate","secondCandidate"],"mappings":"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"}